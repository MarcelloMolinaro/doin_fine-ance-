[0m00:00:26.265716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ea25d89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9e3f3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9e113b10>]}


============================== 00:00:26.270707 | d938ade7-c84a-45d9-9655-93f847ba0c5c ==============================
[0m00:00:26.270707 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:00:26.272948 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_path': '/opt/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'introspect': 'True', 'profiles_dir': '/opt/dbt', 'no_print': 'None', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m00:00:26.303113 [info ] [MainThread]: dbt version: 1.10.13
[0m00:00:26.305245 [info ] [MainThread]: python version: 3.11.14
[0m00:00:26.307711 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m00:00:26.309451 [info ] [MainThread]: os info: Linux-6.4.16-linuxkit-x86_64-with-glibc2.41
[0m00:00:26.402090 [info ] [MainThread]: Using profiles dir at /opt/dbt
[0m00:00:26.404072 [info ] [MainThread]: Using profiles.yml file at /opt/dbt/profiles.yml
[0m00:00:26.406219 [info ] [MainThread]: Using dbt_project.yml file at /opt/dbt/dbt_project.yml
[0m00:00:26.410147 [info ] [MainThread]: adapter type: postgres
[0m00:00:26.414664 [info ] [MainThread]: adapter version: 1.9.1
[0m00:00:26.586933 [info ] [MainThread]: Configuration:
[0m00:00:26.589167 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:00:26.590680 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:00:26.592911 [info ] [MainThread]: Required dependencies:
[0m00:00:26.599077 [debug] [MainThread]: Executing "git --help"
[0m00:00:26.603711 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m00:00:26.605176 [info ] [MainThread]: Connection:
[0m00:00:26.607518 [info ] [MainThread]:   host: postgres
[0m00:00:26.610667 [info ] [MainThread]:   port: 5432
[0m00:00:26.613307 [info ] [MainThread]:   user: dagster
[0m00:00:26.617309 [info ] [MainThread]:   database: dagster
[0m00:00:26.621218 [info ] [MainThread]:   schema: public
[0m00:00:26.624297 [info ] [MainThread]:   connect_timeout: 10
[0m00:00:26.627032 [info ] [MainThread]:   role: None
[0m00:00:26.629285 [info ] [MainThread]:   search_path: None
[0m00:00:26.635694 [info ] [MainThread]:   keepalives_idle: 0
[0m00:00:26.638393 [info ] [MainThread]:   sslmode: None
[0m00:00:26.641493 [info ] [MainThread]:   sslcert: None
[0m00:00:26.643370 [info ] [MainThread]:   sslkey: None
[0m00:00:26.647209 [info ] [MainThread]:   sslrootcert: None
[0m00:00:26.651188 [info ] [MainThread]:   application_name: dbt
[0m00:00:26.658577 [info ] [MainThread]:   retries: 1
[0m00:00:26.664258 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:00:26.806127 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:00:26.863015 [debug] [MainThread]: Using postgres connection "debug"
[0m00:00:26.864427 [debug] [MainThread]: On debug: select 1 as id
[0m00:00:26.865625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:26.890883 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m00:00:26.893085 [debug] [MainThread]: On debug: Close
[0m00:00:26.894634 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:00:26.896618 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:00:26.898659 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m00:00:26.906054 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.73172754, "process_in_blocks": "0", "process_kernel_time": 0.435618, "process_mem_max_rss": "118244", "process_out_blocks": "0", "process_user_time": 2.488955}
[0m00:00:26.910613 [debug] [MainThread]: Command `dbt debug` failed at 00:00:26.910349 after 0.74 seconds
[0m00:00:26.911847 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:00:26.913186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9e113dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9e2de0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9e0bfcd0>]}
[0m00:00:26.915301 [debug] [MainThread]: Flushing usage events
[0m00:00:27.321534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:06.564819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76cb799190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76cc60ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76cbd6e6d0>]}


============================== 00:03:06.571090 | 66e345ed-7599-44a6-a644-8429240123cc ==============================
[0m00:03:06.571090 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:03:06.573602 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/opt/dbt', 'partial_parse': 'True', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/dbt/logs', 'debug': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'printer_width': '80'}
[0m00:03:06.594862 [info ] [MainThread]: dbt version: 1.10.13
[0m00:03:06.597078 [info ] [MainThread]: python version: 3.11.14
[0m00:03:06.598939 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m00:03:06.601485 [info ] [MainThread]: os info: Linux-6.4.16-linuxkit-x86_64-with-glibc2.41
[0m00:03:06.703457 [info ] [MainThread]: Using profiles dir at /opt/dbt
[0m00:03:06.705566 [info ] [MainThread]: Using profiles.yml file at /opt/dbt/profiles.yml
[0m00:03:06.707879 [info ] [MainThread]: Using dbt_project.yml file at /opt/dbt/dbt_project.yml
[0m00:03:06.709908 [info ] [MainThread]: adapter type: postgres
[0m00:03:06.713144 [info ] [MainThread]: adapter version: 1.9.1
[0m00:03:06.878255 [info ] [MainThread]: Configuration:
[0m00:03:06.879839 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:03:06.881800 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:03:06.883686 [info ] [MainThread]: Required dependencies:
[0m00:03:06.889885 [debug] [MainThread]: Executing "git --help"
[0m00:03:06.893065 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m00:03:06.895504 [info ] [MainThread]: Connection:
[0m00:03:06.898329 [info ] [MainThread]:   host: postgres
[0m00:03:06.902988 [info ] [MainThread]:   port: 5432
[0m00:03:06.909086 [info ] [MainThread]:   user: dagster
[0m00:03:06.911058 [info ] [MainThread]:   database: dagster
[0m00:03:06.912851 [info ] [MainThread]:   schema: public
[0m00:03:06.915801 [info ] [MainThread]:   connect_timeout: 10
[0m00:03:06.919035 [info ] [MainThread]:   role: None
[0m00:03:06.924880 [info ] [MainThread]:   search_path: None
[0m00:03:06.927136 [info ] [MainThread]:   keepalives_idle: 0
[0m00:03:06.928883 [info ] [MainThread]:   sslmode: None
[0m00:03:06.931871 [info ] [MainThread]:   sslcert: None
[0m00:03:06.935089 [info ] [MainThread]:   sslkey: None
[0m00:03:06.940919 [info ] [MainThread]:   sslrootcert: None
[0m00:03:06.942925 [info ] [MainThread]:   application_name: dbt
[0m00:03:06.946251 [info ] [MainThread]:   retries: 1
[0m00:03:06.948843 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:03:07.062908 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:03:07.641709 [debug] [MainThread]: Using postgres connection "debug"
[0m00:03:07.643484 [debug] [MainThread]: On debug: select 1 as id
[0m00:03:07.644839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:07.672440 [debug] [MainThread]: SQL status: SELECT 1 in 0.027 seconds
[0m00:03:07.677192 [debug] [MainThread]: On debug: Close
[0m00:03:07.678945 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:03:07.681692 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:03:07.684367 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m00:03:07.692370 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.2137835, "process_in_blocks": "0", "process_kernel_time": 0.781508, "process_mem_max_rss": "118388", "process_out_blocks": "0", "process_user_time": 2.745779}
[0m00:03:07.695756 [debug] [MainThread]: Command `dbt debug` failed at 00:03:07.695342 after 1.22 seconds
[0m00:03:07.697158 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:03:07.698828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76cb623f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76cb623f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76cffaa7d0>]}
[0m00:03:07.700402 [debug] [MainThread]: Flushing usage events
[0m00:03:08.114965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:28:16.408824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7afde390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7b02a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7afdea50>]}


============================== 00:28:16.425773 | 348a6922-d17d-4786-8e6d-44820ea6ddc6 ==============================
[0m00:28:16.425773 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:28:16.428066 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/dbt', 'warn_error': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'log_path': '/opt/dbt/logs', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'invocation_command': 'dbt debug', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False'}
[0m00:28:16.505072 [info ] [MainThread]: dbt version: 1.10.13
[0m00:28:16.507333 [info ] [MainThread]: python version: 3.11.14
[0m00:28:16.510411 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m00:28:16.513998 [info ] [MainThread]: os info: Linux-6.4.16-linuxkit-x86_64-with-glibc2.41
[0m00:28:16.692474 [info ] [MainThread]: Using profiles dir at /opt/dbt
[0m00:28:16.695377 [info ] [MainThread]: Using profiles.yml file at /opt/dbt/profiles.yml
[0m00:28:16.698370 [info ] [MainThread]: Using dbt_project.yml file at /opt/dbt/dbt_project.yml
[0m00:28:16.704050 [info ] [MainThread]: adapter type: postgres
[0m00:28:16.714827 [info ] [MainThread]: adapter version: 1.9.1
[0m00:28:17.260115 [info ] [MainThread]: Configuration:
[0m00:28:17.263650 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:28:17.271304 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:28:17.273621 [info ] [MainThread]: Required dependencies:
[0m00:28:17.285992 [debug] [MainThread]: Executing "git --help"
[0m00:28:17.318411 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:28:17.320366 [debug] [MainThread]: STDERR: "b''"
[0m00:28:17.321714 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:28:17.325009 [info ] [MainThread]: Connection:
[0m00:28:17.327828 [info ] [MainThread]:   host: postgres
[0m00:28:17.339320 [info ] [MainThread]:   port: 5432
[0m00:28:17.344318 [info ] [MainThread]:   user: dagster
[0m00:28:17.347509 [info ] [MainThread]:   database: dagster
[0m00:28:17.350724 [info ] [MainThread]:   schema: public
[0m00:28:17.361211 [info ] [MainThread]:   connect_timeout: 10
[0m00:28:17.369125 [info ] [MainThread]:   role: None
[0m00:28:17.401469 [info ] [MainThread]:   search_path: None
[0m00:28:17.403517 [info ] [MainThread]:   keepalives_idle: 0
[0m00:28:17.406038 [info ] [MainThread]:   sslmode: None
[0m00:28:17.436849 [info ] [MainThread]:   sslcert: None
[0m00:28:17.463074 [info ] [MainThread]:   sslkey: None
[0m00:28:17.697791 [info ] [MainThread]:   sslrootcert: None
[0m00:28:17.702658 [info ] [MainThread]:   application_name: dbt
[0m00:28:17.709165 [info ] [MainThread]:   retries: 1
[0m00:28:17.735016 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:28:18.398207 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:28:19.050830 [debug] [MainThread]: Using postgres connection "debug"
[0m00:28:19.056869 [debug] [MainThread]: On debug: select 1 as id
[0m00:28:19.062068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:28:19.401421 [debug] [MainThread]: SQL status: SELECT 1 in 0.339 seconds
[0m00:28:19.406404 [debug] [MainThread]: On debug: Close
[0m00:28:19.414324 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:28:19.423101 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:28:19.492837 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.1818926, "process_in_blocks": "224", "process_kernel_time": 6.194208, "process_mem_max_rss": "118696", "process_out_blocks": "1088", "process_user_time": 5.875365}
[0m00:28:19.519429 [debug] [MainThread]: Command `dbt debug` succeeded at 00:28:19.515528 after 3.21 seconds
[0m00:28:19.565107 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:28:19.605180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc79f69110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78f00290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78f004d0>]}
[0m00:28:19.613263 [debug] [MainThread]: Flushing usage events
[0m00:28:22.249647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:15:12.105335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1456d2eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1456d2cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1456d2ccd0>]}


============================== 05:15:12.128690 | a352f4c9-0387-41ca-872f-77851b001156 ==============================
[0m05:15:12.128690 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:15:12.131296 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_path': '/opt/dbt/logs', 'no_print': 'None', 'invocation_command': 'dbt debug', 'empty': 'None', 'fail_fast': 'False', 'target_path': 'None', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/dbt', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m05:15:12.242611 [info ] [MainThread]: dbt version: 1.10.13
[0m05:15:12.244579 [info ] [MainThread]: python version: 3.11.14
[0m05:15:12.246597 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m05:15:12.248822 [info ] [MainThread]: os info: Linux-6.4.16-linuxkit-x86_64-with-glibc2.41
[0m05:15:12.413930 [info ] [MainThread]: Using profiles dir at /opt/dbt
[0m05:15:12.415781 [info ] [MainThread]: Using profiles.yml file at /opt/dbt/profiles.yml
[0m05:15:12.417187 [info ] [MainThread]: Using dbt_project.yml file at /opt/dbt/dbt_project.yml
[0m05:15:12.420018 [info ] [MainThread]: adapter type: postgres
[0m05:15:12.424713 [info ] [MainThread]: adapter version: 1.9.1
[0m05:15:12.789345 [info ] [MainThread]: Configuration:
[0m05:15:12.791636 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:15:12.806771 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:15:12.810505 [info ] [MainThread]: Required dependencies:
[0m05:15:12.816102 [debug] [MainThread]: Executing "git --help"
[0m05:15:12.880547 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:15:12.882286 [debug] [MainThread]: STDERR: "b''"
[0m05:15:12.883858 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:15:12.892619 [info ] [MainThread]: Connection:
[0m05:15:12.897794 [info ] [MainThread]:   host: postgres
[0m05:15:12.926150 [info ] [MainThread]:   port: 5432
[0m05:15:12.928555 [info ] [MainThread]:   user: dagster
[0m05:15:12.932885 [info ] [MainThread]:   database: dagster
[0m05:15:12.934790 [info ] [MainThread]:   schema: public
[0m05:15:12.940699 [info ] [MainThread]:   connect_timeout: 10
[0m05:15:12.946142 [info ] [MainThread]:   role: None
[0m05:15:12.949451 [info ] [MainThread]:   search_path: None
[0m05:15:12.954551 [info ] [MainThread]:   keepalives_idle: 0
[0m05:15:12.960808 [info ] [MainThread]:   sslmode: None
[0m05:15:12.964386 [info ] [MainThread]:   sslcert: None
[0m05:15:12.970640 [info ] [MainThread]:   sslkey: None
[0m05:15:12.976114 [info ] [MainThread]:   sslrootcert: None
[0m05:15:12.991261 [info ] [MainThread]:   application_name: dbt
[0m05:15:12.994510 [info ] [MainThread]:   retries: 1
[0m05:15:13.001872 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:15:13.180984 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m05:15:13.992023 [debug] [MainThread]: Using postgres connection "debug"
[0m05:15:14.014969 [debug] [MainThread]: On debug: select 1 as id
[0m05:15:14.023076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:15:14.712849 [debug] [MainThread]: SQL status: SELECT 1 in 0.690 seconds
[0m05:15:14.715740 [debug] [MainThread]: On debug: Close
[0m05:15:14.719002 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:15:14.766732 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:15:14.799233 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.7939398, "process_in_blocks": "248", "process_kernel_time": 8.417294, "process_mem_max_rss": "118564", "process_out_blocks": "1088", "process_user_time": 6.057442}
[0m05:15:14.816885 [debug] [MainThread]: Command `dbt debug` succeeded at 05:15:14.816074 after 2.81 seconds
[0m05:15:14.827245 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:15:14.831854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1454dbc210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1454dbc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14570371d0>]}
[0m05:15:14.839955 [debug] [MainThread]: Flushing usage events
[0m05:15:15.506545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:15:52.617347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483e9cf450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483e9cf510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483ebf57d0>]}


============================== 05:15:52.626337 | 562d239c-91f9-4d0b-8a32-279f7587da64 ==============================
[0m05:15:52.626337 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:15:52.628637 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'invocation_command': 'dbt run -m source1', 'printer_width': '80', 'use_colors': 'True', 'log_path': '/opt/dbt/logs', 'empty': 'False', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None'}
[0m05:15:52.630624 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m05:15:52.645400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '562d239c-91f9-4d0b-8a32-279f7587da64', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483e9effd0>]}
[0m05:15:53.502546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '562d239c-91f9-4d0b-8a32-279f7587da64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483dbef0d0>]}
[0m05:15:53.614910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '562d239c-91f9-4d0b-8a32-279f7587da64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4841756750>]}
[0m05:15:53.617042 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:15:53.974409 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m05:15:53.977541 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:15:53.979528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '562d239c-91f9-4d0b-8a32-279f7587da64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483dbe7b50>]}
[0m05:15:57.267895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '562d239c-91f9-4d0b-8a32-279f7587da64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483ea23010>]}
[0m05:15:57.757461 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m05:15:57.785619 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m05:15:57.968106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '562d239c-91f9-4d0b-8a32-279f7587da64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483c710190>]}
[0m05:15:57.984433 [info ] [MainThread]: Found 5 models, 447 macros
[0m05:15:57.989231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '562d239c-91f9-4d0b-8a32-279f7587da64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483eba4750>]}
[0m05:15:58.001518 [info ] [MainThread]: 
[0m05:15:58.015158 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m05:15:58.020772 [info ] [MainThread]: 
[0m05:15:58.024476 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:15:58.032621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m05:15:58.883899 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m05:15:58.886217 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m05:15:58.888041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:15:59.446083 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.558 seconds
[0m05:15:59.458662 [debug] [ThreadPool]: On list_dagster: Close
[0m05:15:59.480532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_public)
[0m05:15:59.500726 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m05:15:59.509202 [debug] [ThreadPool]: On list_dagster_public: BEGIN
[0m05:15:59.513135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:15:59.553235 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m05:15:59.556575 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m05:15:59.558256 [debug] [ThreadPool]: On list_dagster_public: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_public"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:15:59.725322 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.166 seconds
[0m05:15:59.730561 [debug] [ThreadPool]: On list_dagster_public: ROLLBACK
[0m05:15:59.732267 [debug] [ThreadPool]: On list_dagster_public: Close
[0m05:15:59.747544 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:59.748997 [debug] [MainThread]: On master: BEGIN
[0m05:15:59.750224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:15:59.810716 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m05:15:59.812272 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:59.813826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m05:15:59.977992 [debug] [MainThread]: SQL status: SELECT 0 in 0.162 seconds
[0m05:15:59.980581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '562d239c-91f9-4d0b-8a32-279f7587da64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483cb5a8d0>]}
[0m05:15:59.982298 [debug] [MainThread]: On master: ROLLBACK
[0m05:15:59.984105 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:59.986680 [debug] [MainThread]: On master: BEGIN
[0m05:15:59.990729 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:15:59.993651 [debug] [MainThread]: On master: COMMIT
[0m05:15:59.996307 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:59.998787 [debug] [MainThread]: On master: COMMIT
[0m05:16:00.007535 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m05:16:00.009226 [debug] [MainThread]: On master: Close
[0m05:16:00.114423 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source1
[0m05:16:00.118231 [info ] [Thread-1 (]: 1 of 1 START sql view model public.source1 ..................................... [RUN]
[0m05:16:00.132449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_public, now model.dagster_dbt_project.source1)
[0m05:16:00.144062 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source1
[0m05:16:00.194174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source1"
[0m05:16:00.215698 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source1
[0m05:16:00.345178 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source1"
[0m05:16:00.366588 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m05:16:00.369196 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: BEGIN
[0m05:16:00.371212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:00.394881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m05:16:00.398160 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m05:16:00.401639 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */

  create view "dagster"."public"."source1__dbt_tmp"
    
    
  as (
    SELECT id, value, value * 2 AS value_x2 FROM public.source1;
  );
[0m05:16:00.409654 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 7: ...SELECT id, value, value * 2 AS value_x2 FROM public.source1;
                                                                      ^

[0m05:16:00.411736 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: ROLLBACK
[0m05:16:00.414143 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: Close
[0m05:16:00.456996 [debug] [Thread-1 (]: Database Error in model source1 (models/staging/source1.sql)
  syntax error at or near ";"
  LINE 7: ...SELECT id, value, value * 2 AS value_x2 FROM public.source1;
                                                                        ^
  compiled code at target/run/dagster_dbt_project/models/staging/source1.sql
[0m05:16:00.464226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '562d239c-91f9-4d0b-8a32-279f7587da64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483c77f190>]}
[0m05:16:00.466124 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.source1 ............................ [[31mERROR[0m in 0.33s]
[0m05:16:00.468560 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source1
[0m05:16:00.476264 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.source1' to be skipped because of status 'error'.  Reason: Database Error in model source1 (models/staging/source1.sql)
  syntax error at or near ";"
  LINE 7: ...SELECT id, value, value * 2 AS value_x2 FROM public.source1;
                                                                        ^
  compiled code at target/run/dagster_dbt_project/models/staging/source1.sql.
[0m05:16:00.516037 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:00.527464 [debug] [MainThread]: On master: BEGIN
[0m05:16:00.532780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:16:00.577660 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m05:16:00.598104 [debug] [MainThread]: On master: COMMIT
[0m05:16:00.636360 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:00.658473 [debug] [MainThread]: On master: COMMIT
[0m05:16:00.702290 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m05:16:00.741996 [debug] [MainThread]: On master: Close
[0m05:16:00.766639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:16:00.789533 [debug] [MainThread]: Connection 'model.dagster_dbt_project.source1' was properly closed.
[0m05:16:00.791776 [info ] [MainThread]: 
[0m05:16:00.818437 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m05:16:00.827058 [debug] [MainThread]: Command end result
[0m05:16:01.239130 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m05:16:01.309495 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m05:16:01.388031 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m05:16:01.391255 [info ] [MainThread]: 
[0m05:16:01.398919 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:16:01.409684 [info ] [MainThread]: 
[0m05:16:01.433987 [error] [MainThread]: [31mFailure in model source1 (models/staging/source1.sql)[0m
[0m05:16:01.442528 [error] [MainThread]:   Database Error in model source1 (models/staging/source1.sql)
  syntax error at or near ";"
  LINE 7: ...SELECT id, value, value * 2 AS value_x2 FROM public.source1;
                                                                        ^
  compiled code at target/run/dagster_dbt_project/models/staging/source1.sql
[0m05:16:01.464541 [info ] [MainThread]: 
[0m05:16:01.477189 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/source1.sql
[0m05:16:01.485764 [info ] [MainThread]: 
[0m05:16:01.495433 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m05:16:01.501419 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m05:16:01.524805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.061056, "process_in_blocks": "344", "process_kernel_time": 3.04426, "process_mem_max_rss": "127980", "process_out_blocks": "120", "process_user_time": 7.15852}
[0m05:16:01.540230 [debug] [MainThread]: Command `dbt run` failed at 05:16:01.535152 after 9.07 seconds
[0m05:16:01.545656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483eb6a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483e9cfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f483ecfe590>]}
[0m05:16:01.547422 [debug] [MainThread]: Flushing usage events
[0m05:16:01.934163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:16:45.167859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e50d6a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e50e8ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e50bde090>]}


============================== 05:16:45.177162 | 1a7dcbe6-9cda-43db-baa9-e7e1c4e19bf0 ==============================
[0m05:16:45.177162 [info ] [MainThread]: Running with dbt=1.10.13
[0m05:16:45.179829 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'log_path': '/opt/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/opt/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s source1', 'log_cache_events': 'False', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:16:45.516465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a7dcbe6-9cda-43db-baa9-e7e1c4e19bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e50bd7490>]}
[0m05:16:45.627588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a7dcbe6-9cda-43db-baa9-e7e1c4e19bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e5393d490>]}
[0m05:16:45.629795 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:16:45.771780 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m05:16:45.940881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:16:45.942810 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/source1.sql
[0m05:16:46.362702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a7dcbe6-9cda-43db-baa9-e7e1c4e19bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4ff2c590>]}
[0m05:16:46.498798 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m05:16:46.504547 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m05:16:46.530087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a7dcbe6-9cda-43db-baa9-e7e1c4e19bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4eb2eb50>]}
[0m05:16:46.531620 [info ] [MainThread]: Found 5 models, 447 macros
[0m05:16:46.533758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7dcbe6-9cda-43db-baa9-e7e1c4e19bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4ef6fd90>]}
[0m05:16:46.538157 [info ] [MainThread]: 
[0m05:16:46.547598 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m05:16:46.550480 [info ] [MainThread]: 
[0m05:16:46.552866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:16:46.562963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m05:16:46.707991 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m05:16:46.709703 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m05:16:46.711509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:16:46.732643 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m05:16:46.735831 [debug] [ThreadPool]: On list_dagster: Close
[0m05:16:46.747204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_public)
[0m05:16:46.758717 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m05:16:46.760289 [debug] [ThreadPool]: On list_dagster_public: BEGIN
[0m05:16:46.761824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:16:46.779755 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m05:16:46.782084 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m05:16:46.783782 [debug] [ThreadPool]: On list_dagster_public: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_public"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:16:46.797828 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m05:16:46.802131 [debug] [ThreadPool]: On list_dagster_public: ROLLBACK
[0m05:16:46.805512 [debug] [ThreadPool]: On list_dagster_public: Close
[0m05:16:46.824901 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:46.826660 [debug] [MainThread]: On master: BEGIN
[0m05:16:46.827934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:16:46.845351 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m05:16:46.846940 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:46.848513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m05:16:46.858028 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m05:16:46.860905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7dcbe6-9cda-43db-baa9-e7e1c4e19bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4ef64850>]}
[0m05:16:46.862531 [debug] [MainThread]: On master: ROLLBACK
[0m05:16:46.864976 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:46.866565 [debug] [MainThread]: On master: BEGIN
[0m05:16:46.868868 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:16:46.871009 [debug] [MainThread]: On master: COMMIT
[0m05:16:46.872405 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:46.873765 [debug] [MainThread]: On master: COMMIT
[0m05:16:46.876355 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:16:46.877714 [debug] [MainThread]: On master: Close
[0m05:16:46.883815 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source1
[0m05:16:46.885469 [info ] [Thread-1 (]: 1 of 1 START sql view model public.source1 ..................................... [RUN]
[0m05:16:46.888416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_public, now model.dagster_dbt_project.source1)
[0m05:16:46.889921 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source1
[0m05:16:46.902421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source1"
[0m05:16:46.912519 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source1
[0m05:16:46.975808 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source1"
[0m05:16:46.981602 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m05:16:46.983067 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: BEGIN
[0m05:16:46.984444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:47.006565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m05:16:47.007927 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m05:16:47.009166 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */

  create view "dagster"."public"."source1__dbt_tmp"
    
    
  as (
    SELECT id, value, value * 2 AS value_x2 FROM public.source1
  );
[0m05:16:47.040878 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source1" does not exist
LINE 7:     SELECT id, value, value * 2 AS value_x2 FROM public.sour...
                                                         ^

[0m05:16:47.042965 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: ROLLBACK
[0m05:16:47.044802 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: Close
[0m05:16:47.060479 [debug] [Thread-1 (]: Database Error in model source1 (models/staging/source1.sql)
  relation "public.source1" does not exist
  LINE 7:     SELECT id, value, value * 2 AS value_x2 FROM public.sour...
                                                           ^
  compiled code at target/run/dagster_dbt_project/models/staging/source1.sql
[0m05:16:47.063604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7dcbe6-9cda-43db-baa9-e7e1c4e19bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4f3ebbd0>]}
[0m05:16:47.065168 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.source1 ............................ [[31mERROR[0m in 0.17s]
[0m05:16:47.067790 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source1
[0m05:16:47.069743 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.source1' to be skipped because of status 'error'.  Reason: Database Error in model source1 (models/staging/source1.sql)
  relation "public.source1" does not exist
  LINE 7:     SELECT id, value, value * 2 AS value_x2 FROM public.sour...
                                                           ^
  compiled code at target/run/dagster_dbt_project/models/staging/source1.sql.
[0m05:16:47.081109 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:47.082502 [debug] [MainThread]: On master: BEGIN
[0m05:16:47.083488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:16:47.100916 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m05:16:47.102284 [debug] [MainThread]: On master: COMMIT
[0m05:16:47.103268 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:47.105900 [debug] [MainThread]: On master: COMMIT
[0m05:16:47.107923 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:16:47.108954 [debug] [MainThread]: On master: Close
[0m05:16:47.111281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:16:47.112757 [debug] [MainThread]: Connection 'model.dagster_dbt_project.source1' was properly closed.
[0m05:16:47.114978 [info ] [MainThread]: 
[0m05:16:47.117713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m05:16:47.121013 [debug] [MainThread]: Command end result
[0m05:16:47.201853 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m05:16:47.206892 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m05:16:47.236499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m05:16:47.238729 [info ] [MainThread]: 
[0m05:16:47.240674 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:16:47.243815 [info ] [MainThread]: 
[0m05:16:47.247743 [error] [MainThread]: [31mFailure in model source1 (models/staging/source1.sql)[0m
[0m05:16:47.251146 [error] [MainThread]:   Database Error in model source1 (models/staging/source1.sql)
  relation "public.source1" does not exist
  LINE 7:     SELECT id, value, value * 2 AS value_x2 FROM public.sour...
                                                           ^
  compiled code at target/run/dagster_dbt_project/models/staging/source1.sql
[0m05:16:47.259554 [info ] [MainThread]: 
[0m05:16:47.262464 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/source1.sql
[0m05:16:47.268442 [info ] [MainThread]: 
[0m05:16:47.280776 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m05:16:47.285868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2500286, "process_in_blocks": "0", "process_kernel_time": 0.499485, "process_mem_max_rss": "128088", "process_out_blocks": "0", "process_user_time": 4.268811}
[0m05:16:47.292083 [debug] [MainThread]: Command `dbt run` failed at 05:16:47.291854 after 2.26 seconds
[0m05:16:47.293498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e50bf5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e50bf7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e50d6bfd0>]}
[0m05:16:47.295719 [debug] [MainThread]: Flushing usage events
[0m05:16:47.756484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:40:23.507253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d70d98590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d71066c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d71092b90>]}


============================== 06:40:23.515912 | d43ac5ed-689a-4f20-ba90-485a33aefc21 ==============================
[0m06:40:23.515912 [info ] [MainThread]: Running with dbt=1.10.13
[0m06:40:23.518280 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/opt/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'printer_width': '80', 'profiles_dir': '/opt/dbt', 'no_print': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'write_json': 'True', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager'}
[0m06:40:25.363005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d70557e50>]}
[0m06:40:25.769706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d73aeadd0>]}
[0m06:40:25.773198 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:40:26.405507 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m06:40:27.437393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m06:40:27.462506 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m06:40:27.466501 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/source2.sql
[0m06:40:27.506222 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/source3.sql
[0m06:40:27.508508 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/weather.sql
[0m06:40:28.635277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d7019e6d0>]}
[0m06:40:28.864220 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m06:40:28.878440 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m06:40:28.984408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6ed2c810>]}
[0m06:40:28.993955 [info ] [MainThread]: Found 5 models, 447 macros
[0m06:40:28.999667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6f18fb50>]}
[0m06:40:29.005198 [info ] [MainThread]: 
[0m06:40:29.007305 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m06:40:29.010297 [info ] [MainThread]: 
[0m06:40:29.016006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:40:29.032522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m06:40:29.445942 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m06:40:29.447127 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m06:40:29.448042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:29.483416 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.035 seconds
[0m06:40:29.486305 [debug] [ThreadPool]: On list_dagster: Close
[0m06:40:29.490502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_public)
[0m06:40:29.503306 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m06:40:29.504684 [debug] [ThreadPool]: On list_dagster_public: BEGIN
[0m06:40:29.505583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:29.527925 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m06:40:29.535218 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m06:40:29.539508 [debug] [ThreadPool]: On list_dagster_public: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_public"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:40:29.596277 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.053 seconds
[0m06:40:29.599039 [debug] [ThreadPool]: On list_dagster_public: ROLLBACK
[0m06:40:29.601271 [debug] [ThreadPool]: On list_dagster_public: Close
[0m06:40:29.618494 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:29.620065 [debug] [MainThread]: On master: BEGIN
[0m06:40:29.621795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:40:29.647973 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m06:40:29.649808 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:29.651150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:40:29.673875 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m06:40:29.681719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d70112610>]}
[0m06:40:29.684330 [debug] [MainThread]: On master: ROLLBACK
[0m06:40:29.687345 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:29.689108 [debug] [MainThread]: On master: BEGIN
[0m06:40:29.691788 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:40:29.693534 [debug] [MainThread]: On master: COMMIT
[0m06:40:29.696709 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:29.699197 [debug] [MainThread]: On master: COMMIT
[0m06:40:29.702732 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:40:29.704693 [debug] [MainThread]: On master: Close
[0m06:40:29.720270 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source1
[0m06:40:29.721915 [info ] [Thread-1 (]: 1 of 5 START sql view model public.source1 ..................................... [RUN]
[0m06:40:29.722848 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.source2
[0m06:40:29.724800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_public, now model.dagster_dbt_project.source1)
[0m06:40:29.726992 [info ] [Thread-2 (]: 2 of 5 START sql view model public.source2 ..................................... [RUN]
[0m06:40:29.729176 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source1
[0m06:40:29.731026 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.source2'
[0m06:40:29.750602 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.source2
[0m06:40:29.751567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source1"
[0m06:40:29.756150 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.source2"
[0m06:40:29.763541 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source1
[0m06:40:29.766238 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.source2
[0m06:40:30.036504 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.source2"
[0m06:40:30.040345 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source1"
[0m06:40:30.051175 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m06:40:30.053236 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m06:40:30.061730 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: BEGIN
[0m06:40:30.055046 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: BEGIN
[0m06:40:30.065297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:30.067682 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:40:30.105911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m06:40:30.108159 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m06:40:30.109635 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */

  create view "dagster"."public"."source1__dbt_tmp"
    
    
  as (
    SELECT id, value, value * 2 AS value_x2 FROM public.source1
  );
[0m06:40:30.106719 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m06:40:30.119807 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m06:40:30.124149 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */

  create view "dagster"."public"."source2__dbt_tmp"
    
    
  as (
    SELECT id, score, score + 1 AS score_plus_one FROM public.source2
  );
[0m06:40:30.166831 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.037 seconds
[0m06:40:30.168984 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m06:40:30.191188 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m06:40:30.206820 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m06:40:30.208126 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2" rename to "source2__dbt_backup"
[0m06:40:30.210920 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1" rename to "source1__dbt_backup"
[0m06:40:30.214052 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:40:30.217945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:40:30.224880 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m06:40:30.234411 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m06:40:30.235994 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2__dbt_tmp" rename to "source2"
[0m06:40:30.237660 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1__dbt_tmp" rename to "source1"
[0m06:40:30.241548 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:40:30.243761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:40:30.312876 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m06:40:30.316734 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m06:40:30.319100 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m06:40:30.323555 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m06:40:30.325154 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m06:40:30.326371 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m06:40:30.335128 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m06:40:30.351085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m06:40:30.356290 [debug] [Thread-2 (]: Applying DROP to: "dagster"."public"."source2__dbt_backup"
[0m06:40:30.362977 [debug] [Thread-1 (]: Applying DROP to: "dagster"."public"."source1__dbt_backup"
[0m06:40:30.380727 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m06:40:30.382187 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m06:40:30.383649 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
drop table if exists "dagster"."public"."source2__dbt_backup" cascade
[0m06:40:30.386056 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
drop table if exists "dagster"."public"."source1__dbt_backup" cascade
[0m06:40:30.596676 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.209 seconds
[0m06:40:30.597900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.209 seconds
[0m06:40:30.692671 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: Close
[0m06:40:30.699034 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: Close
[0m06:40:30.717435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6d63cb90>]}
[0m06:40:30.709100 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6c507890>]}
[0m06:40:30.732617 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.source1 ................................ [[32mCREATE VIEW[0m in 0.99s]
[0m06:40:30.735937 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.source2 ................................ [[32mCREATE VIEW[0m in 0.97s]
[0m06:40:30.739678 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source1
[0m06:40:30.742650 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.source2
[0m06:40:30.746470 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source3
[0m06:40:30.749119 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.weather
[0m06:40:30.752260 [info ] [Thread-1 (]: 3 of 5 START sql view model public.source3 ..................................... [RUN]
[0m06:40:30.756301 [info ] [Thread-2 (]: 4 of 5 START sql view model public.weather ..................................... [RUN]
[0m06:40:30.759995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source1, now model.dagster_dbt_project.source3)
[0m06:40:30.764045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source2, now model.dagster_dbt_project.weather)
[0m06:40:30.766080 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source3
[0m06:40:30.768592 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.weather
[0m06:40:30.801151 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source3"
[0m06:40:30.819167 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.weather"
[0m06:40:30.852344 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source3
[0m06:40:30.873963 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.weather
[0m06:40:30.950756 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.weather"
[0m06:40:30.946182 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source3"
[0m06:40:30.963860 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.weather"
[0m06:40:30.965202 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m06:40:30.965914 [debug] [Thread-2 (]: On model.dagster_dbt_project.weather: BEGIN
[0m06:40:30.968417 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: BEGIN
[0m06:40:30.977012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:30.970144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:40:31.052028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m06:40:31.054952 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m06:40:31.057114 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */

  create view "dagster"."public"."source3__dbt_tmp"
    
    
  as (
    SELECT 
    id, 
    category, 
    CASE WHEN category='A' 
        THEN 1 
        ELSE 0 
    END AS is_a 
FROM public.source3
  );
[0m06:40:31.066713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.096 seconds
[0m06:40:31.068297 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:40:31.069972 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.weather"
[0m06:40:31.085595 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m06:40:31.089267 [debug] [Thread-2 (]: On model.dagster_dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.weather"} */

  create view "dagster"."public"."weather__dbt_tmp"
    
    
  as (
    SELECT 
    name, 
    temperature, 
    windSpeed, 
    temperature * 1.8 + 32 AS temperature_f 
FROM public.weather
  );
[0m06:40:31.093922 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3" rename to "source3__dbt_backup"
[0m06:40:31.098187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:40:31.109474 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m06:40:31.111330 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3__dbt_tmp" rename to "source3"
[0m06:40:31.110212 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.weather" does not exist
LINE 12: FROM public.weather
              ^

[0m06:40:31.118715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:40:31.122767 [debug] [Thread-2 (]: On model.dagster_dbt_project.weather: ROLLBACK
[0m06:40:31.132830 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m06:40:31.136146 [debug] [Thread-2 (]: On model.dagster_dbt_project.weather: Close
[0m06:40:31.136893 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m06:40:31.149121 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m06:40:31.168892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m06:40:31.176681 [debug] [Thread-1 (]: Applying DROP to: "dagster"."public"."source3__dbt_backup"
[0m06:40:31.181436 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m06:40:31.186237 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
drop table if exists "dagster"."public"."source3__dbt_backup" cascade
[0m06:40:31.205340 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m06:40:31.210624 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: Close
[0m06:40:31.218453 [debug] [Thread-2 (]: Database Error in model weather (models/staging/weather.sql)
  relation "public.weather" does not exist
  LINE 12: FROM public.weather
                ^
  compiled code at target/run/dagster_dbt_project/models/staging/weather.sql
[0m06:40:31.220041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6c504490>]}
[0m06:40:31.222640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43ac5ed-689a-4f20-ba90-485a33aefc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6c52d150>]}
[0m06:40:31.225253 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.source3 ................................ [[32mCREATE VIEW[0m in 0.46s]
[0m06:40:31.233471 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model public.weather ............................ [[31mERROR[0m in 0.46s]
[0m06:40:31.244215 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source3
[0m06:40:31.252171 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.weather
[0m06:40:31.265590 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.weather' to be skipped because of status 'error'.  Reason: Database Error in model weather (models/staging/weather.sql)
  relation "public.weather" does not exist
  LINE 12: FROM public.weather
                ^
  compiled code at target/run/dagster_dbt_project/models/staging/weather.sql.
[0m06:40:31.277439 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m06:40:31.280949 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.summary ............................................ [[33mSKIP[0m]
[0m06:40:31.292400 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m06:40:31.387029 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:31.389173 [debug] [MainThread]: On master: BEGIN
[0m06:40:31.390670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:40:31.612511 [debug] [MainThread]: SQL status: BEGIN in 0.222 seconds
[0m06:40:31.616954 [debug] [MainThread]: On master: COMMIT
[0m06:40:31.625705 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:31.641574 [debug] [MainThread]: On master: COMMIT
[0m06:40:31.648313 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m06:40:31.651379 [debug] [MainThread]: On master: Close
[0m06:40:31.656397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:31.688252 [debug] [MainThread]: Connection 'model.dagster_dbt_project.source3' was properly closed.
[0m06:40:31.691481 [debug] [MainThread]: Connection 'model.dagster_dbt_project.weather' was properly closed.
[0m06:40:31.695089 [info ] [MainThread]: 
[0m06:40:31.700646 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m06:40:31.714379 [debug] [MainThread]: Command end result
[0m06:40:32.304724 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m06:40:32.471551 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m06:40:32.942188 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m06:40:32.971299 [info ] [MainThread]: 
[0m06:40:33.009991 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:40:33.013208 [info ] [MainThread]: 
[0m06:40:33.018792 [error] [MainThread]: [31mFailure in model weather (models/staging/weather.sql)[0m
[0m06:40:33.422531 [error] [MainThread]:   Database Error in model weather (models/staging/weather.sql)
  relation "public.weather" does not exist
  LINE 12: FROM public.weather
                ^
  compiled code at target/run/dagster_dbt_project/models/staging/weather.sql
[0m06:40:33.430468 [info ] [MainThread]: 
[0m06:40:33.447568 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/weather.sql
[0m06:40:33.512592 [info ] [MainThread]: 
[0m06:40:33.516128 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m06:40:34.302525 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.942791, "process_in_blocks": "3384", "process_kernel_time": 2.880886, "process_mem_max_rss": "130116", "process_out_blocks": "1024", "process_user_time": 10.652474}
[0m06:40:35.485382 [debug] [MainThread]: Command `dbt run` failed at 06:40:35.441461 after 12.09 seconds
[0m06:40:35.925287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d75736590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d70f79b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d73ac8550>]}
[0m06:40:35.954809 [debug] [MainThread]: Flushing usage events
[0m06:40:39.060325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:31:18.053206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6628c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6628d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f66332490>]}


============================== 07:31:18.073090 | f22a4ad6-91c7-44ca-b490-07b003ed39f1 ==============================
[0m07:31:18.073090 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:31:18.074997 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'empty': 'False', 'profiles_dir': '/opt/dbt', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_path': '/opt/dbt/logs', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None'}
[0m07:31:18.694572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f64f07d90>]}
[0m07:31:18.794421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f68fd3210>]}
[0m07:31:18.796686 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:31:19.014889 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m07:31:19.833672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m07:31:19.842610 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m07:31:19.854620 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/weather.sql
[0m07:31:20.916154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f653ae810>]}
[0m07:31:21.118118 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:31:21.133349 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:31:21.333575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f63338090>]}
[0m07:31:21.335406 [info ] [MainThread]: Found 5 models, 447 macros
[0m07:31:21.337475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f63fdf4d0>]}
[0m07:31:21.349768 [info ] [MainThread]: 
[0m07:31:21.351846 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m07:31:21.360503 [info ] [MainThread]: 
[0m07:31:21.367775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:21.418470 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m07:31:22.670934 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m07:31:22.672872 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m07:31:22.674134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:22.752188 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.078 seconds
[0m07:31:22.756560 [debug] [ThreadPool]: On list_dagster: Close
[0m07:31:22.771504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_public)
[0m07:31:22.784340 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m07:31:22.786041 [debug] [ThreadPool]: On list_dagster_public: BEGIN
[0m07:31:22.787402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:22.816282 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m07:31:22.821609 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m07:31:22.823591 [debug] [ThreadPool]: On list_dagster_public: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_public"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:31:22.893956 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.066 seconds
[0m07:31:22.901997 [debug] [ThreadPool]: On list_dagster_public: ROLLBACK
[0m07:31:22.922448 [debug] [ThreadPool]: On list_dagster_public: Close
[0m07:31:22.994429 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:22.995879 [debug] [MainThread]: On master: BEGIN
[0m07:31:22.997147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:23.037266 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m07:31:23.038827 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:23.040358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m07:31:23.138177 [debug] [MainThread]: SQL status: SELECT 0 in 0.092 seconds
[0m07:31:23.140791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f690d9050>]}
[0m07:31:23.143361 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:23.144973 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:23.146522 [debug] [MainThread]: On master: BEGIN
[0m07:31:23.149711 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:31:23.151750 [debug] [MainThread]: On master: COMMIT
[0m07:31:23.163302 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:23.169305 [debug] [MainThread]: On master: COMMIT
[0m07:31:23.171199 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:23.172719 [debug] [MainThread]: On master: Close
[0m07:31:23.229398 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source1
[0m07:31:23.230236 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.source2
[0m07:31:23.232820 [info ] [Thread-1 (]: 1 of 5 START sql view model public.source1 ..................................... [RUN]
[0m07:31:23.235544 [info ] [Thread-2 (]: 2 of 5 START sql view model public.source2 ..................................... [RUN]
[0m07:31:23.237539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_public, now model.dagster_dbt_project.source1)
[0m07:31:23.239863 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.source2'
[0m07:31:23.242111 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source1
[0m07:31:23.245088 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.source2
[0m07:31:23.271913 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.source2"
[0m07:31:23.272529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source1"
[0m07:31:23.284587 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.source2
[0m07:31:23.285744 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source1
[0m07:31:23.498069 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.source2"
[0m07:31:23.497162 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source1"
[0m07:31:23.533634 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:31:23.537967 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:31:23.540539 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: BEGIN
[0m07:31:23.546917 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: BEGIN
[0m07:31:23.560051 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:31:23.563056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:23.614875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m07:31:23.619858 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:31:23.621515 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */

  create view "dagster"."public"."source1__dbt_tmp"
    
    
  as (
    SELECT id, value, value * 2 AS value_x2 FROM public.source1
  );
[0m07:31:23.623003 [debug] [Thread-2 (]: SQL status: BEGIN in 0.072 seconds
[0m07:31:23.635682 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:31:23.669134 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */

  create view "dagster"."public"."source2__dbt_tmp"
    
    
  as (
    SELECT id, score, score + 1 AS score_plus_one FROM public.source2
  );
[0m07:31:23.693434 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m07:31:23.694062 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.070 seconds
[0m07:31:23.718620 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:31:23.730126 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:31:23.732327 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2" rename to "source2__dbt_backup"
[0m07:31:23.734797 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1" rename to "source1__dbt_backup"
[0m07:31:23.762703 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m07:31:23.766833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m07:31:23.780653 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:31:23.788770 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:31:23.790476 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2__dbt_tmp" rename to "source2"
[0m07:31:23.799958 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1__dbt_tmp" rename to "source1"
[0m07:31:23.827591 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m07:31:23.828521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m07:31:23.935560 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:31:23.987169 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:31:24.004074 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:31:24.005625 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:31:24.014790 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:31:24.023540 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:31:24.025034 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m07:31:24.040279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m07:31:24.050952 [debug] [Thread-2 (]: Applying DROP to: "dagster"."public"."source2__dbt_backup"
[0m07:31:24.070372 [debug] [Thread-1 (]: Applying DROP to: "dagster"."public"."source1__dbt_backup"
[0m07:31:24.114330 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:31:24.116736 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
drop table if exists "dagster"."public"."source2__dbt_backup" cascade
[0m07:31:24.127722 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:31:24.132446 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
drop table if exists "dagster"."public"."source1__dbt_backup" cascade
[0m07:31:24.274971 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.135 seconds
[0m07:31:24.276486 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.158 seconds
[0m07:31:24.280977 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: Close
[0m07:31:24.284590 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: Close
[0m07:31:24.333164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6284ee50>]}
[0m07:31:24.333799 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f643f1110>]}
[0m07:31:24.348442 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.source1 ................................ [[32mCREATE VIEW[0m in 1.05s]
[0m07:31:24.365933 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source1
[0m07:31:24.368321 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source3
[0m07:31:24.356295 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.source2 ................................ [[32mCREATE VIEW[0m in 1.06s]
[0m07:31:24.371332 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.source2
[0m07:31:24.372981 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.weather
[0m07:31:24.380992 [info ] [Thread-2 (]: 4 of 5 START sql view model public.weather ..................................... [RUN]
[0m07:31:24.398291 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source2, now model.dagster_dbt_project.weather)
[0m07:31:24.369673 [info ] [Thread-1 (]: 3 of 5 START sql view model public.source3 ..................................... [RUN]
[0m07:31:24.528373 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.weather
[0m07:31:24.536632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source1, now model.dagster_dbt_project.source3)
[0m07:31:24.617786 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source3
[0m07:31:24.613793 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.weather"
[0m07:31:24.670799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source3"
[0m07:31:24.694964 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.weather
[0m07:31:24.729220 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.weather"
[0m07:31:24.731088 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source3
[0m07:31:24.745722 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source3"
[0m07:31:24.748922 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.weather"
[0m07:31:24.751746 [debug] [Thread-2 (]: On model.dagster_dbt_project.weather: BEGIN
[0m07:31:24.753369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:31:24.769233 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:31:24.774688 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: BEGIN
[0m07:31:24.778020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:24.819648 [debug] [Thread-2 (]: SQL status: BEGIN in 0.066 seconds
[0m07:31:24.820843 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.weather"
[0m07:31:24.822023 [debug] [Thread-2 (]: On model.dagster_dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.weather"} */

  create view "dagster"."public"."weather__dbt_tmp"
    
    
  as (
    config {
    "enabled": false
}


SELECT 
    name, 
    temperature, 
    windSpeed, 
    temperature * 1.8 + 32 AS temperature_f 
FROM public.weather
  );
[0m07:31:24.827837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m07:31:24.831016 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "config"
LINE 7:     config {
            ^

[0m07:31:24.832551 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:31:24.835270 [debug] [Thread-2 (]: On model.dagster_dbt_project.weather: ROLLBACK
[0m07:31:24.837878 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */

  create view "dagster"."public"."source3__dbt_tmp"
    
    
  as (
    SELECT 
    id, 
    category, 
    CASE WHEN category='A' 
        THEN 1 
        ELSE 0 
    END AS is_a 
FROM public.source3
  );
[0m07:31:24.840532 [debug] [Thread-2 (]: On model.dagster_dbt_project.weather: Close
[0m07:31:24.878013 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m07:31:24.888795 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:31:24.895687 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3" rename to "source3__dbt_backup"
[0m07:31:24.898204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:31:24.906312 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:31:24.918563 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3__dbt_tmp" rename to "source3"
[0m07:31:24.921011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:31:24.924759 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:31:24.927387 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:31:24.928819 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:31:24.934289 [debug] [Thread-2 (]: Database Error in model weather (models/staging/weather.sql)
  syntax error at or near "config"
  LINE 7:     config {
              ^
  compiled code at target/run/dagster_dbt_project/models/staging/weather.sql
[0m07:31:24.936082 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f60755bd0>]}
[0m07:31:24.938499 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model public.weather ............................ [[31mERROR[0m in 0.55s]
[0m07:31:24.940528 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.weather
[0m07:31:24.936924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m07:31:24.942976 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.weather' to be skipped because of status 'error'.  Reason: Database Error in model weather (models/staging/weather.sql)
  syntax error at or near "config"
  LINE 7:     config {
              ^
  compiled code at target/run/dagster_dbt_project/models/staging/weather.sql.
[0m07:31:24.947671 [debug] [Thread-1 (]: Applying DROP to: "dagster"."public"."source3__dbt_backup"
[0m07:31:24.951573 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:31:24.960810 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
drop table if exists "dagster"."public"."source3__dbt_backup" cascade
[0m07:31:24.971673 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:31:24.974263 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: Close
[0m07:31:24.976635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f22a4ad6-91c7-44ca-b490-07b003ed39f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f60736c10>]}
[0m07:31:24.978697 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.source3 ................................ [[32mCREATE VIEW[0m in 0.44s]
[0m07:31:24.980849 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source3
[0m07:31:24.984884 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.summary
[0m07:31:24.986417 [info ] [Thread-2 (]: 5 of 5 SKIP relation public.summary ............................................ [[33mSKIP[0m]
[0m07:31:24.987966 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.summary
[0m07:31:24.991803 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:24.995106 [debug] [MainThread]: On master: BEGIN
[0m07:31:24.996553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:25.019921 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m07:31:25.023037 [debug] [MainThread]: On master: COMMIT
[0m07:31:25.025744 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:25.030512 [debug] [MainThread]: On master: COMMIT
[0m07:31:25.032815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:25.036099 [debug] [MainThread]: On master: Close
[0m07:31:25.044937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:25.047988 [debug] [MainThread]: Connection 'model.dagster_dbt_project.source3' was properly closed.
[0m07:31:25.051302 [debug] [MainThread]: Connection 'model.dagster_dbt_project.weather' was properly closed.
[0m07:31:25.056102 [info ] [MainThread]: 
[0m07:31:25.073516 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m07:31:25.077761 [debug] [MainThread]: Command end result
[0m07:31:25.250436 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:31:25.269165 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:31:25.289399 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m07:31:25.291076 [info ] [MainThread]: 
[0m07:31:25.299613 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:31:25.536573 [info ] [MainThread]: 
[0m07:31:25.567007 [error] [MainThread]: [31mFailure in model weather (models/staging/weather.sql)[0m
[0m07:31:25.615081 [error] [MainThread]:   Database Error in model weather (models/staging/weather.sql)
  syntax error at or near "config"
  LINE 7:     config {
              ^
  compiled code at target/run/dagster_dbt_project/models/staging/weather.sql
[0m07:31:25.616567 [info ] [MainThread]: 
[0m07:31:25.618024 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/weather.sql
[0m07:31:25.619126 [info ] [MainThread]: 
[0m07:31:25.621085 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m07:31:25.628170 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.705993, "process_in_blocks": "2840", "process_kernel_time": 5.552802, "process_mem_max_rss": "129936", "process_out_blocks": "1024", "process_user_time": 8.477383}
[0m07:31:25.630001 [debug] [MainThread]: Command `dbt run` failed at 07:31:25.629675 after 7.71 seconds
[0m07:31:25.631900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f64f40a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f66586f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f66586b90>]}
[0m07:31:25.633570 [debug] [MainThread]: Flushing usage events
[0m07:31:26.915975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:09:25.139062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c07e8acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c07b90f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c07b6ac90>]}


============================== 00:09:25.175607 | 38641f3d-6d09-4517-aaaf-3a460cc2c47c ==============================
[0m00:09:25.175607 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:09:25.181380 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'log_path': '/opt/dbt/logs', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'quiet': 'False', 'printer_width': '80', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '/opt/dbt', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None'}
[0m00:09:26.073335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38641f3d-6d09-4517-aaaf-3a460cc2c47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c072df290>]}
[0m00:09:26.339118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38641f3d-6d09-4517-aaaf-3a460cc2c47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0a8dae10>]}
[0m00:09:26.342250 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:09:26.718483 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:09:27.437308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:09:27.440878 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/weather.sql
[0m00:09:29.197118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38641f3d-6d09-4517-aaaf-3a460cc2c47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c06bd0590>]}
[0m00:09:29.701823 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m00:09:29.735771 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m00:09:29.956876 [error] [MainThread]: Encountered an error:
Compilation Error
  'model.dagster_dbt_project.summary' depends on 'model.dagster_dbt_project.weather' which is not in the graph!
[0m00:09:29.966170 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0257506, "process_in_blocks": "1800", "process_kernel_time": 4.341353, "process_mem_max_rss": "118956", "process_out_blocks": "1000", "process_user_time": 14.050654}
[0m00:09:29.968927 [debug] [MainThread]: Command `dbt run` failed at 00:09:29.968609 after 5.03 seconds
[0m00:09:29.970633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c07b5aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c07c37850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c07c37ed0>]}
[0m00:09:29.973031 [debug] [MainThread]: Flushing usage events
[0m00:09:30.727016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:14:35.450336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb20a8ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1fb31310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1f9a4050>]}


============================== 00:14:35.461631 | df8acaf0-bdf4-477e-ac44-996b57cecdfe ==============================
[0m00:14:35.461631 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:14:35.464084 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/opt/dbt', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'version_check': 'True', 'log_path': '/opt/dbt/logs', 'static_parser': 'True'}
[0m00:14:36.080456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df8acaf0-bdf4-477e-ac44-996b57cecdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1f9a5810>]}
[0m00:14:36.278476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df8acaf0-bdf4-477e-ac44-996b57cecdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb227271d0>]}
[0m00:14:36.282479 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:14:36.462400 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:14:36.641138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:36.643180 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m00:14:36.994007 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dagster_dbt_project.summary' (models/marts/summary.sql) depends on a node named 'weather' which is disabled
[0m00:14:36.999252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7001928, "process_in_blocks": "0", "process_kernel_time": 1.014311, "process_mem_max_rss": "116460", "process_out_blocks": "0", "process_user_time": 4.042866}
[0m00:14:37.002243 [debug] [MainThread]: Command `dbt run` failed at 00:14:37.001792 after 1.70 seconds
[0m00:14:37.005526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1f9bd8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1f9bc090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1e1edb90>]}
[0m00:14:37.041651 [debug] [MainThread]: Flushing usage events
[0m00:14:37.566176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:17:13.233127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e8b71450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e8b73150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e8b71310>]}


============================== 00:17:13.240222 | b879482c-9c98-4251-94e1-ff018a4aedce ==============================
[0m00:17:13.240222 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:17:13.242415 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/dbt', 'log_cache_events': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/dbt/logs', 'log_format': 'default', 'invocation_command': 'dbt compile -s summary', 'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'version_check': 'True', 'warn_error': 'None'}
[0m00:17:13.514933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b879482c-9c98-4251-94e1-ff018a4aedce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e8ab6ad0>]}
[0m00:17:13.660286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b879482c-9c98-4251-94e1-ff018a4aedce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eb7673d0>]}
[0m00:17:13.662645 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:17:13.805625 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:17:13.980842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:17:13.982617 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m00:17:14.384091 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dagster_dbt_project.summary' (models/marts/summary.sql) depends on a node named 'weather' which is disabled
[0m00:17:14.387330 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.2634898, "process_in_blocks": "0", "process_kernel_time": 0.567086, "process_mem_max_rss": "115888", "process_out_blocks": "0", "process_user_time": 3.578581}
[0m00:17:14.389432 [debug] [MainThread]: Command `dbt compile` failed at 00:17:14.389132 after 1.27 seconds
[0m00:17:14.390861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e6b57b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e735bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e73e99d0>]}
[0m00:17:14.393388 [debug] [MainThread]: Flushing usage events
[0m00:17:14.816975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:09.163702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13c6849290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13c6874150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13c6833790>]}


============================== 00:20:09.173070 | ce5bfb49-7745-4df3-ad34-fe11d5ddff54 ==============================
[0m00:20:09.173070 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:20:09.175544 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/opt/dbt', 'empty': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'debug': 'False', 'log_path': '/opt/dbt/logs', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True'}
[0m00:20:09.637952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce5bfb49-7745-4df3-ad34-fe11d5ddff54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13c5bd0190>]}
[0m00:20:09.775895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce5bfb49-7745-4df3-ad34-fe11d5ddff54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13c9437010>]}
[0m00:20:09.778264 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:20:09.988138 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:20:10.149643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:20:10.151559 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m00:20:10.153047 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/weather.sql
[0m00:20:10.560303 [error] [MainThread]: Encountered an error:
Compilation Error in model weather (models/staging/weather.sql)
  expected token ',', got '='
    line 2
      --     enabled = false
[0m00:20:10.565637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5165272, "process_in_blocks": "0", "process_kernel_time": 2.210277, "process_mem_max_rss": "116572", "process_out_blocks": "0", "process_user_time": 4.620934}
[0m00:20:10.567646 [debug] [MainThread]: Command `dbt run` failed at 00:20:10.567450 after 1.52 seconds
[0m00:20:10.570667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13c66bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13c69da3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13c5750f90>]}
[0m00:20:10.572532 [debug] [MainThread]: Flushing usage events
[0m00:20:10.999520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:21:15.209556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2bc114050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2bc0d2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2bc0d2bd0>]}


============================== 00:21:15.216627 | 84000483-ea53-4fad-8741-3c28546ab6c7 ==============================
[0m00:21:15.216627 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:21:15.219686 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt run', 'profiles_dir': '/opt/dbt', 'log_path': '/opt/dbt/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'empty': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False'}
[0m00:21:15.783785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84000483-ea53-4fad-8741-3c28546ab6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2bb6c7e50>]}
[0m00:21:16.040491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84000483-ea53-4fad-8741-3c28546ab6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2becc54d0>]}
[0m00:21:16.043788 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:21:16.310381 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:21:16.741050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:21:16.743126 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/weather.sql
[0m00:21:16.745020 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m00:21:17.264706 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dagster_dbt_project.summary' (models/marts/summary.sql) depends on a node named 'weather' which is disabled
[0m00:21:17.272894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1714535, "process_in_blocks": "0", "process_kernel_time": 0.524304, "process_mem_max_rss": "116064", "process_out_blocks": "0", "process_user_time": 4.409125}
[0m00:21:17.275009 [debug] [MainThread]: Command `dbt run` failed at 00:21:17.274724 after 2.17 seconds
[0m00:21:17.278697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2bc0da390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2bc0db090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ba324950>]}
[0m00:21:17.297607 [debug] [MainThread]: Flushing usage events
[0m00:21:17.706287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:22:49.275054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe919ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91924110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9174fc50>]}


============================== 00:22:49.281401 | 6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb ==============================
[0m00:22:49.281401 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:22:49.284044 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True', 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'empty': 'False', 'log_path': '/opt/dbt/logs', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False'}
[0m00:22:49.552379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9402a090>]}
[0m00:22:49.657457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe944e9490>]}
[0m00:22:49.659667 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:22:49.786830 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:22:49.940676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:22:49.942303 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m00:22:49.943982 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/weather.sql
[0m00:22:50.385740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe907a8f50>]}
[0m00:22:50.564903 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m00:22:50.573469 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m00:22:50.617350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8f76bdd0>]}
[0m00:22:50.618704 [info ] [MainThread]: Found 4 models, 447 macros
[0m00:22:50.620712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91975010>]}
[0m00:22:50.632849 [info ] [MainThread]: 
[0m00:22:50.644012 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:22:50.646026 [info ] [MainThread]: 
[0m00:22:50.653149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:22:50.669090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m00:22:51.847793 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m00:22:51.850103 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m00:22:51.851473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:52.012836 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.161 seconds
[0m00:22:52.021598 [debug] [ThreadPool]: On list_dagster: Close
[0m00:22:52.027976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_public)
[0m00:22:52.070630 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m00:22:52.072672 [debug] [ThreadPool]: On list_dagster_public: BEGIN
[0m00:22:52.074254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:52.094480 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m00:22:52.096887 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m00:22:52.099455 [debug] [ThreadPool]: On list_dagster_public: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_public"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:22:52.237837 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.137 seconds
[0m00:22:52.242039 [debug] [ThreadPool]: On list_dagster_public: ROLLBACK
[0m00:22:52.243952 [debug] [ThreadPool]: On list_dagster_public: Close
[0m00:22:52.254496 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:52.255923 [debug] [MainThread]: On master: BEGIN
[0m00:22:52.257508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:22:52.273475 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m00:22:52.275125 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:52.276784 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:22:52.378617 [debug] [MainThread]: SQL status: SELECT 0 in 0.100 seconds
[0m00:22:52.382790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8fb2c550>]}
[0m00:22:52.385468 [debug] [MainThread]: On master: ROLLBACK
[0m00:22:52.387654 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:52.389148 [debug] [MainThread]: On master: BEGIN
[0m00:22:52.391817 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:22:52.396738 [debug] [MainThread]: On master: COMMIT
[0m00:22:52.401772 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:52.406327 [debug] [MainThread]: On master: COMMIT
[0m00:22:52.409453 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:22:52.411048 [debug] [MainThread]: On master: Close
[0m00:22:52.459366 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source1
[0m00:22:52.460313 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.source2
[0m00:22:52.461848 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source1 ..................................... [RUN]
[0m00:22:52.464205 [info ] [Thread-2 (]: 2 of 4 START sql view model public.source2 ..................................... [RUN]
[0m00:22:52.467109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_public, now model.dagster_dbt_project.source1)
[0m00:22:52.468945 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.source2'
[0m00:22:52.471650 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source1
[0m00:22:52.474353 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.source2
[0m00:22:52.492800 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source1"
[0m00:22:52.497358 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.source2"
[0m00:22:52.513924 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.source2
[0m00:22:52.515082 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source1
[0m00:22:52.660436 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source1"
[0m00:22:52.658519 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.source2"
[0m00:22:52.674635 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m00:22:52.676625 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m00:22:52.677426 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: BEGIN
[0m00:22:52.678848 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: BEGIN
[0m00:22:52.680442 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:22:52.683625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:52.711719 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m00:22:52.713366 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m00:22:52.715135 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */

  create view "dagster"."public"."source2__dbt_tmp"
    
    
  as (
    SELECT id, score, score + 1 AS score_plus_one FROM public.source2
  );
[0m00:22:52.720035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m00:22:52.722097 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m00:22:52.724202 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */

  create view "dagster"."public"."source1__dbt_tmp"
    
    
  as (
    SELECT id, value, value * 2 AS value_x2 FROM public.source1
  );
[0m00:22:52.805807 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.080 seconds
[0m00:22:52.806841 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.088 seconds
[0m00:22:52.820210 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m00:22:52.825622 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m00:22:52.827074 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1" rename to "source1__dbt_backup"
[0m00:22:52.828839 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2" rename to "source2__dbt_backup"
[0m00:22:52.850064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m00:22:52.851113 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m00:22:52.859491 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m00:22:52.865247 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m00:22:52.867135 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1__dbt_tmp" rename to "source1"
[0m00:22:52.868997 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2__dbt_tmp" rename to "source2"
[0m00:22:52.872931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:22:52.875505 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:22:52.907839 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m00:22:52.910309 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m00:22:52.911866 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m00:22:52.913726 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m00:22:52.916300 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m00:22:52.918076 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m00:22:52.922840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:22:52.929630 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m00:22:52.935114 [debug] [Thread-1 (]: Applying DROP to: "dagster"."public"."source1__dbt_backup"
[0m00:22:52.941167 [debug] [Thread-2 (]: Applying DROP to: "dagster"."public"."source2__dbt_backup"
[0m00:22:52.951585 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m00:22:52.953647 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m00:22:52.954934 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
drop table if exists "dagster"."public"."source1__dbt_backup" cascade
[0m00:22:52.956712 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
drop table if exists "dagster"."public"."source2__dbt_backup" cascade
[0m00:22:53.044479 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.085 seconds
[0m00:22:53.045668 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.087 seconds
[0m00:22:53.050490 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: Close
[0m00:22:53.053524 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: Close
[0m00:22:53.064808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8ffe4ad0>]}
[0m00:22:53.066138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8dfa0050>]}
[0m00:22:53.068305 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.source2 ................................ [[32mCREATE VIEW[0m in 0.59s]
[0m00:22:53.071038 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source1 ................................ [[32mCREATE VIEW[0m in 0.59s]
[0m00:22:53.076746 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.source2
[0m00:22:53.078928 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source1
[0m00:22:53.080694 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.source3
[0m00:22:53.084738 [info ] [Thread-2 (]: 3 of 4 START sql view model public.source3 ..................................... [RUN]
[0m00:22:53.204595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source2, now model.dagster_dbt_project.source3)
[0m00:22:53.245730 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.source3
[0m00:22:53.268297 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.source3"
[0m00:22:53.340753 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.source3
[0m00:22:53.386359 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.source3"
[0m00:22:53.396011 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m00:22:53.397521 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: BEGIN
[0m00:22:53.399211 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:22:53.423761 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m00:22:53.425939 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m00:22:53.427471 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */

  create view "dagster"."public"."source3__dbt_tmp"
    
    
  as (
    SELECT 
    id, 
    category, 
    CASE WHEN category='A' 
        THEN 1 
        ELSE 0 
    END AS is_a 
FROM public.source3
  );
[0m00:22:53.440049 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m00:22:53.446296 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m00:22:53.448032 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3" rename to "source3__dbt_backup"
[0m00:22:53.450824 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:22:53.456841 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m00:22:53.458414 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3__dbt_tmp" rename to "source3"
[0m00:22:53.463082 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:22:53.466984 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: COMMIT
[0m00:22:53.468668 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m00:22:53.470594 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: COMMIT
[0m00:22:53.476909 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m00:22:53.482189 [debug] [Thread-2 (]: Applying DROP to: "dagster"."public"."source3__dbt_backup"
[0m00:22:53.484627 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m00:22:53.486401 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
drop table if exists "dagster"."public"."source3__dbt_backup" cascade
[0m00:22:53.493775 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m00:22:53.497654 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: Close
[0m00:22:53.500518 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8df8a1d0>]}
[0m00:22:53.502665 [info ] [Thread-2 (]: 3 of 4 OK created sql view model public.source3 ................................ [[32mCREATE VIEW[0m in 0.30s]
[0m00:22:53.505238 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.source3
[0m00:22:53.508475 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m00:22:53.511036 [info ] [Thread-1 (]: 4 of 4 START sql view model public.summary ..................................... [RUN]
[0m00:22:53.513419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source1, now model.dagster_dbt_project.summary)
[0m00:22:53.514858 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m00:22:53.528122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m00:22:53.533634 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m00:22:53.553324 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m00:22:53.561602 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m00:22:53.563292 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m00:22:53.564578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:53.587462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m00:22:53.589562 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m00:22:53.590791 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  create view "dagster"."public"."summary__dbt_tmp"
    
    
  as (
    WITH joined AS (
  SELECT 
    s1.id, 
    s1.value_x2, 
    s2.score_plus_one, 
    s3.is_a 
    --, w.temperature, w.windSpeed
  FROM "dagster"."public"."source1" s1
  JOIN "dagster"."public"."source2" s2 USING (id)
  JOIN "dagster"."public"."source3" s3 USING (id)
)
SELECT 
  *, 
  (value_x2 + score_plus_one) * is_a AS metric 
FROM joined
  );
[0m00:22:53.602221 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source1" does not exist
LINE 14:   FROM "dagster"."public"."source1" s1
                ^

[0m00:22:53.604001 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: ROLLBACK
[0m00:22:53.605792 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m00:22:53.645921 [debug] [Thread-1 (]: Database Error in model summary (models/marts/summary.sql)
  relation "public.source1" does not exist
  LINE 14:   FROM "dagster"."public"."source1" s1
                  ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m00:22:53.647608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee99219-dc9c-4d8f-8c5d-ce889c2cbccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8c54b890>]}
[0m00:22:53.649812 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.summary ............................ [[31mERROR[0m in 0.13s]
[0m00:22:53.652819 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m00:22:53.655364 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.summary' to be skipped because of status 'error'.  Reason: Database Error in model summary (models/marts/summary.sql)
  relation "public.source1" does not exist
  LINE 14:   FROM "dagster"."public"."source1" s1
                  ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql.
[0m00:22:53.661998 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:53.663794 [debug] [MainThread]: On master: BEGIN
[0m00:22:53.665902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:22:53.690591 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m00:22:53.693430 [debug] [MainThread]: On master: COMMIT
[0m00:22:53.694801 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:53.696090 [debug] [MainThread]: On master: COMMIT
[0m00:22:53.700528 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m00:22:53.703009 [debug] [MainThread]: On master: Close
[0m00:22:53.707049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:53.708702 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m00:22:53.710451 [debug] [MainThread]: Connection 'model.dagster_dbt_project.source3' was properly closed.
[0m00:22:53.713643 [info ] [MainThread]: 
[0m00:22:53.716477 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m00:22:53.720629 [debug] [MainThread]: Command end result
[0m00:22:53.802653 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m00:22:53.807969 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m00:22:53.824255 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m00:22:53.825744 [info ] [MainThread]: 
[0m00:22:53.828371 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:22:53.830428 [info ] [MainThread]: 
[0m00:22:53.834514 [error] [MainThread]: [31mFailure in model summary (models/marts/summary.sql)[0m
[0m00:22:53.839267 [error] [MainThread]:   Database Error in model summary (models/marts/summary.sql)
  relation "public.source1" does not exist
  LINE 14:   FROM "dagster"."public"."source1" s1
                  ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m00:22:53.842649 [info ] [MainThread]: 
[0m00:22:53.846404 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/marts/summary.sql
[0m00:22:53.849905 [info ] [MainThread]: 
[0m00:22:53.854348 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:22:53.872785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.701027, "process_in_blocks": "16", "process_kernel_time": 1.324627, "process_mem_max_rss": "128916", "process_out_blocks": "24", "process_user_time": 5.102614}
[0m00:22:53.876205 [debug] [MainThread]: Command `dbt run` failed at 00:22:53.875944 after 4.70 seconds
[0m00:22:53.878506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91ba1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe96149a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9614a310>]}
[0m00:22:53.880293 [debug] [MainThread]: Flushing usage events
[0m00:22:54.293529 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:21:38.479247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fab2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fa84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fab150>]}


============================== 07:21:38.482027 | 250a89af-213b-40f6-ab77-49c5767f3888 ==============================
[0m07:21:38.482027 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:21:38.482887 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/opt/dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /opt/dbt', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': '/opt/dbt/logs', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'use_colors': 'True'}
[0m07:21:38.494303 [info ] [MainThread]: dbt version: 1.10.15
[0m07:21:38.495787 [info ] [MainThread]: python version: 3.11.14
[0m07:21:38.496430 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m07:21:38.497000 [info ] [MainThread]: os info: Linux-6.12.54-linuxkit-aarch64-with-glibc2.41
[0m07:21:38.580997 [info ] [MainThread]: Using profiles dir at /opt/dbt
[0m07:21:38.582766 [info ] [MainThread]: Using profiles.yml file at /opt/dbt/profiles.yml
[0m07:21:38.583572 [info ] [MainThread]: Using dbt_project.yml file at /opt/dbt/dbt_project.yml
[0m07:21:38.584481 [info ] [MainThread]: adapter type: postgres
[0m07:21:38.585137 [info ] [MainThread]: adapter version: 1.9.1
[0m07:21:38.635864 [info ] [MainThread]: Configuration:
[0m07:21:38.637094 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:21:38.638991 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:21:38.639671 [info ] [MainThread]: Required dependencies:
[0m07:21:38.640385 [debug] [MainThread]: Executing "git --help"
[0m07:21:38.653532 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:21:38.654991 [debug] [MainThread]: STDERR: "b''"
[0m07:21:38.655470 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:21:38.656909 [info ] [MainThread]: Connection:
[0m07:21:38.657385 [info ] [MainThread]:   host: postgres
[0m07:21:38.657895 [info ] [MainThread]:   port: 5432
[0m07:21:38.658388 [info ] [MainThread]:   user: dagster
[0m07:21:38.659959 [info ] [MainThread]:   database: dagster
[0m07:21:38.660420 [info ] [MainThread]:   schema: public
[0m07:21:38.660917 [info ] [MainThread]:   connect_timeout: 10
[0m07:21:38.661727 [info ] [MainThread]:   role: None
[0m07:21:38.662284 [info ] [MainThread]:   search_path: None
[0m07:21:38.662817 [info ] [MainThread]:   keepalives_idle: 0
[0m07:21:38.663401 [info ] [MainThread]:   sslmode: None
[0m07:21:38.664183 [info ] [MainThread]:   sslcert: None
[0m07:21:38.664990 [info ] [MainThread]:   sslkey: None
[0m07:21:38.665537 [info ] [MainThread]:   sslrootcert: None
[0m07:21:38.666089 [info ] [MainThread]:   application_name: dbt
[0m07:21:38.666524 [info ] [MainThread]:   retries: 1
[0m07:21:38.668064 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:21:38.711925 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m07:21:38.746148 [debug] [MainThread]: Using postgres connection "debug"
[0m07:21:38.747893 [debug] [MainThread]: On debug: select 1 as id
[0m07:21:38.748518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:21:38.786963 [debug] [MainThread]: SQL status: SELECT 1 in 0.038 seconds
[0m07:21:38.789622 [debug] [MainThread]: On debug: Close
[0m07:21:38.790373 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:21:38.791168 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:21:38.793043 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.354548, "process_in_blocks": "56592", "process_kernel_time": 0.423675, "process_mem_max_rss": "117636", "process_out_blocks": "1100", "process_user_time": 0.945831}
[0m07:21:38.793732 [debug] [MainThread]: Command `dbt debug` succeeded at 07:21:38.793673 after 0.36 seconds
[0m07:21:38.795164 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:21:38.796022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ea3510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c3c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e30d50>]}
[0m07:21:38.796709 [debug] [MainThread]: Flushing usage events
[0m07:21:39.189339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:22:20.186152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb17920d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2770c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb17c9150>]}


============================== 07:22:20.189191 | d951ef67-1688-4b47-bbab-9f22f25b521c ==============================
[0m07:22:20.189191 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:22:20.192225 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/opt/dbt', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'invocation_command': 'dbt debug --project-dir /opt/dbt', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/opt/dbt/logs', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'None', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m07:22:20.209483 [info ] [MainThread]: dbt version: 1.10.15
[0m07:22:20.215061 [info ] [MainThread]: python version: 3.11.14
[0m07:22:20.217752 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m07:22:20.219673 [info ] [MainThread]: os info: Linux-6.12.54-linuxkit-aarch64-with-glibc2.41
[0m07:22:20.258031 [info ] [MainThread]: Using profiles dir at /opt/dbt
[0m07:22:20.259393 [info ] [MainThread]: Using profiles.yml file at /opt/dbt/profiles.yml
[0m07:22:20.262252 [info ] [MainThread]: Using dbt_project.yml file at /opt/dbt/dbt_project.yml
[0m07:22:20.263050 [info ] [MainThread]: adapter type: postgres
[0m07:22:20.263905 [info ] [MainThread]: adapter version: 1.9.1
[0m07:22:20.318239 [info ] [MainThread]: Configuration:
[0m07:22:20.319621 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:22:20.320937 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:22:20.321616 [info ] [MainThread]: Required dependencies:
[0m07:22:20.322452 [debug] [MainThread]: Executing "git --help"
[0m07:22:20.324769 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:22:20.325513 [debug] [MainThread]: STDERR: "b''"
[0m07:22:20.326053 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:22:20.326588 [info ] [MainThread]: Connection:
[0m07:22:20.327158 [info ] [MainThread]:   host: postgres
[0m07:22:20.327687 [info ] [MainThread]:   port: 5432
[0m07:22:20.328181 [info ] [MainThread]:   user: dagster
[0m07:22:20.328669 [info ] [MainThread]:   database: dagster
[0m07:22:20.329186 [info ] [MainThread]:   schema: public
[0m07:22:20.329822 [info ] [MainThread]:   connect_timeout: 10
[0m07:22:20.330437 [info ] [MainThread]:   role: None
[0m07:22:20.330930 [info ] [MainThread]:   search_path: None
[0m07:22:20.331410 [info ] [MainThread]:   keepalives_idle: 0
[0m07:22:20.331899 [info ] [MainThread]:   sslmode: None
[0m07:22:20.332351 [info ] [MainThread]:   sslcert: None
[0m07:22:20.332852 [info ] [MainThread]:   sslkey: None
[0m07:22:20.333331 [info ] [MainThread]:   sslrootcert: None
[0m07:22:20.333834 [info ] [MainThread]:   application_name: dbt
[0m07:22:20.334319 [info ] [MainThread]:   retries: 1
[0m07:22:20.334963 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:22:20.364167 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m07:22:20.380081 [debug] [MainThread]: Using postgres connection "debug"
[0m07:22:20.381260 [debug] [MainThread]: On debug: select 1 as id
[0m07:22:20.382091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:22:20.398887 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m07:22:20.401477 [debug] [MainThread]: On debug: Close
[0m07:22:20.403085 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:22:20.405871 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:22:20.407370 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.29556626, "process_in_blocks": "0", "process_kernel_time": 0.342789, "process_mem_max_rss": "117512", "process_out_blocks": "12", "process_user_time": 1.048895}
[0m07:22:20.408147 [debug] [MainThread]: Command `dbt debug` succeeded at 07:22:20.408081 after 0.30 seconds
[0m07:22:20.408748 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:22:20.409980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0340d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0341450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1a32350>]}
[0m07:22:20.410672 [debug] [MainThread]: Flushing usage events
[0m07:22:20.747457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:22:32.408248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e098c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e099490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e099390>]}


============================== 07:22:32.410726 | 0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0 ==============================
[0m07:22:32.410726 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:22:32.411813 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'profiles_dir': '/opt/dbt', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/dbt/logs', 'warn_error': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False'}
[0m07:22:32.495898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d173850>]}
[0m07:22:32.524911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e14110>]}
[0m07:22:32.526321 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:22:32.557093 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:22:32.598547 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m07:22:32.601019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f01d690>]}
[0m07:22:33.045472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d11f850>]}
[0m07:22:33.103692 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:22:33.107382 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:22:33.123494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd118d0>]}
[0m07:22:33.124111 [info ] [MainThread]: Found 4 models, 459 macros
[0m07:22:33.124728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd6d210>]}
[0m07:22:33.125946 [info ] [MainThread]: 
[0m07:22:33.127074 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m07:22:33.127589 [info ] [MainThread]: 
[0m07:22:33.128161 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:22:33.130395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m07:22:33.147899 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m07:22:33.149193 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m07:22:33.150097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:33.163986 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m07:22:33.165002 [debug] [ThreadPool]: On list_dagster: Close
[0m07:22:33.166454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_public)
[0m07:22:33.170974 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m07:22:33.171448 [debug] [ThreadPool]: On list_dagster_public: BEGIN
[0m07:22:33.173040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:22:33.177344 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:22:33.177975 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m07:22:33.178546 [debug] [ThreadPool]: On list_dagster_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_public"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:22:33.184202 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m07:22:33.185339 [debug] [ThreadPool]: On list_dagster_public: ROLLBACK
[0m07:22:33.186034 [debug] [ThreadPool]: On list_dagster_public: Close
[0m07:22:33.188910 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:33.189361 [debug] [MainThread]: On master: BEGIN
[0m07:22:33.189801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:22:33.193944 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:22:33.194432 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:33.194921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m07:22:33.199171 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:22:33.200083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e996410>]}
[0m07:22:33.200665 [debug] [MainThread]: On master: ROLLBACK
[0m07:22:33.201190 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:33.201657 [debug] [MainThread]: On master: BEGIN
[0m07:22:33.202212 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:22:33.203044 [debug] [MainThread]: On master: COMMIT
[0m07:22:33.203486 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:33.203898 [debug] [MainThread]: On master: COMMIT
[0m07:22:33.206608 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:22:33.208870 [debug] [MainThread]: On master: Close
[0m07:22:33.218902 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source1
[0m07:22:33.219086 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.source2
[0m07:22:33.219833 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source1 ..................................... [RUN]
[0m07:22:33.220438 [info ] [Thread-2 (]: 2 of 4 START sql view model public.source2 ..................................... [RUN]
[0m07:22:33.221102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_public, now model.dagster_dbt_project.source1)
[0m07:22:33.221787 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.source2'
[0m07:22:33.222395 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source1
[0m07:22:33.222855 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.source2
[0m07:22:33.226222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source1"
[0m07:22:33.227485 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.source2"
[0m07:22:33.233273 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.source2
[0m07:22:33.233556 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source1
[0m07:22:33.251015 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.source2"
[0m07:22:33.253388 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source1"
[0m07:22:33.258107 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:22:33.258839 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: BEGIN
[0m07:22:33.258692 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:22:33.260245 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:22:33.260727 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: BEGIN
[0m07:22:33.261648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:33.266795 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m07:22:33.267463 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:22:33.267328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:22:33.267957 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */

  create view "dagster"."public"."source2__dbt_tmp"
    
    
  as (
    SELECT id, score, score + 1 AS score_plus_one FROM public.source2
  );
[0m07:22:33.268445 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:22:33.269518 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */

  create view "dagster"."public"."source1__dbt_tmp"
    
    
  as (
    SELECT id, value, value * 2 AS value_x2 FROM public.source1
  );
[0m07:22:33.273365 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m07:22:33.273503 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:22:33.276577 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:22:33.278322 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:22:33.278871 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2" rename to "source2__dbt_backup"
[0m07:22:33.280058 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1" rename to "source1__dbt_backup"
[0m07:22:33.281194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:22:33.282237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:22:33.283689 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:22:33.285328 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:22:33.285817 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2__dbt_tmp" rename to "source2"
[0m07:22:33.287064 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1__dbt_tmp" rename to "source1"
[0m07:22:33.288040 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:22:33.289492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:22:33.297122 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:22:33.297926 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:22:33.298566 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:22:33.299184 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:22:33.300177 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:22:33.300696 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:22:33.302103 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m07:22:33.302282 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:22:33.305187 [debug] [Thread-2 (]: Applying DROP to: "dagster"."public"."source2__dbt_backup"
[0m07:22:33.306609 [debug] [Thread-1 (]: Applying DROP to: "dagster"."public"."source1__dbt_backup"
[0m07:22:33.309172 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:22:33.309784 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:22:33.310277 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
drop table if exists "dagster"."public"."source2__dbt_backup" cascade
[0m07:22:33.310773 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
drop table if exists "dagster"."public"."source1__dbt_backup" cascade
[0m07:22:33.318051 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:22:33.318210 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:22:33.319846 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: Close
[0m07:22:33.321631 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: Close
[0m07:22:33.324306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c344d50>]}
[0m07:22:33.324442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c332190>]}
[0m07:22:33.326917 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.source2 ................................ [[32mCREATE VIEW[0m in 0.10s]
[0m07:22:33.326495 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source1 ................................ [[32mCREATE VIEW[0m in 0.10s]
[0m07:22:33.328110 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source1
[0m07:22:33.327602 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.source2
[0m07:22:33.328608 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source3
[0m07:22:33.330045 [info ] [Thread-1 (]: 3 of 4 START sql view model public.source3 ..................................... [RUN]
[0m07:22:33.330559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source1, now model.dagster_dbt_project.source3)
[0m07:22:33.331138 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source3
[0m07:22:33.332532 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source3"
[0m07:22:33.335117 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source3
[0m07:22:33.336964 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source3"
[0m07:22:33.339389 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:22:33.339866 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: BEGIN
[0m07:22:33.340331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:33.344378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:22:33.344902 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:22:33.345404 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */

  create view "dagster"."public"."source3__dbt_tmp"
    
    
  as (
    SELECT 
    id, 
    category, 
    CASE WHEN category='A' 
        THEN 1 
        ELSE 0 
    END AS is_a 
FROM public.source3
  );
[0m07:22:33.346507 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:22:33.349626 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:22:33.350139 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3" rename to "source3__dbt_backup"
[0m07:22:33.350764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:22:33.353316 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:22:33.353907 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3__dbt_tmp" rename to "source3"
[0m07:22:33.354542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:22:33.355467 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:22:33.357122 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:22:33.357683 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:22:33.358775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:22:33.360436 [debug] [Thread-1 (]: Applying DROP to: "dagster"."public"."source3__dbt_backup"
[0m07:22:33.361227 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:22:33.361756 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
drop table if exists "dagster"."public"."source3__dbt_backup" cascade
[0m07:22:33.363015 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:22:33.364002 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: Close
[0m07:22:33.364687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0d3750>]}
[0m07:22:33.365449 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.source3 ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m07:22:33.366290 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source3
[0m07:22:33.367142 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.summary
[0m07:22:33.367714 [info ] [Thread-2 (]: 4 of 4 START sql view model public.summary ..................................... [RUN]
[0m07:22:33.368460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source2, now model.dagster_dbt_project.summary)
[0m07:22:33.368924 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.summary
[0m07:22:33.370739 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m07:22:33.372470 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.summary
[0m07:22:33.374366 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m07:22:33.376034 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:22:33.376513 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: BEGIN
[0m07:22:33.376994 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:33.382483 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m07:22:33.382980 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:22:33.383469 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  create view "dagster"."public"."summary__dbt_tmp"
    
    
  as (
    WITH joined AS (
  SELECT 
    s1.id, 
    s1.value_x2, 
    s2.score_plus_one, 
    s3.is_a 
    --, w.temperature, w.windSpeed
  FROM "dagster"."public"."source1" s1
  JOIN "dagster"."public"."source2" s2 USING (id)
  JOIN "dagster"."public"."source3" s3 USING (id)
)
SELECT 
  *, 
  (value_x2 + score_plus_one) * is_a AS metric 
FROM joined
  );
[0m07:22:33.385249 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.source1" does not exist
LINE 14:   FROM "dagster"."public"."source1" s1
                ^

[0m07:22:33.385862 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: ROLLBACK
[0m07:22:33.386386 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: Close
[0m07:22:33.393147 [debug] [Thread-2 (]: Database Error in model summary (models/marts/summary.sql)
  relation "public.source1" does not exist
  LINE 14:   FROM "dagster"."public"."source1" s1
                  ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m07:22:33.394141 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0389bbfe-f9bd-4eed-a0a3-ed492fe97ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd26450>]}
[0m07:22:33.395197 [error] [Thread-2 (]: 4 of 4 ERROR creating sql view model public.summary ............................ [[31mERROR[0m in 0.03s]
[0m07:22:33.395829 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.summary
[0m07:22:33.396324 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.summary' to be skipped because of status 'error'.  Reason: Database Error in model summary (models/marts/summary.sql)
  relation "public.source1" does not exist
  LINE 14:   FROM "dagster"."public"."source1" s1
                  ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql.
[0m07:22:33.397474 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:33.397944 [debug] [MainThread]: On master: BEGIN
[0m07:22:33.398915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:22:33.402714 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:22:33.403176 [debug] [MainThread]: On master: COMMIT
[0m07:22:33.403615 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:33.404062 [debug] [MainThread]: On master: COMMIT
[0m07:22:33.404544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:22:33.405007 [debug] [MainThread]: On master: Close
[0m07:22:33.405460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:33.405877 [debug] [MainThread]: Connection 'model.dagster_dbt_project.source3' was properly closed.
[0m07:22:33.406487 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m07:22:33.406949 [info ] [MainThread]: 
[0m07:22:33.407473 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m07:22:33.408208 [debug] [MainThread]: Command end result
[0m07:22:33.443210 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:22:33.446471 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:22:33.452163 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m07:22:33.452627 [info ] [MainThread]: 
[0m07:22:33.453177 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:22:33.453817 [info ] [MainThread]: 
[0m07:22:33.454282 [error] [MainThread]: [31mFailure in model summary (models/marts/summary.sql)[0m
[0m07:22:33.454783 [error] [MainThread]:   Database Error in model summary (models/marts/summary.sql)
  relation "public.source1" does not exist
  LINE 14:   FROM "dagster"."public"."source1" s1
                  ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m07:22:33.455258 [info ] [MainThread]: 
[0m07:22:33.455738 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/marts/summary.sql
[0m07:22:33.456233 [info ] [MainThread]: 
[0m07:22:33.456976 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m07:22:33.457777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0800709, "process_in_blocks": "3008", "process_kernel_time": 0.241811, "process_mem_max_rss": "129040", "process_out_blocks": "2821", "process_user_time": 1.336484}
[0m07:22:33.458277 [debug] [MainThread]: Command `dbt run` failed at 07:22:33.458232 after 1.08 seconds
[0m07:22:33.458762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e059d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93001790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93002590>]}
[0m07:22:33.459242 [debug] [MainThread]: Flushing usage events
[0m07:22:33.795472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:32:05.872315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d48110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d48d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d48e50>]}


============================== 07:32:05.874456 | c344cbd4-a120-4094-abbd-069bb280e8a1 ==============================
[0m07:32:05.874456 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:32:05.875327 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_path': '/opt/dbt/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/dbt', 'fail_fast': 'False'}
[0m07:32:05.954619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e27cd0>]}
[0m07:32:05.982627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ab3d50>]}
[0m07:32:05.984607 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:32:06.019315 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:32:06.085068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:32:06.085715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:32:06.098443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c3d390>]}
[0m07:32:06.158864 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:32:06.161073 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:32:06.170999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4baf750>]}
[0m07:32:06.172353 [info ] [MainThread]: Found 4 models, 459 macros
[0m07:32:06.172968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c3db90>]}
[0m07:32:06.174183 [info ] [MainThread]: 
[0m07:32:06.174718 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m07:32:06.175205 [info ] [MainThread]: 
[0m07:32:06.175814 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:32:06.178161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m07:32:06.202277 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m07:32:06.203603 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m07:32:06.204169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:06.215471 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m07:32:06.216497 [debug] [ThreadPool]: On list_dagster: Close
[0m07:32:06.217681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster_public'
[0m07:32:06.222340 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m07:32:06.223114 [debug] [ThreadPool]: On list_dagster_public: BEGIN
[0m07:32:06.223576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:06.227480 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:32:06.228013 [debug] [ThreadPool]: Using postgres connection "list_dagster_public"
[0m07:32:06.228516 [debug] [ThreadPool]: On list_dagster_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_public"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:32:06.235703 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m07:32:06.236922 [debug] [ThreadPool]: On list_dagster_public: ROLLBACK
[0m07:32:06.237462 [debug] [ThreadPool]: On list_dagster_public: Close
[0m07:32:06.240289 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:06.241169 [debug] [MainThread]: On master: BEGIN
[0m07:32:06.242169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:32:06.246326 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:32:06.246943 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:06.247466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m07:32:06.253403 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:32:06.254338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa852d910>]}
[0m07:32:06.254906 [debug] [MainThread]: On master: ROLLBACK
[0m07:32:06.255404 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:06.255846 [debug] [MainThread]: On master: BEGIN
[0m07:32:06.256352 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:32:06.257113 [debug] [MainThread]: On master: COMMIT
[0m07:32:06.257531 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:06.257953 [debug] [MainThread]: On master: COMMIT
[0m07:32:06.258429 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:32:06.258881 [debug] [MainThread]: On master: Close
[0m07:32:06.260988 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source1
[0m07:32:06.261158 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.source2
[0m07:32:06.261590 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source1 ..................................... [RUN]
[0m07:32:06.262246 [info ] [Thread-2 (]: 2 of 4 START sql view model public.source2 ..................................... [RUN]
[0m07:32:06.262767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_public, now model.dagster_dbt_project.source1)
[0m07:32:06.263461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dagster, now model.dagster_dbt_project.source2)
[0m07:32:06.265174 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source1
[0m07:32:06.265746 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.source2
[0m07:32:06.269265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source1"
[0m07:32:06.270493 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.source2"
[0m07:32:06.274024 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source1
[0m07:32:06.274530 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.source2
[0m07:32:06.291798 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source1"
[0m07:32:06.293283 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.source2"
[0m07:32:06.294930 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:32:06.296510 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: BEGIN
[0m07:32:06.299078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:06.296815 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:32:06.301942 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: BEGIN
[0m07:32:06.303759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:32:06.305026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:32:06.305569 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:32:06.307869 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */

  create view "dagster"."public"."source1__dbt_tmp"
    
    
  as (
    SELECT id, value, value * 2 AS value_x2 FROM public.source1
  );
[0m07:32:06.308437 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m07:32:06.308977 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:32:06.309490 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */

  create view "dagster"."public"."source2__dbt_tmp"
    
    
  as (
    SELECT id, score, score + 1 AS score_plus_one FROM public.source2
  );
[0m07:32:06.313286 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:32:06.313457 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:32:06.317256 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:32:06.344852 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:32:06.345446 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1" rename to "source1__dbt_backup"
[0m07:32:06.346106 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2" rename to "source2__dbt_backup"
[0m07:32:06.347177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:32:06.347535 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:32:06.349231 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:32:06.351178 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:32:06.351735 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."public"."source1__dbt_tmp" rename to "source1"
[0m07:32:06.353502 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."public"."source2__dbt_tmp" rename to "source2"
[0m07:32:06.354259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:32:06.354693 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:32:06.362390 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:32:06.363234 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:32:06.364418 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:32:06.363876 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:32:06.365000 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:32:06.365549 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:32:06.367169 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m07:32:06.367342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:32:06.370956 [debug] [Thread-2 (]: Applying DROP to: "dagster"."public"."source2__dbt_backup"
[0m07:32:06.372347 [debug] [Thread-1 (]: Applying DROP to: "dagster"."public"."source1__dbt_backup"
[0m07:32:06.375991 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:32:06.375225 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:32:06.376458 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
drop table if exists "dagster"."public"."source1__dbt_backup" cascade
[0m07:32:06.376932 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
drop table if exists "dagster"."public"."source2__dbt_backup" cascade
[0m07:32:06.379209 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:32:06.379383 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:32:06.380642 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: Close
[0m07:32:06.382769 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: Close
[0m07:32:06.384363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bfc1d0>]}
[0m07:32:06.385258 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source1 ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m07:32:06.384504 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f0f950>]}
[0m07:32:06.385889 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source1
[0m07:32:06.387535 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.source2 ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m07:32:06.387931 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source3
[0m07:32:06.390243 [info ] [Thread-1 (]: 3 of 4 START sql view model public.source3 ..................................... [RUN]
[0m07:32:06.388493 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.source2
[0m07:32:06.390871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source1, now model.dagster_dbt_project.source3)
[0m07:32:06.391896 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source3
[0m07:32:06.393089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source3"
[0m07:32:06.395400 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source3
[0m07:32:06.397329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source3"
[0m07:32:06.398841 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:32:06.399328 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: BEGIN
[0m07:32:06.399797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:06.403874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:32:06.404351 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:32:06.404807 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */

  create view "dagster"."public"."source3__dbt_tmp"
    
    
  as (
    SELECT 
    id, 
    category, 
    CASE WHEN category='A' 
        THEN 1 
        ELSE 0 
    END AS is_a 
FROM public.source3
  );
[0m07:32:06.405875 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:32:06.407556 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:32:06.408013 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3" rename to "source3__dbt_backup"
[0m07:32:06.408597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:32:06.411480 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:32:06.413219 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."public"."source3__dbt_tmp" rename to "source3"
[0m07:32:06.413950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:32:06.414878 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:32:06.415494 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:32:06.416082 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:32:06.417275 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:32:06.419578 [debug] [Thread-1 (]: Applying DROP to: "dagster"."public"."source3__dbt_backup"
[0m07:32:06.421457 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:32:06.422064 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
drop table if exists "dagster"."public"."source3__dbt_backup" cascade
[0m07:32:06.424519 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:32:06.425493 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: Close
[0m07:32:06.426045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c1c610>]}
[0m07:32:06.428525 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.source3 ................................ [[32mCREATE VIEW[0m in 0.04s]
[0m07:32:06.429337 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source3
[0m07:32:06.430084 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.summary
[0m07:32:06.432218 [info ] [Thread-2 (]: 4 of 4 START sql view model public.summary ..................................... [RUN]
[0m07:32:06.432852 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source2, now model.dagster_dbt_project.summary)
[0m07:32:06.433354 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.summary
[0m07:32:06.435567 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m07:32:06.438034 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.summary
[0m07:32:06.439861 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m07:32:06.441067 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:32:06.441527 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: BEGIN
[0m07:32:06.441969 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:32:06.445960 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m07:32:06.446464 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:32:06.448238 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  create view "dagster"."public"."summary__dbt_tmp"
    
    
  as (
    WITH joined AS (
  SELECT 
    s1.id, 
    s1.value_x2, 
    s2.score_plus_one, 
    s3.is_a 
    --, w.temperature, w.windSpeed
  FROM "dagster"."public"."source1" s1
  JOIN "dagster"."public"."source2" s2 USING (id)
  JOIN "dagster"."public"."source3" s3 USING (id)
)
SELECT 
  *, 
  (value_x2 + score_plus_one) * is_a AS metric 
FROM joined
  );
[0m07:32:06.448875 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.source1" does not exist
LINE 14:   FROM "dagster"."public"."source1" s1
                ^

[0m07:32:06.449312 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: ROLLBACK
[0m07:32:06.449816 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: Close
[0m07:32:06.452237 [debug] [Thread-2 (]: Database Error in model summary (models/marts/summary.sql)
  relation "public.source1" does not exist
  LINE 14:   FROM "dagster"."public"."source1" s1
                  ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m07:32:06.453025 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c344cbd4-a120-4094-abbd-069bb280e8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d5c850>]}
[0m07:32:06.453593 [error] [Thread-2 (]: 4 of 4 ERROR creating sql view model public.summary ............................ [[31mERROR[0m in 0.02s]
[0m07:32:06.454212 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.summary
[0m07:32:06.454779 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.summary' to be skipped because of status 'error'.  Reason: Database Error in model summary (models/marts/summary.sql)
  relation "public.source1" does not exist
  LINE 14:   FROM "dagster"."public"."source1" s1
                  ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql.
[0m07:32:06.455957 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:06.456412 [debug] [MainThread]: On master: BEGIN
[0m07:32:06.456857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:32:06.460960 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:32:06.461518 [debug] [MainThread]: On master: COMMIT
[0m07:32:06.462058 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:06.462570 [debug] [MainThread]: On master: COMMIT
[0m07:32:06.463144 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:32:06.463661 [debug] [MainThread]: On master: Close
[0m07:32:06.464421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:32:06.464940 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m07:32:06.465541 [debug] [MainThread]: Connection 'model.dagster_dbt_project.source3' was properly closed.
[0m07:32:06.466138 [info ] [MainThread]: 
[0m07:32:06.466750 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m07:32:06.467586 [debug] [MainThread]: Command end result
[0m07:32:06.512412 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:32:06.514430 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:32:06.518386 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m07:32:06.518913 [info ] [MainThread]: 
[0m07:32:06.519519 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:32:06.521271 [info ] [MainThread]: 
[0m07:32:06.521828 [error] [MainThread]: [31mFailure in model summary (models/marts/summary.sql)[0m
[0m07:32:06.523106 [error] [MainThread]:   Database Error in model summary (models/marts/summary.sql)
  relation "public.source1" does not exist
  LINE 14:   FROM "dagster"."public"."source1" s1
                  ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m07:32:06.523594 [info ] [MainThread]: 
[0m07:32:06.524046 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/marts/summary.sql
[0m07:32:06.524473 [info ] [MainThread]: 
[0m07:32:06.524950 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m07:32:06.525832 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6824315, "process_in_blocks": "0", "process_kernel_time": 0.374429, "process_mem_max_rss": "125336", "process_out_blocks": "1821", "process_user_time": 1.228531}
[0m07:32:06.527112 [debug] [MainThread]: Command `dbt run` failed at 07:32:06.527068 after 0.68 seconds
[0m07:32:06.527626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c27b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaacb1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7000750>]}
[0m07:32:06.528116 [debug] [MainThread]: Flushing usage events
[0m07:32:06.893189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:41:12.711520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933a3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945b4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9333a750>]}


============================== 07:41:12.715215 | e6e4f701-6848-4bf3-90c2-ebcfe010e517 ==============================
[0m07:41:12.715215 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:41:12.715942 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_path': '/opt/dbt/logs', 'empty': 'False', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'profiles_dir': '/opt/dbt', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'target_path': 'None', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True'}
[0m07:41:12.803571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93345c50>]}
[0m07:41:12.834409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960f8090>]}
[0m07:41:12.836284 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:41:12.868555 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:41:12.905624 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:41:12.907464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942fd510>]}
[0m07:41:13.345425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91645250>]}
[0m07:41:13.403960 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:41:13.406426 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:41:13.418086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91680690>]}
[0m07:41:13.418706 [info ] [MainThread]: Found 4 models, 459 macros
[0m07:41:13.419355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fb1190>]}
[0m07:41:13.420607 [info ] [MainThread]: 
[0m07:41:13.421148 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m07:41:13.421638 [info ] [MainThread]: 
[0m07:41:13.422253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:41:13.424478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m07:41:13.446523 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m07:41:13.448403 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m07:41:13.450205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:13.462009 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m07:41:13.463043 [debug] [ThreadPool]: On list_dagster: Close
[0m07:41:13.464582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m07:41:13.468643 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m07:41:13.469151 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m07:41:13.469605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:41:13.473568 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:41:13.474101 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m07:41:13.474541 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m07:41:13.477927 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m07:41:13.478776 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m07:41:13.479276 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m07:41:13.481667 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:13.483359 [debug] [MainThread]: On master: BEGIN
[0m07:41:13.483792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:41:13.487467 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:41:13.487987 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:13.488497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m07:41:13.491789 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m07:41:13.492600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93289510>]}
[0m07:41:13.493332 [debug] [MainThread]: On master: ROLLBACK
[0m07:41:13.493935 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:13.494450 [debug] [MainThread]: On master: BEGIN
[0m07:41:13.495118 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:41:13.495690 [debug] [MainThread]: On master: COMMIT
[0m07:41:13.496226 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:13.496828 [debug] [MainThread]: On master: COMMIT
[0m07:41:13.497462 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:41:13.497980 [debug] [MainThread]: On master: Close
[0m07:41:13.501362 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source1
[0m07:41:13.501570 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.source2
[0m07:41:13.502009 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.source1 .................................. [RUN]
[0m07:41:13.502723 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.source2 .................................. [RUN]
[0m07:41:13.503407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.source1)
[0m07:41:13.504009 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.source2'
[0m07:41:13.504492 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source1
[0m07:41:13.505106 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.source2
[0m07:41:13.509065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source1"
[0m07:41:13.510331 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.source2"
[0m07:41:13.511933 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source1
[0m07:41:13.512341 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.source2
[0m07:41:13.533792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source1"
[0m07:41:13.536527 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.source2"
[0m07:41:13.539772 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:41:13.540264 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:41:13.542169 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: BEGIN
[0m07:41:13.542745 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: BEGIN
[0m07:41:13.544640 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:41:13.544162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:13.552061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:41:13.552776 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:41:13.553199 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m07:41:13.553354 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */

  create view "dagster"."analytics"."source1__dbt_tmp"
    
    
  as (
    SELECT id, value, value * 2 AS value_x2 FROM public.source1
  );
[0m07:41:13.554167 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:41:13.555991 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:41:13.556356 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */

  create view "dagster"."analytics"."source2__dbt_tmp"
    
    
  as (
    SELECT id, score, score + 1 AS score_plus_one FROM public.source2
  );
[0m07:41:13.559605 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:41:13.560536 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."analytics"."source1__dbt_tmp" rename to "source1"
[0m07:41:13.560789 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:41:13.561357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:41:13.563211 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:41:13.570367 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:41:13.570724 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."analytics"."source2__dbt_tmp" rename to "source2"
[0m07:41:13.571280 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:41:13.572109 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:41:13.573273 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:41:13.572405 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:41:13.573714 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:41:13.574567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:41:13.575000 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:41:13.578070 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."source1__dbt_backup"
[0m07:41:13.578875 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m07:41:13.580973 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:41:13.582629 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."source2__dbt_backup"
[0m07:41:13.583150 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
drop view if exists "dagster"."analytics"."source1__dbt_backup" cascade
[0m07:41:13.584003 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:41:13.584852 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
drop view if exists "dagster"."analytics"."source2__dbt_backup" cascade
[0m07:41:13.584997 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:41:13.586238 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:41:13.587541 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: Close
[0m07:41:13.588480 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: Close
[0m07:41:13.589928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cffed0>]}
[0m07:41:13.590078 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920de990>]}
[0m07:41:13.591340 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.source1 ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m07:41:13.591926 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.source2 ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m07:41:13.592357 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source1
[0m07:41:13.593420 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source3
[0m07:41:13.592934 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.source2
[0m07:41:13.594382 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.source3 .................................. [RUN]
[0m07:41:13.595446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source1, now model.dagster_dbt_project.source3)
[0m07:41:13.595921 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source3
[0m07:41:13.597172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source3"
[0m07:41:13.599386 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source3
[0m07:41:13.601385 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source3"
[0m07:41:13.604161 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:41:13.604782 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: BEGIN
[0m07:41:13.606332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:13.610200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:41:13.610674 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:41:13.611128 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */

  create view "dagster"."analytics"."source3__dbt_tmp"
    
    
  as (
    SELECT 
    id, 
    category, 
    CASE WHEN category='A' 
        THEN 1 
        ELSE 0 
    END AS is_a 
FROM public.source3
  );
[0m07:41:13.612623 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:41:13.614538 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:41:13.615041 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."analytics"."source3__dbt_tmp" rename to "source3"
[0m07:41:13.616160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:41:13.617361 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:41:13.617837 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:41:13.618297 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:41:13.619108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:41:13.620491 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."source3__dbt_backup"
[0m07:41:13.621068 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:41:13.621544 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
drop view if exists "dagster"."analytics"."source3__dbt_backup" cascade
[0m07:41:13.622090 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:41:13.623472 [debug] [Thread-1 (]: On model.dagster_dbt_project.source3: Close
[0m07:41:13.624118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a54490>]}
[0m07:41:13.624789 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.source3 ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m07:41:13.625408 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source3
[0m07:41:13.626150 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.summary
[0m07:41:13.626652 [info ] [Thread-2 (]: 4 of 4 START sql view model analytics.summary .................................. [RUN]
[0m07:41:13.627212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source2, now model.dagster_dbt_project.summary)
[0m07:41:13.627663 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.summary
[0m07:41:13.629755 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m07:41:13.631289 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.summary
[0m07:41:13.634126 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m07:41:13.638351 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:41:13.638850 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: BEGIN
[0m07:41:13.641207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:41:13.645134 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m07:41:13.646442 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:41:13.646919 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  create view "dagster"."analytics"."summary__dbt_tmp"
    
    
  as (
    WITH joined AS (
  SELECT 
    s1.id, 
    s1.value_x2, 
    s2.score_plus_one, 
    s3.is_a 
    --, w.temperature, w.windSpeed
  FROM "dagster"."analytics"."source1" s1
  JOIN "dagster"."analytics"."source2" s2 USING (id)
  JOIN "dagster"."analytics"."source3" s3 USING (id)
)
SELECT 
  *, 
  (value_x2 + score_plus_one) * is_a AS metric 
FROM joined
  );
[0m07:41:13.649020 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:41:13.650668 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:41:13.651409 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary__dbt_tmp" rename to "summary"
[0m07:41:13.652158 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:41:13.653073 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: COMMIT
[0m07:41:13.653561 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:41:13.654039 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: COMMIT
[0m07:41:13.654894 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m07:41:13.656300 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."summary__dbt_backup"
[0m07:41:13.657272 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:41:13.657763 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
drop view if exists "dagster"."analytics"."summary__dbt_backup" cascade
[0m07:41:13.659424 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:41:13.661604 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: Close
[0m07:41:13.662262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e4f701-6848-4bf3-90c2-ebcfe010e517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90183690>]}
[0m07:41:13.662898 [info ] [Thread-2 (]: 4 of 4 OK created sql view model analytics.summary ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m07:41:13.664381 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.summary
[0m07:41:13.665392 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:13.665835 [debug] [MainThread]: On master: BEGIN
[0m07:41:13.666250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:41:13.670137 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:41:13.670693 [debug] [MainThread]: On master: COMMIT
[0m07:41:13.671279 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:13.671815 [debug] [MainThread]: On master: COMMIT
[0m07:41:13.672413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:41:13.672965 [debug] [MainThread]: On master: Close
[0m07:41:13.673575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:41:13.674085 [debug] [MainThread]: Connection 'model.dagster_dbt_project.source3' was properly closed.
[0m07:41:13.674667 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m07:41:13.676199 [info ] [MainThread]: 
[0m07:41:13.676939 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m07:41:13.677786 [debug] [MainThread]: Command end result
[0m07:41:13.711013 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:41:13.713075 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:41:13.716956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m07:41:13.717429 [info ] [MainThread]: 
[0m07:41:13.718073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:41:13.718538 [info ] [MainThread]: 
[0m07:41:13.719010 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m07:41:13.720608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0424764, "process_in_blocks": "0", "process_kernel_time": 0.259038, "process_mem_max_rss": "127792", "process_out_blocks": "2698", "process_user_time": 1.303223}
[0m07:41:13.721165 [debug] [MainThread]: Command `dbt run` succeeded at 07:41:13.721115 after 1.04 seconds
[0m07:41:13.721622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982e2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982e18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982e2890>]}
[0m07:41:13.722074 [debug] [MainThread]: Flushing usage events
[0m07:41:14.091732 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:45:08.824743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fd5c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fd4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fa1cd0>]}


============================== 07:45:08.827922 | 1feaa003-bdde-4539-9118-835a265ac829 ==============================
[0m07:45:08.827922 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:45:08.828867 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/dbt/logs', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'profiles_dir': '/opt/dbt'}
[0m07:45:08.907013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93078690>]}
[0m07:45:08.933620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f65c50>]}
[0m07:45:08.934580 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:45:08.963993 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:45:09.020241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:45:09.020925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:45:09.033867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cf9010>]}
[0m07:45:09.090380 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:45:09.093545 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:45:09.102101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e4b3d0>]}
[0m07:45:09.102701 [info ] [MainThread]: Found 4 models, 459 macros
[0m07:45:09.103260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ee5590>]}
[0m07:45:09.104436 [info ] [MainThread]: 
[0m07:45:09.105022 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m07:45:09.105616 [info ] [MainThread]: 
[0m07:45:09.106261 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:45:09.108739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m07:45:09.128081 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m07:45:09.128764 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m07:45:09.129842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:09.144249 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m07:45:09.146508 [debug] [ThreadPool]: On list_dagster: Close
[0m07:45:09.148329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m07:45:09.151841 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m07:45:09.152782 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m07:45:09.153368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:09.158357 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:45:09.159061 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m07:45:09.159648 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m07:45:09.162370 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:45:09.163532 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m07:45:09.164224 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m07:45:09.167362 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:09.168050 [debug] [MainThread]: On master: BEGIN
[0m07:45:09.168648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:09.174164 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:45:09.174711 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:09.175268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m07:45:09.177828 [debug] [MainThread]: SQL status: SELECT 6 in 0.002 seconds
[0m07:45:09.179189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92018e50>]}
[0m07:45:09.179782 [debug] [MainThread]: On master: ROLLBACK
[0m07:45:09.180398 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:09.180936 [debug] [MainThread]: On master: BEGIN
[0m07:45:09.181609 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:45:09.182213 [debug] [MainThread]: On master: COMMIT
[0m07:45:09.182781 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:09.183359 [debug] [MainThread]: On master: COMMIT
[0m07:45:09.183980 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:09.184496 [debug] [MainThread]: On master: Close
[0m07:45:09.186546 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.source1
[0m07:45:09.186746 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.source2
[0m07:45:09.188031 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.source1 .................................. [RUN]
[0m07:45:09.188813 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.source2 .................................. [RUN]
[0m07:45:09.190941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.source1)
[0m07:45:09.193100 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.source2'
[0m07:45:09.193691 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.source1
[0m07:45:09.195905 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.source2
[0m07:45:09.199736 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.source1"
[0m07:45:09.201778 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.source2"
[0m07:45:09.203881 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.source1
[0m07:45:09.204300 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.source2
[0m07:45:09.223433 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.source1"
[0m07:45:09.224980 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.source2"
[0m07:45:09.226911 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:45:09.227560 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:45:09.229100 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: BEGIN
[0m07:45:09.230678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:09.229962 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: BEGIN
[0m07:45:09.232789 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:45:09.237648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:45:09.238250 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:45:09.238068 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m07:45:09.238785 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */

  create view "dagster"."analytics"."source1__dbt_tmp"
    
    
  as (
    SELECT id, value, value * 2 AS value_x2 FROM public.source1
  );
[0m07:45:09.239310 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:45:09.240202 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */

  create view "dagster"."analytics"."source2__dbt_tmp"
    
    
  as (
    SELECT id, score, score + 1 AS score_plus_one FROM public.source2
  );
[0m07:45:09.241199 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:09.242241 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:09.246254 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:45:09.276159 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:45:09.276644 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."analytics"."source1" rename to "source1__dbt_backup"
[0m07:45:09.277312 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."analytics"."source2" rename to "source2__dbt_backup"
[0m07:45:09.279570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:09.280044 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:09.281640 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:45:09.284337 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:45:09.284934 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
alter table "dagster"."analytics"."source1__dbt_tmp" rename to "source1"
[0m07:45:09.285539 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
alter table "dagster"."analytics"."source2__dbt_tmp" rename to "source2"
[0m07:45:09.286420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:09.287198 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:09.295151 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:45:09.296014 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:45:09.296777 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:45:09.297407 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:45:09.298241 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: COMMIT
[0m07:45:09.298850 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: COMMIT
[0m07:45:09.300689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:45:09.300845 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m07:45:09.304693 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."source1__dbt_backup"
[0m07:45:09.306139 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."source2__dbt_backup"
[0m07:45:09.308630 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.source1"
[0m07:45:09.309242 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source2"
[0m07:45:09.309720 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source1"} */
drop view if exists "dagster"."analytics"."source1__dbt_backup" cascade
[0m07:45:09.310947 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source2"} */
drop view if exists "dagster"."analytics"."source2__dbt_backup" cascade
[0m07:45:09.313056 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m07:45:09.313440 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:09.315572 [debug] [Thread-2 (]: On model.dagster_dbt_project.source2: Close
[0m07:45:09.314713 [debug] [Thread-1 (]: On model.dagster_dbt_project.source1: Close
[0m07:45:09.318136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9307a7d0>]}
[0m07:45:09.318787 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921d79d0>]}
[0m07:45:09.319310 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.source1 ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m07:45:09.320001 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.source2 ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m07:45:09.321071 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.source2
[0m07:45:09.320524 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.source1
[0m07:45:09.321551 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.source3
[0m07:45:09.322459 [info ] [Thread-2 (]: 3 of 4 START sql view model analytics.source3 .................................. [RUN]
[0m07:45:09.323010 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source2, now model.dagster_dbt_project.source3)
[0m07:45:09.323474 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.source3
[0m07:45:09.324655 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.source3"
[0m07:45:09.326053 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.source3
[0m07:45:09.328410 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.source3"
[0m07:45:09.329674 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:45:09.331098 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: BEGIN
[0m07:45:09.331503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:45:09.335651 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m07:45:09.336141 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:45:09.336780 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */

  create view "dagster"."analytics"."source3__dbt_tmp"
    
    
  as (
    SELECT 
    id, 
    category, 
    CASE WHEN category='A' 
        THEN 1 
        ELSE 0 
    END AS is_a 
FROM public.source3
  );
[0m07:45:09.338098 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:09.339783 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:45:09.340247 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."analytics"."source3" rename to "source3__dbt_backup"
[0m07:45:09.340870 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:09.342419 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:45:09.342944 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
alter table "dagster"."analytics"."source3__dbt_tmp" rename to "source3"
[0m07:45:09.343508 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:09.344410 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:45:09.346006 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:45:09.346741 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: COMMIT
[0m07:45:09.347390 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m07:45:09.349742 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."source3__dbt_backup"
[0m07:45:09.350311 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.source3"
[0m07:45:09.350829 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.source3"} */
drop view if exists "dagster"."analytics"."source3__dbt_backup" cascade
[0m07:45:09.351662 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:45:09.353324 [debug] [Thread-2 (]: On model.dagster_dbt_project.source3: Close
[0m07:45:09.353876 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906c8550>]}
[0m07:45:09.354491 [info ] [Thread-2 (]: 3 of 4 OK created sql view model analytics.source3 ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m07:45:09.355191 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.source3
[0m07:45:09.355901 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m07:45:09.356430 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.summary .................................. [RUN]
[0m07:45:09.356994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.source1, now model.dagster_dbt_project.summary)
[0m07:45:09.357477 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m07:45:09.359415 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m07:45:09.361114 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m07:45:09.363149 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m07:45:09.364789 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:45:09.365257 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m07:45:09.365770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:09.369816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:45:09.370249 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:45:09.370702 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  create view "dagster"."analytics"."summary__dbt_tmp"
    
    
  as (
    WITH joined AS (
  SELECT 
    s1.id, 
    s1.value_x2, 
    s2.score_plus_one, 
    s3.is_a 
    --, w.temperature, w.windSpeed
  FROM "dagster"."analytics"."source1" s1
  JOIN "dagster"."analytics"."source2" s2 USING (id)
  JOIN "dagster"."analytics"."source3" s3 USING (id)
)
SELECT 
  *, 
  (value_x2 + score_plus_one) * is_a AS metric 
FROM joined
  );
[0m07:45:09.372248 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:09.373929 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:45:09.374456 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary__dbt_tmp" rename to "summary"
[0m07:45:09.375116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:09.375982 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m07:45:09.376450 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:45:09.376899 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m07:45:09.377916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:45:09.379277 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."summary__dbt_backup"
[0m07:45:09.379909 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:45:09.381113 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
drop view if exists "dagster"."analytics"."summary__dbt_backup" cascade
[0m07:45:09.381957 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:45:09.382921 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m07:45:09.383508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feaa003-bdde-4539-9118-835a265ac829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906e4150>]}
[0m07:45:09.384185 [info ] [Thread-1 (]: 4 of 4 OK created sql view model analytics.summary ............................. [[32mCREATE VIEW[0m in 0.03s]
[0m07:45:09.384848 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m07:45:09.385806 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:09.386712 [debug] [MainThread]: On master: BEGIN
[0m07:45:09.387150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:45:09.391088 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:45:09.391557 [debug] [MainThread]: On master: COMMIT
[0m07:45:09.392941 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:09.393410 [debug] [MainThread]: On master: COMMIT
[0m07:45:09.393945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:09.394474 [debug] [MainThread]: On master: Close
[0m07:45:09.395100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:45:09.396953 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m07:45:09.397520 [debug] [MainThread]: Connection 'model.dagster_dbt_project.source3' was properly closed.
[0m07:45:09.398143 [info ] [MainThread]: 
[0m07:45:09.398726 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m07:45:09.399802 [debug] [MainThread]: Command end result
[0m07:45:09.440754 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:45:09.443307 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:45:09.449090 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m07:45:09.450959 [info ] [MainThread]: 
[0m07:45:09.452560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:45:09.454189 [info ] [MainThread]: 
[0m07:45:09.456017 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m07:45:09.456888 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6682742, "process_in_blocks": "0", "process_kernel_time": 0.211656, "process_mem_max_rss": "124860", "process_out_blocks": "1822", "process_user_time": 0.947939}
[0m07:45:09.457845 [debug] [MainThread]: Command `dbt run` succeeded at 07:45:09.457798 after 0.67 seconds
[0m07:45:09.458335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f52350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f518d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f52890>]}
[0m07:45:09.458847 [debug] [MainThread]: Flushing usage events
[0m07:45:09.826498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:56:45.312307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa422690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa5afed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa4542d0>]}


============================== 07:56:45.315625 | a121e129-b31e-4192-80a3-cf5bc468270b ==============================
[0m07:56:45.315625 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:56:45.316736 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '/opt/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/dbt/logs', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run --project-dir /opt/dbt'}
[0m07:56:45.392568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa32bf10>]}
[0m07:56:45.419583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1e0250>]}
[0m07:56:45.421720 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:56:45.454010 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:56:45.508427 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 5 files added, 1 files changed.
[0m07:56:45.509122 [debug] [MainThread]: Partial parsing: added file: dagster_dbt_project://models/staging/stg_source_2.sql
[0m07:56:45.509693 [debug] [MainThread]: Partial parsing: added file: dagster_dbt_project://models/staging/stg_source_1.sql
[0m07:56:45.510193 [debug] [MainThread]: Partial parsing: added file: dagster_dbt_project://models/sources.yml
[0m07:56:45.511501 [debug] [MainThread]: Partial parsing: added file: dagster_dbt_project://models/staging/stg_source_3.sql
[0m07:56:45.511974 [debug] [MainThread]: Partial parsing: added file: dagster_dbt_project://models/staging/stg_weather.sql
[0m07:56:45.512514 [debug] [MainThread]: Partial parsing: deleted file: dagster_dbt_project://models/staging/source2.sql
[0m07:56:45.512955 [debug] [MainThread]: Partial parsing: deleted file: dagster_dbt_project://models/staging/source3.sql
[0m07:56:45.513409 [debug] [MainThread]: Partial parsing: deleted file: dagster_dbt_project://models/staging/source1.sql
[0m07:56:45.513836 [debug] [MainThread]: Partial parsing: deleted file: dagster_dbt_project://models/staging/weather.sql
[0m07:56:45.514315 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m07:56:45.709829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8535c50>]}
[0m07:56:45.769550 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:56:45.772107 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:56:45.780642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93cc890>]}
[0m07:56:45.781430 [info ] [MainThread]: Found 4 models, 4 sources, 459 macros
[0m07:56:45.782427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90d81d0>]}
[0m07:56:45.783673 [info ] [MainThread]: 
[0m07:56:45.784348 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m07:56:45.784841 [info ] [MainThread]: 
[0m07:56:45.785399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:56:45.787693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m07:56:45.805317 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m07:56:45.806743 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m07:56:45.807630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:45.820167 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m07:56:45.821310 [debug] [ThreadPool]: On list_dagster: Close
[0m07:56:45.823084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m07:56:45.826346 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m07:56:45.827011 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m07:56:45.827576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:45.831915 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:56:45.832518 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m07:56:45.833117 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m07:56:45.835914 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:56:45.836973 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m07:56:45.837485 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m07:56:45.840204 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:45.840673 [debug] [MainThread]: On master: BEGIN
[0m07:56:45.841133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:56:45.845088 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:56:45.845649 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:45.846330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m07:56:45.848676 [debug] [MainThread]: SQL status: SELECT 6 in 0.002 seconds
[0m07:56:45.849940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93bfbd0>]}
[0m07:56:45.850652 [debug] [MainThread]: On master: ROLLBACK
[0m07:56:45.852688 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:45.853292 [debug] [MainThread]: On master: BEGIN
[0m07:56:45.853975 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:56:45.854482 [debug] [MainThread]: On master: COMMIT
[0m07:56:45.854999 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:45.855475 [debug] [MainThread]: On master: COMMIT
[0m07:56:45.856054 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:56:45.856599 [debug] [MainThread]: On master: Close
[0m07:56:45.859207 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m07:56:45.859412 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m07:56:45.860718 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m07:56:45.859885 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m07:56:45.861348 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m07:56:45.861841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m07:56:45.862315 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m07:56:45.862780 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m07:56:45.866580 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m07:56:45.868735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m07:56:45.870582 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m07:56:45.886399 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m07:56:45.886674 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m07:56:45.889203 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m07:56:45.891802 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:45.892587 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m07:56:45.893136 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:45.893373 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:56:45.894754 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m07:56:45.895645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:45.899254 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m07:56:45.899733 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:45.900577 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m07:56:45.902436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:56:45.902730 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:56:45.903736 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:45.906889 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:45.907402 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m07:56:45.907876 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m07:56:45.908907 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:45.909219 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:56:45.916009 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m07:56:45.918033 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:45.917499 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:45.918703 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m07:56:45.919263 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m07:56:45.920305 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m07:56:45.920690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:45.923474 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m07:56:45.924387 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m07:56:45.926864 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:45.927362 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:45.928345 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m07:56:45.927863 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m07:56:45.929117 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:56:45.929456 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:56:45.930634 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m07:56:45.931987 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m07:56:45.932687 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:45.934146 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82d1850>]}
[0m07:56:45.934741 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m07:56:45.935651 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.07s]
[0m07:56:45.936497 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:56:45.937738 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m07:56:45.939071 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m07:56:45.940782 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m07:56:45.941603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8fff690>]}
[0m07:56:45.942118 [info ] [Thread-2 (]: 3 of 4 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m07:56:45.943435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_source_3)
[0m07:56:45.942985 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m07:56:45.945075 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m07:56:45.944475 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m07:56:45.947606 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m07:56:45.950081 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m07:56:45.953979 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m07:56:45.955750 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:45.956183 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m07:56:45.956650 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:56:45.960580 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m07:56:45.961068 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:45.961549 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m07:56:45.962624 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:56:45.964274 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:45.965782 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m07:56:45.966484 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:45.967418 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m07:56:45.967880 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:45.968316 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m07:56:45.969143 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m07:56:45.970529 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m07:56:45.971092 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:45.971566 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m07:56:45.972509 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:56:45.973416 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m07:56:45.973975 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82d1990>]}
[0m07:56:45.974580 [info ] [Thread-2 (]: 3 of 4 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.03s]
[0m07:56:45.975157 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m07:56:45.975905 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m07:56:45.976406 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m07:56:45.977096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.summary)
[0m07:56:45.977663 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m07:56:45.979646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m07:56:45.981212 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m07:56:45.991583 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m07:56:45.992969 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:56:45.993510 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m07:56:45.994069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:45.998094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:56:45.998561 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:56:45.999607 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),

, joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a
    from src_1
    join src_2 using (id)
    join src_3 using (id)
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m07:56:46.000198 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 20: , joined as (
         ^

[0m07:56:46.000717 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: ROLLBACK
[0m07:56:46.001294 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m07:56:46.004899 [debug] [Thread-1 (]: Database Error in model summary (models/marts/summary.sql)
  syntax error at or near ","
  LINE 20: , joined as (
           ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m07:56:46.005784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a121e129-b31e-4192-80a3-cf5bc468270b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83f6fd0>]}
[0m07:56:46.007751 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.summary ........................ [[31mERROR[0m in 0.03s]
[0m07:56:46.008766 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m07:56:46.009516 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.summary' to be skipped because of status 'error'.  Reason: Database Error in model summary (models/marts/summary.sql)
  syntax error at or near ","
  LINE 20: , joined as (
           ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql.
[0m07:56:46.010909 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:46.011419 [debug] [MainThread]: On master: BEGIN
[0m07:56:46.012385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:56:46.017120 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:56:46.017800 [debug] [MainThread]: On master: COMMIT
[0m07:56:46.018824 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:46.020610 [debug] [MainThread]: On master: COMMIT
[0m07:56:46.021179 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:56:46.021951 [debug] [MainThread]: On master: Close
[0m07:56:46.022846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:46.024461 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m07:56:46.025370 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m07:56:46.025950 [info ] [MainThread]: 
[0m07:56:46.027068 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m07:56:46.028676 [debug] [MainThread]: Command end result
[0m07:56:46.100418 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:56:46.105625 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:56:46.110416 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m07:56:46.111100 [info ] [MainThread]: 
[0m07:56:46.112911 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:56:46.113716 [info ] [MainThread]: 
[0m07:56:46.115640 [error] [MainThread]: [31mFailure in model summary (models/marts/summary.sql)[0m
[0m07:56:46.116339 [error] [MainThread]:   Database Error in model summary (models/marts/summary.sql)
  syntax error at or near ","
  LINE 20: , joined as (
           ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m07:56:46.117039 [info ] [MainThread]: 
[0m07:56:46.117664 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/marts/summary.sql
[0m07:56:46.121528 [info ] [MainThread]: 
[0m07:56:46.121988 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m07:56:46.124086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.840196, "process_in_blocks": "264", "process_kernel_time": 0.193936, "process_mem_max_rss": "130204", "process_out_blocks": "2751", "process_user_time": 1.1184}
[0m07:56:46.124679 [debug] [MainThread]: Command `dbt run` failed at 07:56:46.124631 after 0.84 seconds
[0m07:56:46.125192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3d1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3d2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa421050>]}
[0m07:56:46.125665 [debug] [MainThread]: Flushing usage events
[0m07:56:46.509917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:56:56.762433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90395f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911fa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903f2750>]}


============================== 07:56:56.764692 | a869aaa7-6fc4-4f42-9dc9-1e348077db0d ==============================
[0m07:56:56.764692 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:56:56.765454 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'fail_fast': 'False', 'empty': 'False', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/opt/dbt', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/dbt/logs'}
[0m07:56:56.841707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90395a50>]}
[0m07:56:56.868367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93140250>]}
[0m07:56:56.869295 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:56:56.900094 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:56:56.963904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:56:56.964662 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m07:56:57.076061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f309310>]}
[0m07:56:57.136606 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:56:57.139030 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:56:57.148080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f22d250>]}
[0m07:56:57.148652 [info ] [MainThread]: Found 4 models, 4 sources, 459 macros
[0m07:56:57.149280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef96450>]}
[0m07:56:57.150488 [info ] [MainThread]: 
[0m07:56:57.151012 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m07:56:57.151517 [info ] [MainThread]: 
[0m07:56:57.152112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:56:57.154395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m07:56:57.199585 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m07:56:57.200505 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m07:56:57.201677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:57.211251 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m07:56:57.212465 [debug] [ThreadPool]: On list_dagster: Close
[0m07:56:57.213790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m07:56:57.217241 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m07:56:57.217808 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m07:56:57.218400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:57.222501 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:56:57.223325 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m07:56:57.223891 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m07:56:57.226395 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m07:56:57.227429 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m07:56:57.228091 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m07:56:57.232015 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:57.233885 [debug] [MainThread]: On master: BEGIN
[0m07:56:57.234466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:56:57.238529 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:56:57.239289 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:57.239886 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m07:56:57.242760 [debug] [MainThread]: SQL status: SELECT 9 in 0.002 seconds
[0m07:56:57.244180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e62ee10>]}
[0m07:56:57.244849 [debug] [MainThread]: On master: ROLLBACK
[0m07:56:57.245513 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:57.246041 [debug] [MainThread]: On master: BEGIN
[0m07:56:57.246747 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:56:57.247304 [debug] [MainThread]: On master: COMMIT
[0m07:56:57.247823 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:57.248341 [debug] [MainThread]: On master: COMMIT
[0m07:56:57.248933 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:56:57.249463 [debug] [MainThread]: On master: Close
[0m07:56:57.251650 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m07:56:57.251838 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m07:56:57.252320 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m07:56:57.252988 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m07:56:57.253510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m07:56:57.254030 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m07:56:57.254637 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m07:56:57.255721 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m07:56:57.260082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m07:56:57.262107 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m07:56:57.265225 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m07:56:57.265443 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m07:56:57.284509 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m07:56:57.286749 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m07:56:57.288787 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:57.289058 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:57.289668 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m07:56:57.290293 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m07:56:57.291542 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:56:57.292316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:57.298863 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m07:56:57.299406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:56:57.300565 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:57.301278 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:57.302508 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m07:56:57.303399 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m07:56:57.306080 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:56:57.306257 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:56:57.309790 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:57.311836 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:57.312966 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m07:56:57.312420 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m07:56:57.313929 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:57.314287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:57.315853 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:57.317620 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:57.318251 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m07:56:57.319073 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m07:56:57.320788 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:57.321832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:57.330145 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m07:56:57.331963 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m07:56:57.334537 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:57.332769 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:57.336537 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m07:56:57.337271 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m07:56:57.339362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:56:57.339538 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m07:56:57.343213 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m07:56:57.344826 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m07:56:57.347570 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m07:56:57.348196 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m07:56:57.348684 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m07:56:57.349155 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m07:56:57.350478 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:56:57.350643 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:56:57.352445 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m07:56:57.353379 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m07:56:57.355848 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc56610>]}
[0m07:56:57.355541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbfe010>]}
[0m07:56:57.357969 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.10s]
[0m07:56:57.358818 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.10s]
[0m07:56:57.359515 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m07:56:57.360082 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m07:56:57.360585 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m07:56:57.361477 [info ] [Thread-2 (]: 3 of 4 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m07:56:57.362185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_source_3)
[0m07:56:57.362673 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m07:56:57.366086 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m07:56:57.368859 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m07:56:57.370914 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m07:56:57.372355 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:57.372829 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m07:56:57.373288 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:56:57.378008 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m07:56:57.378970 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:57.379612 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m07:56:57.381573 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:56:57.384226 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:57.384815 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m07:56:57.396825 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:56:57.457111 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:57.458889 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m07:56:57.460205 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:57.461962 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m07:56:57.462599 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:57.463195 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m07:56:57.464708 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m07:56:57.468947 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m07:56:57.481714 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m07:56:57.483657 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m07:56:57.486396 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:56:57.487597 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m07:56:57.488476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c14f8d0>]}
[0m07:56:57.489303 [info ] [Thread-2 (]: 3 of 4 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m07:56:57.490251 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m07:56:57.491160 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m07:56:57.491858 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m07:56:57.492733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.summary)
[0m07:56:57.493325 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m07:56:57.495861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m07:56:57.497789 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m07:56:57.510570 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m07:56:57.512906 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:56:57.513518 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m07:56:57.514788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:57.519576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:56:57.520102 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:56:57.520604 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),

joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a
    from src_1
    join src_2 using (id)
    join src_3 using (id)
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m07:56:57.523033 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m07:56:57.526864 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:56:57.527392 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary" rename to "summary__dbt_backup"
[0m07:56:57.528687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:57.530353 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:56:57.530857 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary__dbt_tmp" rename to "summary"
[0m07:56:57.532690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:56:57.533688 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m07:56:57.534281 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:56:57.534888 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m07:56:57.537015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:56:57.539504 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."summary__dbt_backup"
[0m07:56:57.540385 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m07:56:57.540978 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
drop view if exists "dagster"."analytics"."summary__dbt_backup" cascade
[0m07:56:57.542208 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:56:57.543246 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m07:56:57.543900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a869aaa7-6fc4-4f42-9dc9-1e348077db0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da83510>]}
[0m07:56:57.544606 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.summary ............................ [[32mSELECT 3[0m in 0.05s]
[0m07:56:57.545345 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m07:56:57.546545 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:57.547021 [debug] [MainThread]: On master: BEGIN
[0m07:56:57.547477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:56:57.551686 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:56:57.552192 [debug] [MainThread]: On master: COMMIT
[0m07:56:57.552676 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:57.553065 [debug] [MainThread]: On master: COMMIT
[0m07:56:57.553553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:56:57.553973 [debug] [MainThread]: On master: Close
[0m07:56:57.554497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:57.554975 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m07:56:57.555415 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m07:56:57.556016 [info ] [MainThread]: 
[0m07:56:57.556581 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m07:56:57.557544 [debug] [MainThread]: Command end result
[0m07:56:57.598559 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m07:56:57.601538 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m07:56:57.606918 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m07:56:57.608503 [info ] [MainThread]: 
[0m07:56:57.609078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:56:57.610479 [info ] [MainThread]: 
[0m07:56:57.611083 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m07:56:57.612456 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8799359, "process_in_blocks": "0", "process_kernel_time": 0.196981, "process_mem_max_rss": "128500", "process_out_blocks": "2755", "process_user_time": 1.123831}
[0m07:56:57.613164 [debug] [MainThread]: Command `dbt run` succeeded at 07:56:57.613109 after 0.88 seconds
[0m07:56:57.613772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903f30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903f2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903f0610>]}
[0m07:56:57.615584 [debug] [MainThread]: Flushing usage events
[0m07:56:57.947450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:01:18.603430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80900cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80903310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818ee7d0>]}


============================== 08:01:18.609827 | 956024b9-582d-4bde-850f-2f62254240a7 ==============================
[0m08:01:18.609827 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:01:18.612157 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'log_path': '/opt/dbt/logs', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'quiet': 'False', 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m08:01:18.755954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a33650>]}
[0m08:01:18.785491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83643c50>]}
[0m08:01:18.786485 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:01:18.826837 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:01:18.938162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:01:18.940462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:01:18.972058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f625b50>]}
[0m08:01:19.077329 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:01:19.080509 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:01:19.098679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8584d0>]}
[0m08:01:19.100346 [info ] [MainThread]: Found 4 models, 4 sources, 459 macros
[0m08:01:19.101099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f83c490>]}
[0m08:01:19.102525 [info ] [MainThread]: 
[0m08:01:19.103197 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:01:19.103747 [info ] [MainThread]: 
[0m08:01:19.104499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:01:19.107097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:01:19.136484 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:01:19.137281 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:01:19.137841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:19.161866 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m08:01:19.163647 [debug] [ThreadPool]: On list_dagster: Close
[0m08:01:19.167160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:01:19.174139 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:01:19.177207 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:01:19.180047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:01:19.196050 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m08:01:19.196735 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:01:19.197288 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:01:19.201946 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m08:01:19.203495 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:01:19.204385 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:01:19.209052 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:19.210021 [debug] [MainThread]: On master: BEGIN
[0m08:01:19.211295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:01:19.219959 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:01:19.222205 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:19.224093 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:01:19.232827 [debug] [MainThread]: SQL status: SELECT 6 in 0.007 seconds
[0m08:01:19.234497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e950650>]}
[0m08:01:19.235371 [debug] [MainThread]: On master: ROLLBACK
[0m08:01:19.237000 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:19.239240 [debug] [MainThread]: On master: BEGIN
[0m08:01:19.240393 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:01:19.241011 [debug] [MainThread]: On master: COMMIT
[0m08:01:19.241599 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:19.242726 [debug] [MainThread]: On master: COMMIT
[0m08:01:19.244317 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:01:19.245896 [debug] [MainThread]: On master: Close
[0m08:01:19.252307 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:01:19.252636 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:01:19.253577 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:01:19.255574 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:01:19.256731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:01:19.258226 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:01:19.259572 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:01:19.260309 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:01:19.265239 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:01:19.267132 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:01:19.271261 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:01:19.271654 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:01:19.346054 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:01:19.347809 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:01:19.349887 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:01:19.350659 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:01:19.350970 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:01:19.352530 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:01:19.353319 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:01:19.354746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:19.362347 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m08:01:19.363518 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:01:19.363778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:01:19.364165 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:01:19.364721 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:01:19.366832 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:01:19.368234 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:01:19.372671 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:01:19.373779 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:01:19.375126 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:01:19.375281 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:01:19.376947 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:01:19.380496 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:01:19.382524 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:01:19.383255 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:01:19.384313 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:01:19.384842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:01:19.397804 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:01:19.399664 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:01:19.400613 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:01:19.401487 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:01:19.402030 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:01:19.402852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:01:19.404043 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:01:19.404464 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:01:19.404651 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:01:19.407966 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:01:19.409081 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:01:19.411795 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:01:19.413446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:01:19.414001 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:01:19.415603 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:01:19.417958 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:01:19.418120 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:01:19.418534 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:01:19.420086 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:01:19.422950 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8e3250>]}
[0m08:01:19.421319 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:01:19.425639 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m08:01:19.426520 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:01:19.428626 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:01:19.429226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8e0190>]}
[0m08:01:19.430106 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:01:19.431320 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.17s]
[0m08:01:19.434182 [info ] [Thread-2 (]: 3 of 4 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:01:19.434900 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:01:19.436457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_source_3)
[0m08:01:19.437791 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:01:19.439748 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:01:19.442192 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:01:19.444212 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:01:19.449093 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:01:19.450361 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:01:19.450794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:01:19.454972 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m08:01:19.457265 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:01:19.461629 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:01:19.463857 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:01:19.468301 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:01:19.468920 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:01:19.469772 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:01:19.471571 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:01:19.472148 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:01:19.473116 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:01:19.474133 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:01:19.474704 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:01:19.475269 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:01:19.476412 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:01:19.477841 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:01:19.478501 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:01:19.479200 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:01:19.480122 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:01:19.481048 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:01:19.481695 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808d9a10>]}
[0m08:01:19.482524 [info ] [Thread-2 (]: 3 of 4 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.05s]
[0m08:01:19.483106 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:01:19.483923 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m08:01:19.484418 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m08:01:19.484938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.summary)
[0m08:01:19.485358 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m08:01:19.487404 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m08:01:19.488945 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m08:01:19.499634 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m08:01:19.501012 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:01:19.501490 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m08:01:19.503289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:19.507576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:01:19.508075 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:01:19.508551 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),

joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a
    from src_1
    join src_2 using (id)
    join src_3 using (id)
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m08:01:19.513359 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m08:01:19.517751 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:01:19.519156 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary" rename to "summary__dbt_backup"
[0m08:01:19.520495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:01:19.522593 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:01:19.524249 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary__dbt_tmp" rename to "summary"
[0m08:01:19.524947 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:01:19.526897 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:01:19.527379 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:01:19.527905 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:01:19.528853 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:01:19.531377 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."summary__dbt_backup"
[0m08:01:19.533131 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:01:19.533626 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
drop table if exists "dagster"."analytics"."summary__dbt_backup" cascade
[0m08:01:19.535774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:01:19.537701 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m08:01:19.538318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '956024b9-582d-4bde-850f-2f62254240a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c78e950>]}
[0m08:01:19.538994 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.summary ............................ [[32mSELECT 3[0m in 0.05s]
[0m08:01:19.539565 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m08:01:19.540593 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:19.541044 [debug] [MainThread]: On master: BEGIN
[0m08:01:19.541470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:01:19.546006 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:01:19.547189 [debug] [MainThread]: On master: COMMIT
[0m08:01:19.547688 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:19.548209 [debug] [MainThread]: On master: COMMIT
[0m08:01:19.549318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:01:19.549895 [debug] [MainThread]: On master: Close
[0m08:01:19.550494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:19.550965 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m08:01:19.551474 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:01:19.552077 [info ] [MainThread]: 
[0m08:01:19.552610 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m08:01:19.554464 [debug] [MainThread]: Command end result
[0m08:01:19.595758 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:01:19.599200 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:01:19.603797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:01:19.605380 [info ] [MainThread]: 
[0m08:01:19.605919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:01:19.606381 [info ] [MainThread]: 
[0m08:01:19.606845 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m08:01:19.609236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0523185, "process_in_blocks": "952", "process_kernel_time": 0.706593, "process_mem_max_rss": "125352", "process_out_blocks": "1864", "process_user_time": 1.126756}
[0m08:01:19.610319 [debug] [MainThread]: Command `dbt run` succeeded at 08:01:19.610268 after 1.05 seconds
[0m08:01:19.610812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b42390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85841750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85841790>]}
[0m08:01:19.611320 [debug] [MainThread]: Flushing usage events
[0m08:01:19.990456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:09:02.022732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b111d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ab5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ab5150>]}


============================== 08:09:02.045837 | cba46da7-41c8-4a8d-b479-8c531f1a7f4a ==============================
[0m08:09:02.045837 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:09:02.066432 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'empty': 'False', 'log_format': 'default', 'partial_parse': 'True', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/dbt', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/opt/dbt/logs', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None'}
[0m08:09:02.222918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b11ed0>]}
[0m08:09:02.274747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab851d10>]}
[0m08:09:02.275755 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:09:02.334923 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:09:02.426596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:09:02.427598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:09:02.455816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa894b050>]}
[0m08:09:02.524678 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:09:02.527130 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:09:02.538155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa79558d0>]}
[0m08:09:02.538843 [info ] [MainThread]: Found 4 models, 4 sources, 459 macros
[0m08:09:02.539805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89bf990>]}
[0m08:09:02.541380 [info ] [MainThread]: 
[0m08:09:02.542067 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:09:02.544715 [info ] [MainThread]: 
[0m08:09:02.545373 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:09:02.547854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:09:02.577345 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:09:02.579095 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:09:02.579686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:02.596233 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m08:09:02.597570 [debug] [ThreadPool]: On list_dagster: Close
[0m08:09:02.598965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:09:02.603565 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:09:02.604187 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:09:02.606057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:09:02.610423 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:09:02.611164 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:09:02.611672 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:09:02.614312 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:09:02.615471 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:09:02.617089 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:09:02.620233 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:02.620819 [debug] [MainThread]: On master: BEGIN
[0m08:09:02.621408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:09:02.627654 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:09:02.628252 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:02.630109 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:09:02.633612 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m08:09:02.634747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7818b90>]}
[0m08:09:02.635435 [debug] [MainThread]: On master: ROLLBACK
[0m08:09:02.636103 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:02.636594 [debug] [MainThread]: On master: BEGIN
[0m08:09:02.637170 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:09:02.637656 [debug] [MainThread]: On master: COMMIT
[0m08:09:02.638102 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:02.638547 [debug] [MainThread]: On master: COMMIT
[0m08:09:02.639017 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:09:02.639779 [debug] [MainThread]: On master: Close
[0m08:09:02.641708 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:09:02.641895 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:09:02.642348 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:09:02.643006 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:09:02.644943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:09:02.645700 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:09:02.646299 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:09:02.646817 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:09:02.650973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:09:02.652976 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:09:02.655205 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:09:02.655523 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:09:02.674849 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:09:02.731036 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:09:02.732946 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:09:02.734046 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:09:02.734283 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:09:02.736259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:09:02.738032 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:09:02.740534 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:09:02.743418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:09:02.744447 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:09:02.744963 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m08:09:02.745362 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:09:02.745870 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:09:02.746846 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:09:02.748934 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:09:02.749258 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:09:02.754872 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:09:02.761353 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:09:02.761917 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:09:02.762415 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:09:02.764336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:09:02.764775 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:09:02.766262 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:09:02.769313 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:09:02.769859 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:09:02.770373 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:09:02.771198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:09:02.771547 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:09:02.779722 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:09:02.781295 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:09:02.782712 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:09:02.783355 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:09:02.785071 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:09:02.785663 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:09:02.788188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:09:02.788354 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:09:02.791663 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:09:02.793280 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:09:02.795967 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:09:02.797064 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:09:02.798855 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:09:02.799606 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:09:02.801588 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:09:02.801722 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:09:02.803148 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:09:02.804024 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:09:02.805755 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89af550>]}
[0m08:09:02.805221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7baa390>]}
[0m08:09:02.806518 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m08:09:02.807418 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:09:02.807027 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m08:09:02.808481 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:09:02.807959 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:09:02.809350 [info ] [Thread-2 (]: 3 of 4 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:09:02.809881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_source_3)
[0m08:09:02.810597 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:09:02.812500 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:09:02.814618 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:09:02.817576 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:09:02.818842 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:09:02.819850 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:09:02.820317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:09:02.824354 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m08:09:02.824888 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:09:02.825370 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:09:02.826909 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:09:02.828603 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:09:02.829082 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:09:02.829925 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:09:02.831974 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:09:02.832489 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:09:02.833086 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:09:02.834025 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:09:02.834484 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:09:02.834922 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:09:02.835758 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m08:09:02.837127 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:09:02.837789 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:09:02.838926 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:09:02.839966 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:09:02.840832 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:09:02.841376 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa79c5090>]}
[0m08:09:02.843125 [info ] [Thread-2 (]: 3 of 4 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.03s]
[0m08:09:02.843652 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:09:02.844281 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m08:09:02.844795 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m08:09:02.845254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.summary)
[0m08:09:02.845699 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m08:09:02.847610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m08:09:02.851002 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m08:09:02.861261 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m08:09:02.862710 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:09:02.863277 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m08:09:02.863875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:09:02.868070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:09:02.869852 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:09:02.870332 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),

joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a
    from src_1
    join src_2 using (id)
    join src_3 using (id)
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m08:09:02.872006 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.001 seconds
[0m08:09:02.875789 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:09:02.876494 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary" rename to "summary__dbt_backup"
[0m08:09:02.877200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:09:02.880070 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:09:02.880663 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary__dbt_tmp" rename to "summary"
[0m08:09:02.881397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:09:02.882457 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:09:02.883117 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:09:02.883667 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:09:02.884866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:09:02.886425 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."summary__dbt_backup"
[0m08:09:02.888234 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:09:02.888758 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
drop table if exists "dagster"."analytics"."summary__dbt_backup" cascade
[0m08:09:02.890925 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:09:02.891825 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m08:09:02.892465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba46da7-41c8-4a8d-b479-8c531f1a7f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c90310>]}
[0m08:09:02.893103 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.summary ............................ [[32mSELECT 3[0m in 0.05s]
[0m08:09:02.893793 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m08:09:02.894821 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:02.896809 [debug] [MainThread]: On master: BEGIN
[0m08:09:02.897283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:09:02.901470 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:09:02.901960 [debug] [MainThread]: On master: COMMIT
[0m08:09:02.902451 [debug] [MainThread]: Using postgres connection "master"
[0m08:09:02.903009 [debug] [MainThread]: On master: COMMIT
[0m08:09:02.903647 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:09:02.904977 [debug] [MainThread]: On master: Close
[0m08:09:02.905573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:09:02.906432 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m08:09:02.907737 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:09:02.908205 [info ] [MainThread]: 
[0m08:09:02.908623 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m08:09:02.909357 [debug] [MainThread]: Command end result
[0m08:09:02.943163 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:09:02.945206 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:09:02.949028 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:09:02.949488 [info ] [MainThread]: 
[0m08:09:02.951045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:09:02.951744 [info ] [MainThread]: 
[0m08:09:02.952202 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m08:09:02.953050 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1708003, "process_in_blocks": "16", "process_kernel_time": 0.295016, "process_mem_max_rss": "125168", "process_out_blocks": "1864", "process_user_time": 1.281274}
[0m08:09:02.953592 [debug] [MainThread]: Command `dbt run` succeeded at 08:09:02.953535 after 1.17 seconds
[0m08:09:02.954096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b08e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada51750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada52590>]}
[0m08:09:02.954760 [debug] [MainThread]: Flushing usage events
[0m08:09:03.352644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:11:34.955233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e72390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e0a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e73550>]}


============================== 08:11:34.957596 | df27540f-a91c-4ed0-a07c-a3891eca03c1 ==============================
[0m08:11:34.957596 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:11:34.959360 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'log_path': '/opt/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'static_parser': 'True', 'profiles_dir': '/opt/dbt', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None'}
[0m08:11:35.035429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f43b10>]}
[0m08:11:35.063307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabc0190>]}
[0m08:11:35.064333 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:11:35.096000 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:11:35.150702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:11:35.151351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:11:35.167513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8dcf890>]}
[0m08:11:35.260285 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:11:35.263776 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:11:35.274111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a94c50>]}
[0m08:11:35.274837 [info ] [MainThread]: Found 4 models, 4 sources, 459 macros
[0m08:11:35.275508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6ac7790>]}
[0m08:11:35.278094 [info ] [MainThread]: 
[0m08:11:35.278628 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:11:35.279093 [info ] [MainThread]: 
[0m08:11:35.279683 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:11:35.282069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:11:35.304413 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:11:35.305357 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:11:35.305989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:35.320993 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m08:11:35.322367 [debug] [ThreadPool]: On list_dagster: Close
[0m08:11:35.323722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:11:35.328899 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:11:35.329481 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:11:35.330016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:35.334214 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:11:35.334768 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:11:35.337390 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:11:35.340091 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:11:35.341157 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:11:35.341782 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:11:35.345238 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:35.345815 [debug] [MainThread]: On master: BEGIN
[0m08:11:35.346372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:11:35.352489 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:11:35.353139 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:35.353819 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:11:35.357265 [debug] [MainThread]: SQL status: SELECT 6 in 0.002 seconds
[0m08:11:35.358356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e9cf90>]}
[0m08:11:35.358993 [debug] [MainThread]: On master: ROLLBACK
[0m08:11:35.359706 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:35.360281 [debug] [MainThread]: On master: BEGIN
[0m08:11:35.361588 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:11:35.362281 [debug] [MainThread]: On master: COMMIT
[0m08:11:35.363113 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:35.364403 [debug] [MainThread]: On master: COMMIT
[0m08:11:35.366436 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:11:35.366949 [debug] [MainThread]: On master: Close
[0m08:11:35.369159 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:11:35.369345 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:11:35.369826 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:11:35.370464 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:11:35.371069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:11:35.371825 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:11:35.372605 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:11:35.373236 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:11:35.378169 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:11:35.380090 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:11:35.382832 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:11:35.383330 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:11:35.401022 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:11:35.429691 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:11:35.432502 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:11:35.434309 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:11:35.437295 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:11:35.435442 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:11:35.437772 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:11:35.438265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:35.444055 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m08:11:35.445995 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:11:35.447304 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:11:35.447951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m08:11:35.448576 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:11:35.449062 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:11:35.449754 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:11:35.453822 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:11:35.453996 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m08:11:35.454482 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:11:35.456541 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:11:35.457385 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:11:35.457613 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:11:35.459326 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:11:35.460209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:11:35.461270 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:11:35.463059 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:11:35.463883 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:11:35.465386 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:11:35.473414 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:11:35.473992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:11:35.474428 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:11:35.475524 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:11:35.476091 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:11:35.476638 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:11:35.477628 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:11:35.478327 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:11:35.478504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:11:35.481523 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:11:35.482965 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:11:35.485629 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:11:35.486280 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:11:35.486744 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:11:35.487241 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:11:35.488753 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:11:35.488908 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:11:35.490269 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:11:35.491192 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:11:35.492895 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6be8650>]}
[0m08:11:35.493036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6d24fd0>]}
[0m08:11:35.493770 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.12s]
[0m08:11:35.496316 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.12s]
[0m08:11:35.496795 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:11:35.498365 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:11:35.499014 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:11:35.499831 [info ] [Thread-2 (]: 3 of 4 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:11:35.500328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_source_3)
[0m08:11:35.500811 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:11:35.502564 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:11:35.504386 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:11:35.507389 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:11:35.508694 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:11:35.509177 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:11:35.510147 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:11:35.514954 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m08:11:35.515466 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:11:35.516155 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:11:35.518375 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:11:35.520177 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:11:35.521182 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:11:35.522008 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:11:35.523779 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:11:35.524586 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:11:35.525327 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:11:35.526332 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:11:35.526838 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:11:35.527347 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:11:35.529417 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m08:11:35.530851 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:11:35.531482 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:11:35.532102 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:11:35.533043 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:11:35.533972 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:11:35.534777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e48fd0>]}
[0m08:11:35.535493 [info ] [Thread-2 (]: 3 of 4 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.03s]
[0m08:11:35.536349 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:11:35.537117 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m08:11:35.538450 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m08:11:35.538984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.summary)
[0m08:11:35.539467 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m08:11:35.541567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m08:11:35.543072 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m08:11:35.553817 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m08:11:35.556472 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:11:35.557022 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m08:11:35.557499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:35.561941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:11:35.562471 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:11:35.563124 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),

joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a
    from src_1
    join src_2 using (id)
    join src_3 using (id)
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m08:11:35.566839 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m08:11:35.573795 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:11:35.574481 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary" rename to "summary__dbt_backup"
[0m08:11:35.575578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:11:35.577547 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:11:35.578166 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary__dbt_tmp" rename to "summary"
[0m08:11:35.579638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:11:35.580682 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:11:35.581260 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:11:35.581848 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:11:35.583003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:11:35.584481 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."summary__dbt_backup"
[0m08:11:35.586346 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:11:35.586994 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
drop table if exists "dagster"."analytics"."summary__dbt_backup" cascade
[0m08:11:35.591218 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m08:11:35.592209 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m08:11:35.593299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df27540f-a91c-4ed0-a07c-a3891eca03c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4524110>]}
[0m08:11:35.594057 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.summary ............................ [[32mSELECT 3[0m in 0.05s]
[0m08:11:35.594740 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m08:11:35.597177 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:35.597641 [debug] [MainThread]: On master: BEGIN
[0m08:11:35.599261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:11:35.603548 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:11:35.604157 [debug] [MainThread]: On master: COMMIT
[0m08:11:35.604733 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:35.605328 [debug] [MainThread]: On master: COMMIT
[0m08:11:35.605904 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:11:35.606409 [debug] [MainThread]: On master: Close
[0m08:11:35.607096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:35.607705 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m08:11:35.608163 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:11:35.608685 [info ] [MainThread]: 
[0m08:11:35.609256 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m08:11:35.610083 [debug] [MainThread]: Command end result
[0m08:11:35.653473 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:11:35.655731 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:11:35.660595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:11:35.661180 [info ] [MainThread]: 
[0m08:11:35.661654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:11:35.662100 [info ] [MainThread]: 
[0m08:11:35.662569 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m08:11:35.663473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7371818, "process_in_blocks": "0", "process_kernel_time": 0.179083, "process_mem_max_rss": "125392", "process_out_blocks": "1864", "process_user_time": 0.965452}
[0m08:11:35.664065 [debug] [MainThread]: Command `dbt run` succeeded at 08:11:35.664005 after 0.74 seconds
[0m08:11:35.664656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdb2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdb1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdb2710>]}
[0m08:11:35.665339 [debug] [MainThread]: Flushing usage events
[0m08:11:36.037097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:28.692202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f52690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa20df9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f53f10>]}


============================== 08:30:28.696887 | df161d6b-de1e-42b6-99a4-afff3146c6c8 ==============================
[0m08:30:28.696887 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:30:28.697698 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'log_path': '/opt/dbt/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'quiet': 'False', 'version_check': 'True', 'debug': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'no_print': 'None'}
[0m08:30:28.794856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df161d6b-de1e-42b6-99a4-afff3146c6c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fadc50>]}
[0m08:30:28.825861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df161d6b-de1e-42b6-99a4-afff3146c6c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d03e10>]}
[0m08:30:28.827155 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:30:28.865722 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:30:28.945071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:30:28.946009 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/stg_weather.sql
[0m08:30:28.946625 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m08:30:29.060643 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dagster_dbt_project.summary' (models/marts/summary.sql) depends on a node named 'stg_weather' which is disabled
[0m08:30:29.062017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4026425, "process_in_blocks": "0", "process_kernel_time": 0.358451, "process_mem_max_rss": "116448", "process_out_blocks": "5", "process_user_time": 1.044847}
[0m08:30:29.063637 [debug] [MainThread]: Command `dbt run` failed at 08:30:29.063572 after 0.40 seconds
[0m08:30:29.064759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c8a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa21ee210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b48b10>]}
[0m08:30:29.065514 [debug] [MainThread]: Flushing usage events
[0m08:30:29.431671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:31:30.520502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4045e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb419f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e763d0>]}


============================== 08:31:30.522969 | 0262822c-5e87-4daf-9211-83529823cdef ==============================
[0m08:31:30.522969 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:31:30.523782 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': '/opt/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/opt/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'version_check': 'True', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m08:31:30.610400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ec9d10>]}
[0m08:31:30.663226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6dd4150>]}
[0m08:31:30.664342 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:31:30.702046 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:31:30.774790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:31:30.776240 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m08:31:30.776803 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/stg_weather.sql
[0m08:31:30.905867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ea7690>]}
[0m08:31:30.982638 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:31:30.986746 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:31:31.001568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb244c190>]}
[0m08:31:31.002378 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:31:31.003008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4044b50>]}
[0m08:31:31.004383 [info ] [MainThread]: 
[0m08:31:31.006104 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:31:31.006686 [info ] [MainThread]: 
[0m08:31:31.007361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:31:31.009958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:31:31.086331 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:31:31.088127 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:31:31.088766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:31.106730 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m08:31:31.108853 [debug] [ThreadPool]: On list_dagster: Close
[0m08:31:31.111024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:31:31.116777 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:31:31.117902 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:31:31.118698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:31.124506 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:31:31.125696 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:31:31.126259 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:31:31.130175 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m08:31:31.131175 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:31:31.131929 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:31:31.135178 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:31.135874 [debug] [MainThread]: On master: BEGIN
[0m08:31:31.136296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:31.140560 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:31:31.141161 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:31.141756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:31:31.145077 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m08:31:31.146332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ff85d0>]}
[0m08:31:31.147968 [debug] [MainThread]: On master: ROLLBACK
[0m08:31:31.148510 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:31.150187 [debug] [MainThread]: On master: BEGIN
[0m08:31:31.150751 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:31:31.151214 [debug] [MainThread]: On master: COMMIT
[0m08:31:31.151653 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:31.152049 [debug] [MainThread]: On master: COMMIT
[0m08:31:31.152518 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:31:31.152977 [debug] [MainThread]: On master: Close
[0m08:31:31.155266 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:31:31.155435 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:31:31.157085 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:31:31.157859 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:31:31.158400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:31:31.160093 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:31:31.160589 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:31:31.161039 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:31:31.166439 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:31:31.168767 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:31:31.172100 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:31:31.172367 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:31:31.200645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:31:31.201765 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:31:31.204942 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:31.205210 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:31.207191 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:31:31.207904 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:31:31.208431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:31.208924 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:31:31.214772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:31:31.216031 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:31.216607 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:31:31.216946 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m08:31:31.217745 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:31.218465 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:31:31.221847 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m08:31:31.227102 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:31.227245 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:31:31.227976 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:31:31.229973 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:31.231030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:31.231183 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:31:31.232906 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:31.233872 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:31:31.233668 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:31.234573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:31.237156 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:31.245651 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:31:31.246006 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:31:31.246583 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:31.247267 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:31.247585 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:31:31.249598 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:31:31.250711 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:31.251015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:31:31.251549 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:31:31.254920 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:31:31.255786 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m08:31:31.258093 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:31.259481 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:31:31.260063 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:31:31.261073 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:31.262993 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:31:31.262817 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:31:31.265593 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:31:31.265824 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m08:31:31.268362 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:31:31.269221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1ac8050>]}
[0m08:31:31.268726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1a03a50>]}
[0m08:31:31.270175 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.11s]
[0m08:31:31.271114 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.11s]
[0m08:31:31.271687 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:31:31.272273 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:31:31.272891 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:31:31.273435 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:31:31.275383 [info ] [Thread-2 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:31:31.275998 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:31:31.277398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_weather)
[0m08:31:31.276768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_source_3)
[0m08:31:31.278370 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:31:31.279273 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:31:31.282180 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:31:31.284301 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:31:31.288965 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:31:31.289233 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:31:31.294321 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:31:31.296392 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:31:31.298319 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:31:31.300079 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:31.303710 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:31:31.301892 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:31:31.306923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:31.304998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:31:31.314151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:31:31.314981 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:31:31.314829 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m08:31:31.315981 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:31.315476 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    windSpeed as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    startTime,
    starttime::timestamp::date as start_date
from source
  );
[0m08:31:31.317011 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:31:31.318344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "windspeed" does not exist
LINE 16:     windSpeed as wind_speed,
             ^
HINT:  Perhaps you meant to reference the column "source.windSpeed".

[0m08:31:31.319178 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: ROLLBACK
[0m08:31:31.319560 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:31:31.320126 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:31:31.321975 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:31.325052 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windSpeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:31:31.325408 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:31:31.326073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4e35d0>]}
[0m08:31:31.326826 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:31.327414 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.stg_weather ..................... [[31mERROR[0m in 0.05s]
[0m08:31:31.329074 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:31.329795 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:31:31.330301 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:31:31.330861 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windSpeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql.
[0m08:31:31.331459 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:31.332783 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:31:31.333381 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:31.333944 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:31:31.335103 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:31:31.336567 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:31:31.338009 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:31.338518 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:31:31.339445 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:31:31.340333 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:31:31.340952 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0262822c-5e87-4daf-9211-83529823cdef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4e1990>]}
[0m08:31:31.341594 [info ] [Thread-2 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m08:31:31.342211 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:31:31.342953 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m08:31:31.343439 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.summary ......................................... [[33mSKIP[0m]
[0m08:31:31.344031 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m08:31:31.345001 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:31.345506 [debug] [MainThread]: On master: BEGIN
[0m08:31:31.346011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:31:31.350118 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:31:31.350884 [debug] [MainThread]: On master: COMMIT
[0m08:31:31.351370 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:31.351791 [debug] [MainThread]: On master: COMMIT
[0m08:31:31.352400 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:31:31.352953 [debug] [MainThread]: On master: Close
[0m08:31:31.353563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:31.354080 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_weather' was properly closed.
[0m08:31:31.354591 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:31:31.356398 [info ] [MainThread]: 
[0m08:31:31.356970 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m08:31:31.357931 [debug] [MainThread]: Command end result
[0m08:31:31.396464 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:31:31.398950 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:31:31.403405 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:31:31.403945 [info ] [MainThread]: 
[0m08:31:31.404437 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:31:31.405843 [info ] [MainThread]: 
[0m08:31:31.406308 [error] [MainThread]: [31mFailure in model stg_weather (models/staging/stg_weather.sql)[0m
[0m08:31:31.406786 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windSpeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:31:31.407227 [info ] [MainThread]: 
[0m08:31:31.407686 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:31:31.408116 [info ] [MainThread]: 
[0m08:31:31.408571 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m08:31:31.409576 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.92231494, "process_in_blocks": "0", "process_kernel_time": 0.197716, "process_mem_max_rss": "128776", "process_out_blocks": "2759", "process_user_time": 1.185301}
[0m08:31:31.410225 [debug] [MainThread]: Command `dbt run` failed at 08:31:31.410181 after 0.92 seconds
[0m08:31:31.410737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e7ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8fc1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8fc21d0>]}
[0m08:31:31.411745 [debug] [MainThread]: Flushing usage events
[0m08:31:31.769593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:31:50.047031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a16110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979e1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a3d710>]}


============================== 08:31:50.051393 | 96d1bfad-4ed2-4f41-a048-144a019d1168 ==============================
[0m08:31:50.051393 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:31:50.053012 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'empty': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_path': '/opt/dbt/logs', 'log_cache_events': 'False', 'profiles_dir': '/opt/dbt'}
[0m08:31:50.142627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a9a450>]}
[0m08:31:50.169260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a793c50>]}
[0m08:31:50.171169 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:31:50.205137 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:31:50.290658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:31:50.291373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:31:50.308505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b52650>]}
[0m08:31:50.369781 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:31:50.372511 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:31:50.380643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96aee150>]}
[0m08:31:50.381273 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:31:50.381827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9678a5d0>]}
[0m08:31:50.383210 [info ] [MainThread]: 
[0m08:31:50.385006 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:31:50.385491 [info ] [MainThread]: 
[0m08:31:50.386082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:31:50.388391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:31:50.411720 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:31:50.413165 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:31:50.415019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:50.432334 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m08:31:50.433595 [debug] [ThreadPool]: On list_dagster: Close
[0m08:31:50.434921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:31:50.439632 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:31:50.440165 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:31:50.440634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:50.448544 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:31:50.449134 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:31:50.449725 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:31:50.454682 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m08:31:50.456844 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:31:50.457555 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:31:50.461794 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:50.462366 [debug] [MainThread]: On master: BEGIN
[0m08:31:50.462891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:50.470586 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:31:50.471174 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:50.472992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:31:50.478226 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m08:31:50.480481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96aef050>]}
[0m08:31:50.481069 [debug] [MainThread]: On master: ROLLBACK
[0m08:31:50.481635 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:50.482083 [debug] [MainThread]: On master: BEGIN
[0m08:31:50.482632 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:31:50.483057 [debug] [MainThread]: On master: COMMIT
[0m08:31:50.483718 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:50.484167 [debug] [MainThread]: On master: COMMIT
[0m08:31:50.484708 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:31:50.485151 [debug] [MainThread]: On master: Close
[0m08:31:50.488099 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:31:50.488262 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:31:50.488660 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:31:50.489994 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:31:50.490471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:31:50.491078 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:31:50.491586 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:31:50.493847 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:31:50.498475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:31:50.500189 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:31:50.502395 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:31:50.502737 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:31:50.523618 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:31:50.552218 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:31:50.556971 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:50.557486 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:50.560044 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:31:50.561087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:50.560614 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:31:50.562965 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:31:50.567444 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m08:31:50.568005 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:50.568520 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:31:50.569507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:31:50.570068 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:50.570616 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:31:50.570417 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:31:50.574690 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:50.574825 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m08:31:50.575321 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:31:50.577094 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:50.578011 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:31:50.577875 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:50.578694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:50.580239 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:50.581947 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:50.582696 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:31:50.583230 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:31:50.583909 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:50.584395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:50.593775 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:31:50.594952 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:31:50.595619 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:50.596210 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:50.596890 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:31:50.598042 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:31:50.601420 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:31:50.601637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:31:50.607371 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:31:50.609744 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:31:50.614203 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:31:50.615095 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:31:50.615653 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:31:50.616278 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:31:50.617687 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:31:50.617851 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:31:50.620384 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:31:50.622761 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:31:50.624418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97925d50>]}
[0m08:31:50.627240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97876390>]}
[0m08:31:50.627810 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m08:31:50.629067 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:31:50.628510 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m08:31:50.630757 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:31:50.629832 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:31:50.633067 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:31:50.636923 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:31:50.635239 [info ] [Thread-2 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:31:50.637590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_weather)
[0m08:31:50.638299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_source_3)
[0m08:31:50.638941 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:31:50.639558 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:31:50.641472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:31:50.644671 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:31:50.647598 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:31:50.651024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:31:50.651211 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:31:50.655340 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:31:50.655967 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:31:50.656755 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:31:50.657218 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:50.657382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:50.658381 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:31:50.661540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:31:50.664240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:31:50.666087 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:31:50.667186 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    windSpeed as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    startTime,
    starttime::timestamp::date as start_date
from source
  );
[0m08:31:50.667465 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m08:31:50.668185 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "windspeed" does not exist
LINE 16:     windSpeed as wind_speed,
             ^
HINT:  Perhaps you meant to reference the column "source.windSpeed".

[0m08:31:50.669096 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:50.669906 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: ROLLBACK
[0m08:31:50.670492 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:31:50.671335 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:31:50.673893 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:31:50.680589 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:50.681454 [debug] [Thread-1 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windSpeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:31:50.682390 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:31:50.683068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a68610>]}
[0m08:31:50.683942 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:50.684485 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.stg_weather ..................... [[31mERROR[0m in 0.05s]
[0m08:31:50.688190 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:50.688884 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:31:50.692969 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:31:50.693579 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windSpeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql.
[0m08:31:50.694657 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:31:50.697289 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:31:50.697866 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:50.698387 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:31:50.699115 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m08:31:50.700591 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:31:50.701199 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:31:50.701731 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:31:50.702693 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:31:50.703665 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:31:50.704565 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d1bfad-4ed2-4f41-a048-144a019d1168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9413e090>]}
[0m08:31:50.707278 [info ] [Thread-2 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.07s]
[0m08:31:50.708984 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:31:50.709667 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m08:31:50.710155 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.summary ......................................... [[33mSKIP[0m]
[0m08:31:50.710674 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m08:31:50.711620 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:50.712100 [debug] [MainThread]: On master: BEGIN
[0m08:31:50.712564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:31:50.716914 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:31:50.718007 [debug] [MainThread]: On master: COMMIT
[0m08:31:50.718487 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:50.719855 [debug] [MainThread]: On master: COMMIT
[0m08:31:50.720332 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:31:50.720851 [debug] [MainThread]: On master: Close
[0m08:31:50.721546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:50.722382 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_weather' was properly closed.
[0m08:31:50.722844 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:31:50.726044 [info ] [MainThread]: 
[0m08:31:50.727787 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m08:31:50.729078 [debug] [MainThread]: Command end result
[0m08:31:50.775052 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:31:50.776883 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:31:50.780636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:31:50.781093 [info ] [MainThread]: 
[0m08:31:50.781591 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:31:50.782033 [info ] [MainThread]: 
[0m08:31:50.782524 [error] [MainThread]: [31mFailure in model stg_weather (models/staging/stg_weather.sql)[0m
[0m08:31:50.782983 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windSpeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:31:50.783983 [info ] [MainThread]: 
[0m08:31:50.784415 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:31:50.784938 [info ] [MainThread]: 
[0m08:31:50.785644 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m08:31:50.786680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.77371377, "process_in_blocks": "0", "process_kernel_time": 0.363205, "process_mem_max_rss": "125628", "process_out_blocks": "1867", "process_user_time": 1.060518}
[0m08:31:50.788150 [debug] [MainThread]: Command `dbt run` failed at 08:31:50.788055 after 0.78 seconds
[0m08:31:50.788713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c992590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94112e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94110690>]}
[0m08:31:50.789295 [debug] [MainThread]: Flushing usage events
[0m08:31:51.153932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:32:50.539358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47dd810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4651cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47df890>]}


============================== 08:32:50.541612 | 553e6943-f8bc-4789-ad34-4f99a5c3f9bd ==============================
[0m08:32:50.541612 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:32:50.542671 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/opt/dbt/logs', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'static_parser': 'True', 'empty': 'False', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'profiles_dir': '/opt/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m08:32:50.618829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4596250>]}
[0m08:32:50.647211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7414150>]}
[0m08:32:50.649504 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:32:50.682408 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:32:50.765198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:32:50.765953 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/stg_weather.sql
[0m08:32:50.901149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa37b4d90>]}
[0m08:32:50.960273 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:32:50.963292 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:32:50.971201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32fd6d0>]}
[0m08:32:50.971842 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:32:50.972477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3246d10>]}
[0m08:32:50.973699 [info ] [MainThread]: 
[0m08:32:50.974743 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:32:50.975745 [info ] [MainThread]: 
[0m08:32:50.976356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:32:50.978721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:32:51.031546 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:32:51.032544 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:32:51.033983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:32:51.049034 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m08:32:51.050165 [debug] [ThreadPool]: On list_dagster: Close
[0m08:32:51.051602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:32:51.055139 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:32:51.056717 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:32:51.057277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:32:51.063573 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:32:51.064285 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:32:51.064871 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:32:51.067433 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:32:51.068587 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:32:51.069187 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:32:51.073619 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:51.074218 [debug] [MainThread]: On master: BEGIN
[0m08:32:51.074789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:32:51.079075 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:32:51.079647 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:51.080345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:32:51.083182 [debug] [MainThread]: SQL status: SELECT 6 in 0.002 seconds
[0m08:32:51.084187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa351bdd0>]}
[0m08:32:51.084818 [debug] [MainThread]: On master: ROLLBACK
[0m08:32:51.085452 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:51.085988 [debug] [MainThread]: On master: BEGIN
[0m08:32:51.086675 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:32:51.087207 [debug] [MainThread]: On master: COMMIT
[0m08:32:51.087726 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:51.088228 [debug] [MainThread]: On master: COMMIT
[0m08:32:51.089145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:32:51.089680 [debug] [MainThread]: On master: Close
[0m08:32:51.091623 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:32:51.091794 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:32:51.092221 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:32:51.092794 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:32:51.093922 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:32:51.093322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:32:51.094669 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:32:51.095396 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:32:51.100503 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:32:51.103078 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:32:51.105969 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:32:51.106444 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:32:51.124394 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:32:51.126901 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:32:51.130211 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:32:51.130480 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:32:51.133591 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:32:51.132648 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:32:51.135142 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:32:51.134612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:32:51.141169 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m08:32:51.141566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:32:51.141805 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:32:51.142313 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:32:51.144456 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:32:51.143957 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:32:51.146641 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:32:51.146831 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:32:51.150226 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:32:51.152514 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:32:51.152014 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:32:51.153427 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:32:51.153292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:32:51.155393 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:32:51.154139 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:32:51.156003 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:32:51.157607 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:32:51.158581 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:32:51.158215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:32:51.159329 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:32:51.168343 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:32:51.169206 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:32:51.169831 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:32:51.170356 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:32:51.170883 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:32:51.171370 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:32:51.172453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:32:51.172748 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m08:32:51.175968 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:32:51.177754 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:32:51.180453 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:32:51.181168 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:32:51.181708 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:32:51.182300 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:32:51.183785 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:32:51.183935 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:32:51.185422 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:32:51.186424 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:32:51.187867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2655990>]}
[0m08:32:51.188082 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3145bd0>]}
[0m08:32:51.188859 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m08:32:51.189485 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m08:32:51.189912 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:32:51.190408 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:32:51.191032 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:32:51.191512 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:32:51.192957 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:32:51.193795 [info ] [Thread-2 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:32:51.194427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_source_3)
[0m08:32:51.195016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_weather)
[0m08:32:51.195555 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:32:51.196961 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:32:51.198952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:32:51.200808 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:32:51.202975 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:32:51.208169 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:32:51.208320 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:32:51.211023 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:32:51.211601 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:32:51.213516 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:32:51.214008 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:32:51.215806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:32:51.216351 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:32:51.217407 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:32:51.222276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:32:51.223271 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:32:51.223012 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m08:32:51.223834 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:32:51.224345 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:32:51.225212 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    windspeed as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    startTime,
    starttime::timestamp::date as start_date
from source
  );
[0m08:32:51.225829 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:32:51.226132 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "windspeed" does not exist
LINE 16:     windspeed as wind_speed,
             ^
HINT:  Perhaps you meant to reference the column "source.windSpeed".

[0m08:32:51.228538 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: ROLLBACK
[0m08:32:51.227860 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:32:51.229196 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:32:51.229540 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:32:51.232042 [debug] [Thread-2 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windspeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:32:51.232615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:32:51.233006 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0451950>]}
[0m08:32:51.234644 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:32:51.235482 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model analytics.stg_weather ..................... [[31mERROR[0m in 0.04s]
[0m08:32:51.236730 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:32:51.237449 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:32:51.238273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:32:51.238751 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windspeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql.
[0m08:32:51.239646 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:32:51.241004 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:32:51.241590 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:32:51.242473 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:32:51.243942 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:32:51.244639 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:32:51.245121 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:32:51.246007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:32:51.246875 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:32:51.247535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553e6943-f8bc-4789-ad34-4f99a5c3f9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34646d0>]}
[0m08:32:51.248168 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.05s]
[0m08:32:51.249818 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:32:51.250630 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.summary
[0m08:32:51.251095 [info ] [Thread-2 (]: 5 of 5 SKIP relation analytics.summary ......................................... [[33mSKIP[0m]
[0m08:32:51.251639 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.summary
[0m08:32:51.252663 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:51.253113 [debug] [MainThread]: On master: BEGIN
[0m08:32:51.253552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:32:51.257432 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:32:51.257922 [debug] [MainThread]: On master: COMMIT
[0m08:32:51.258461 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:51.259791 [debug] [MainThread]: On master: COMMIT
[0m08:32:51.260768 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:32:51.271974 [debug] [MainThread]: On master: Close
[0m08:32:51.274762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:32:51.286492 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:32:51.294876 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_weather' was properly closed.
[0m08:32:51.295988 [info ] [MainThread]: 
[0m08:32:51.297147 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m08:32:51.298332 [debug] [MainThread]: Command end result
[0m08:32:51.338909 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:32:51.341951 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:32:51.346155 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:32:51.346632 [info ] [MainThread]: 
[0m08:32:51.347228 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:32:51.347720 [info ] [MainThread]: 
[0m08:32:51.348318 [error] [MainThread]: [31mFailure in model stg_weather (models/staging/stg_weather.sql)[0m
[0m08:32:51.348866 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windspeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:32:51.349342 [info ] [MainThread]: 
[0m08:32:51.349876 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:32:51.350495 [info ] [MainThread]: 
[0m08:32:51.351103 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m08:32:51.351980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8418968, "process_in_blocks": "0", "process_kernel_time": 0.16687, "process_mem_max_rss": "128496", "process_out_blocks": "2759", "process_user_time": 1.158038}
[0m08:32:51.352526 [debug] [MainThread]: Command `dbt run` failed at 08:32:51.352479 after 0.84 seconds
[0m08:32:51.353169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47dd810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa560cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9601910>]}
[0m08:32:51.353708 [debug] [MainThread]: Flushing usage events
[0m08:32:51.705254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:33:33.324959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c487b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d398f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c722510>]}


============================== 08:33:33.330828 | ef00a638-4c03-4c0c-9ff8-a815b330bbb9 ==============================
[0m08:33:33.330828 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:33:33.333628 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'profiles_dir': '/opt/dbt', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'target_path': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_path': '/opt/dbt/logs', 'empty': 'False', 'introspect': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False'}
[0m08:33:33.467131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c489710>]}
[0m08:33:33.494435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f227950>]}
[0m08:33:33.497106 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:33:33.529279 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:33:33.606225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:33:33.609085 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/stg_weather.sql
[0m08:33:33.754354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b338a10>]}
[0m08:33:34.008067 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:33:34.020530 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:33:34.054741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b181fd0>]}
[0m08:33:34.059287 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:33:34.062028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b04f7d0>]}
[0m08:33:34.070802 [info ] [MainThread]: 
[0m08:33:34.073385 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:33:34.074641 [info ] [MainThread]: 
[0m08:33:34.078726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:33:34.092717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:33:34.219573 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:33:34.220990 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:33:34.222804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:34.250985 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m08:33:34.253715 [debug] [ThreadPool]: On list_dagster: Close
[0m08:33:34.259226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:33:34.270592 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:33:34.272814 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:33:34.275978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:34.292419 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m08:33:34.294880 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:33:34.296521 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:33:34.302693 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:33:34.306781 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:33:34.309365 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:33:34.326129 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:34.328866 [debug] [MainThread]: On master: BEGIN
[0m08:33:34.330046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:33:34.339506 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:33:34.341996 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:34.343125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:33:34.351009 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m08:33:34.354855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3f83d0>]}
[0m08:33:34.360146 [debug] [MainThread]: On master: ROLLBACK
[0m08:33:34.363004 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:34.365205 [debug] [MainThread]: On master: BEGIN
[0m08:33:34.371207 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:33:34.374425 [debug] [MainThread]: On master: COMMIT
[0m08:33:34.378266 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:34.381692 [debug] [MainThread]: On master: COMMIT
[0m08:33:34.389210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:33:34.392260 [debug] [MainThread]: On master: Close
[0m08:33:34.401189 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:33:34.401421 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:33:34.403376 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:33:34.406969 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:33:34.417655 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:33:34.413136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:33:34.419828 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:33:34.421699 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:33:34.448800 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:33:34.437592 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:33:34.468787 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:33:34.473038 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:33:34.645874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:33:34.647697 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:33:34.652961 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:33:34.653913 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:33:34.659963 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:33:34.664650 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:33:34.668993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:34.671154 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:33:34.681709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m08:33:34.682541 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m08:33:34.682993 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:33:34.684753 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:33:34.686011 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:33:34.687302 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:33:34.691990 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:33:34.693748 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:33:34.699873 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:33:34.703542 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:33:34.704166 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:33:34.704847 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:33:34.706019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:33:34.706746 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:33:34.708214 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:33:34.710351 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:33:34.710970 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:33:34.711635 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:33:34.712327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:33:34.713072 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:33:34.725519 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:33:34.726430 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:33:34.727014 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:33:34.727509 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:33:34.728136 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:33:34.728845 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:33:34.730331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:33:34.730488 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:33:34.734750 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:33:34.736864 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:33:34.740620 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:33:34.741690 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:33:34.742990 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:33:34.743579 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:33:34.746275 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:33:34.746979 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:33:34.748954 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:33:34.751367 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:33:34.754444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a3bbc50>]}
[0m08:33:34.755055 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a592b50>]}
[0m08:33:34.756463 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.34s]
[0m08:33:34.757020 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.34s]
[0m08:33:34.757811 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:33:34.758352 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:33:34.760086 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:33:34.761018 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:33:34.761895 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:33:34.762841 [info ] [Thread-2 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:33:34.765135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_source_3)
[0m08:33:34.765791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_weather)
[0m08:33:34.766640 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:33:34.767489 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:33:34.773004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:33:34.776275 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:33:34.780326 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:33:34.783711 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:33:34.784093 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:33:34.788958 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:33:34.789884 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:33:34.790822 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:33:34.793472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:34.793706 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:33:34.795939 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:33:34.796548 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:33:34.800333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:33:34.802828 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:33:34.803502 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:33:34.803935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m08:33:34.805023 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:33:34.805405 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:33:34.806186 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    windSpeed as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    startTime,
    starttime::timestamp::date as start_date
from source
  );
[0m08:33:34.808441 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:33:34.809661 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:33:34.809510 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "windspeed" does not exist
LINE 16:     windSpeed as wind_speed,
             ^
HINT:  Perhaps you meant to reference the column "source.windSpeed".

[0m08:33:34.810557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:33:34.812017 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: ROLLBACK
[0m08:33:34.813807 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:33:34.814646 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:33:34.815017 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:33:34.819233 [debug] [Thread-2 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windSpeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:33:34.819387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:33:34.820971 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a49bdd0>]}
[0m08:33:34.822729 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:33:34.823833 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model analytics.stg_weather ..................... [[31mERROR[0m in 0.06s]
[0m08:33:34.824622 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:33:34.826206 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:33:34.827119 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:33:34.828213 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windSpeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql.
[0m08:33:34.829159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:33:34.834627 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:33:34.835536 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:33:34.836697 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:33:34.838920 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:33:34.840783 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:33:34.842018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef00a638-4c03-4c0c-9ff8-a815b330bbb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78287fd0>]}
[0m08:33:34.842973 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m08:33:34.843793 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:33:34.844919 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.summary
[0m08:33:34.846336 [info ] [Thread-2 (]: 5 of 5 SKIP relation analytics.summary ......................................... [[33mSKIP[0m]
[0m08:33:34.847116 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.summary
[0m08:33:34.849478 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:34.850094 [debug] [MainThread]: On master: BEGIN
[0m08:33:34.850636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:33:34.856609 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:33:34.857430 [debug] [MainThread]: On master: COMMIT
[0m08:33:34.859002 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:34.860036 [debug] [MainThread]: On master: COMMIT
[0m08:33:34.861047 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:33:34.862289 [debug] [MainThread]: On master: Close
[0m08:33:34.863532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:33:34.865068 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:33:34.865811 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_weather' was properly closed.
[0m08:33:34.866653 [info ] [MainThread]: 
[0m08:33:34.867314 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m08:33:34.868375 [debug] [MainThread]: Command end result
[0m08:33:34.920888 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:33:34.925051 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:33:34.934925 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:33:34.935430 [info ] [MainThread]: 
[0m08:33:34.936123 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:33:34.936703 [info ] [MainThread]: 
[0m08:33:34.937492 [error] [MainThread]: [31mFailure in model stg_weather (models/staging/stg_weather.sql)[0m
[0m08:33:34.938170 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "windspeed" does not exist
  LINE 16:     windSpeed as wind_speed,
               ^
  HINT:  Perhaps you meant to reference the column "source.windSpeed".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:33:34.939119 [info ] [MainThread]: 
[0m08:33:34.939855 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:33:34.941035 [info ] [MainThread]: 
[0m08:33:34.942386 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m08:33:34.944159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6845211, "process_in_blocks": "0", "process_kernel_time": 0.316738, "process_mem_max_rss": "128256", "process_out_blocks": "2759", "process_user_time": 1.762254}
[0m08:33:34.946252 [debug] [MainThread]: Command `dbt run` failed at 08:33:34.946199 after 1.69 seconds
[0m08:33:34.947272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a54c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81422710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81421910>]}
[0m08:33:34.947860 [debug] [MainThread]: Flushing usage events
[0m08:33:35.342868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:34:06.755907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de8fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de8f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd35a90>]}


============================== 08:34:06.759133 | 808d57f1-9fdc-4524-a28a-2521ff6442f1 ==============================
[0m08:34:06.759133 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:34:06.760097 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'profiles_dir': '/opt/dbt', 'log_cache_events': 'False', 'no_print': 'None', 'target_path': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/dbt/logs', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'debug': 'False', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True'}
[0m08:34:06.839477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd5dc50>]}
[0m08:34:06.867860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0abc4d0>]}
[0m08:34:06.869150 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:34:06.904882 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:34:06.970006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:34:06.970807 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/stg_weather.sql
[0m08:34:07.090044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca3a1d0>]}
[0m08:34:07.150201 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:34:07.154609 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:34:07.162247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8f6e90>]}
[0m08:34:07.163050 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:34:07.163590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c79f090>]}
[0m08:34:07.165870 [info ] [MainThread]: 
[0m08:34:07.166421 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:34:07.166914 [info ] [MainThread]: 
[0m08:34:07.167499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:34:07.169833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:34:07.223987 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:34:07.225277 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:34:07.227173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:07.239483 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m08:34:07.240843 [debug] [ThreadPool]: On list_dagster: Close
[0m08:34:07.242817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:34:07.246872 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:34:07.247449 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:34:07.249066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:07.253663 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:34:07.255107 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:34:07.255691 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:34:07.257942 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:34:07.259170 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:34:07.259874 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:34:07.263009 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:07.263603 [debug] [MainThread]: On master: BEGIN
[0m08:34:07.264192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:34:07.268336 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:34:07.269165 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:07.269846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:34:07.273067 [debug] [MainThread]: SQL status: SELECT 6 in 0.002 seconds
[0m08:34:07.274124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd73f90>]}
[0m08:34:07.275133 [debug] [MainThread]: On master: ROLLBACK
[0m08:34:07.275786 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:07.276342 [debug] [MainThread]: On master: BEGIN
[0m08:34:07.277063 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:34:07.277620 [debug] [MainThread]: On master: COMMIT
[0m08:34:07.279077 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:07.279921 [debug] [MainThread]: On master: COMMIT
[0m08:34:07.280553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:34:07.281111 [debug] [MainThread]: On master: Close
[0m08:34:07.283513 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:34:07.283699 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:34:07.284233 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:34:07.286207 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:34:07.286962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:34:07.287615 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:34:07.288198 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:34:07.288715 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:34:07.292594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:34:07.294312 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:34:07.296806 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:34:07.304862 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:34:07.313041 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:34:07.315191 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:34:07.318115 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:07.321245 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:34:07.318911 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:07.322171 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:34:07.321719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:07.322612 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:34:07.327068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:34:07.329504 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:07.330084 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:34:07.329758 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m08:34:07.330902 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:07.331457 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:34:07.331919 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:34:07.335219 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:07.335402 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:34:07.335890 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:34:07.337733 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:07.338576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:07.338941 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:34:07.340625 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:07.341435 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:07.342191 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:34:07.343859 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:07.344623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:07.344992 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:34:07.352682 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:34:07.353341 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:07.353723 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:07.354987 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:34:07.356114 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:07.355568 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:34:07.356626 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:34:07.357640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:34:07.357812 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m08:34:07.360807 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:34:07.362291 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:34:07.366070 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:07.366806 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:07.367393 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:34:07.367980 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:34:07.369224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:34:07.369537 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:34:07.370782 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:34:07.371657 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:34:07.373141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9c4e50>]}
[0m08:34:07.373264 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be30710>]}
[0m08:34:07.374055 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m08:34:07.375054 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:34:07.374640 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m08:34:07.376605 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:34:07.376028 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:34:07.377090 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:34:07.377621 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:34:07.378264 [info ] [Thread-2 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:34:07.379771 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_weather)
[0m08:34:07.379209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_source_3)
[0m08:34:07.380348 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:34:07.380904 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:34:07.383266 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:34:07.386255 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:34:07.389795 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:34:07.390242 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:34:07.393199 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:34:07.395454 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:34:07.396981 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:34:07.397576 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:07.399158 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:34:07.400173 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:34:07.399681 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:34:07.401604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:07.406880 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m08:34:07.407718 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:34:07.407990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:34:07.409195 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    "windSpeed" as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    "startTime" as start_time,
    starttime::timestamp::date as start_date
from source
  );
[0m08:34:07.409672 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:07.410528 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:34:07.411641 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "starttime" does not exist
LINE 19:     starttime::timestamp::date as start_date
             ^
HINT:  Perhaps you meant to reference the column "source.startTime".

[0m08:34:07.412280 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: ROLLBACK
[0m08:34:07.412673 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:34:07.414360 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:34:07.415986 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:07.417920 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:34:07.418946 [debug] [Thread-2 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "starttime" does not exist
  LINE 19:     starttime::timestamp::date as start_date
               ^
  HINT:  Perhaps you meant to reference the column "source.startTime".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:34:07.419681 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca12f90>]}
[0m08:34:07.419290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:07.420576 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model analytics.stg_weather ..................... [[31mERROR[0m in 0.04s]
[0m08:34:07.422217 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:07.422978 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:34:07.423574 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:34:07.425470 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "starttime" does not exist
  LINE 19:     starttime::timestamp::date as start_date
               ^
  HINT:  Perhaps you meant to reference the column "source.startTime".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql.
[0m08:34:07.426135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:07.427721 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:34:07.428248 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:07.428774 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:34:07.430145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:34:07.431620 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:34:07.432348 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:07.432892 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:34:07.433756 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:34:07.434847 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:34:07.435991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '808d57f1-9fdc-4524-a28a-2521ff6442f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccbc790>]}
[0m08:34:07.437187 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m08:34:07.437764 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:34:07.438399 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.summary
[0m08:34:07.440164 [info ] [Thread-2 (]: 5 of 5 SKIP relation analytics.summary ......................................... [[33mSKIP[0m]
[0m08:34:07.440674 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.summary
[0m08:34:07.442454 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:07.442927 [debug] [MainThread]: On master: BEGIN
[0m08:34:07.443332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:34:07.447639 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:34:07.448101 [debug] [MainThread]: On master: COMMIT
[0m08:34:07.448542 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:07.449054 [debug] [MainThread]: On master: COMMIT
[0m08:34:07.449631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:34:07.450141 [debug] [MainThread]: On master: Close
[0m08:34:07.450892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:34:07.451395 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:34:07.453110 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_weather' was properly closed.
[0m08:34:07.453713 [info ] [MainThread]: 
[0m08:34:07.454304 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:34:07.455217 [debug] [MainThread]: Command end result
[0m08:34:07.602534 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:34:07.608021 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:34:07.615020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:34:07.615805 [info ] [MainThread]: 
[0m08:34:07.625179 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:34:07.634210 [info ] [MainThread]: 
[0m08:34:07.635287 [error] [MainThread]: [31mFailure in model stg_weather (models/staging/stg_weather.sql)[0m
[0m08:34:07.637321 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "starttime" does not exist
  LINE 19:     starttime::timestamp::date as start_date
               ^
  HINT:  Perhaps you meant to reference the column "source.startTime".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:34:07.640302 [info ] [MainThread]: 
[0m08:34:07.642206 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:34:07.642980 [info ] [MainThread]: 
[0m08:34:07.643693 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m08:34:07.647867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.92543375, "process_in_blocks": "0", "process_kernel_time": 0.201504, "process_mem_max_rss": "128172", "process_out_blocks": "2760", "process_user_time": 1.146949}
[0m08:34:07.650693 [debug] [MainThread]: Command `dbt run` failed at 08:34:07.650554 after 0.93 seconds
[0m08:34:07.652814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de8f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de8f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a9d890>]}
[0m08:34:07.653522 [debug] [MainThread]: Flushing usage events
[0m08:34:08.011080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:34:37.301744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85615d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85609c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8647a3d0>]}


============================== 08:34:37.305797 | 78987af0-7596-4cfb-bb76-959b29683504 ==============================
[0m08:34:37.305797 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:34:37.308348 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'write_json': 'True', 'log_path': '/opt/dbt/logs', 'log_format': 'default', 'profiles_dir': '/opt/dbt', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80'}
[0m08:34:37.440068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8560a510>]}
[0m08:34:37.485180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883b7b10>]}
[0m08:34:37.487299 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:34:37.536824 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:34:37.604327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:34:37.605723 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/stg_weather.sql
[0m08:34:37.740357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841bb550>]}
[0m08:34:37.806502 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:34:37.809703 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:34:37.822508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841b9a50>]}
[0m08:34:37.823264 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:34:37.824149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85490b50>]}
[0m08:34:37.825792 [info ] [MainThread]: 
[0m08:34:37.826428 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:34:37.827132 [info ] [MainThread]: 
[0m08:34:37.827915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:34:37.830585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:34:37.892719 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:34:37.893797 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:34:37.894434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:37.913439 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m08:34:37.914904 [debug] [ThreadPool]: On list_dagster: Close
[0m08:34:37.916714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:34:37.920504 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:34:37.921165 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:34:37.921788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:37.926543 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:34:37.927179 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:34:37.929551 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:34:37.934891 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:34:37.937211 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:34:37.937887 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:34:37.941013 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:37.941554 [debug] [MainThread]: On master: BEGIN
[0m08:34:37.942875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:34:37.948009 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:34:37.949759 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:37.950412 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:34:37.954221 [debug] [MainThread]: SQL status: SELECT 6 in 0.002 seconds
[0m08:34:37.956500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846f0c50>]}
[0m08:34:37.957152 [debug] [MainThread]: On master: ROLLBACK
[0m08:34:37.957805 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:37.958352 [debug] [MainThread]: On master: BEGIN
[0m08:34:37.959046 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:34:37.959534 [debug] [MainThread]: On master: COMMIT
[0m08:34:37.960033 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:37.960546 [debug] [MainThread]: On master: COMMIT
[0m08:34:37.961134 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:34:37.961663 [debug] [MainThread]: On master: Close
[0m08:34:37.966274 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:34:37.966574 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:34:37.967218 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:34:37.968956 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:34:37.969589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:34:37.970857 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:34:37.971391 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:34:37.971941 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:34:37.976221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:34:37.978187 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:34:37.980852 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:34:37.981702 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:34:37.998490 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:34:38.000653 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:34:38.003599 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:38.004379 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:34:38.006723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:38.004648 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:38.007783 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:34:38.008306 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:34:38.011456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:34:38.013723 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:38.014233 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m08:34:38.014745 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:34:38.015301 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:38.018670 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:34:38.019664 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:34:38.020002 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:34:38.023129 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:38.025492 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:34:38.024918 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:38.026513 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:34:38.026289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:38.028414 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:38.028542 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:34:38.029016 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:34:38.030662 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:38.031707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:38.032031 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:34:38.039860 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:34:38.040506 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:38.040911 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:38.043021 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:34:38.041966 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:34:38.045851 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:38.046473 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:34:38.047844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:34:38.048021 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:34:38.051050 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:34:38.052507 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:34:38.056078 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:34:38.056735 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:34:38.057193 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:34:38.057700 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:34:38.058856 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:34:38.059003 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:34:38.060313 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:34:38.061255 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:34:38.062515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84500350>]}
[0m08:34:38.064175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8371e090>]}
[0m08:34:38.064782 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m08:34:38.065457 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m08:34:38.065841 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:34:38.066893 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:34:38.066439 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:34:38.067937 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:34:38.067418 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:34:38.068460 [info ] [Thread-2 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:34:38.069895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_source_3)
[0m08:34:38.070358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_weather)
[0m08:34:38.070881 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:34:38.071308 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:34:38.074302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:34:38.076154 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:34:38.079142 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:34:38.080720 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:34:38.084124 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:34:38.086977 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:34:38.088391 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:38.089900 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:34:38.090137 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:34:38.092426 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:34:38.091950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:38.092869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:34:38.098874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:34:38.099358 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:38.099866 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:34:38.100132 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m08:34:38.101049 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:34:38.101536 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    "windSpeed" as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    "startTime" as start_time,
    start_time::timestamp::date as start_date
from source
  );
[0m08:34:38.102242 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:34:38.104158 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:38.104305 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "start_time" does not exist
LINE 19:     start_time::timestamp::date as start_date
             ^
HINT:  Perhaps you meant to reference the column "source.startTime".

[0m08:34:38.106009 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:34:38.106606 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: ROLLBACK
[0m08:34:38.107494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:38.108005 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:34:38.109509 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:38.110957 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:34:38.111976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:34:38.113103 [debug] [Thread-2 (]: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "start_time" does not exist
  LINE 19:     start_time::timestamp::date as start_date
               ^
  HINT:  Perhaps you meant to reference the column "source.startTime".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:34:38.113930 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:34:38.114686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83622b90>]}
[0m08:34:38.115307 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:38.116099 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model analytics.stg_weather ..................... [[31mERROR[0m in 0.04s]
[0m08:34:38.116585 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:34:38.117956 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:34:38.118962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:34:38.119198 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.stg_weather' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "start_time" does not exist
  LINE 19:     start_time::timestamp::date as start_date
               ^
  HINT:  Perhaps you meant to reference the column "source.startTime".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql.
[0m08:34:38.120689 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:34:38.122395 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:34:38.122843 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:34:38.123837 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:34:38.124890 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:34:38.125627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78987af0-7596-4cfb-bb76-959b29683504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81401610>]}
[0m08:34:38.126257 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m08:34:38.126904 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:34:38.127632 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.summary
[0m08:34:38.128114 [info ] [Thread-2 (]: 5 of 5 SKIP relation analytics.summary ......................................... [[33mSKIP[0m]
[0m08:34:38.129839 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.summary
[0m08:34:38.130833 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:38.131282 [debug] [MainThread]: On master: BEGIN
[0m08:34:38.131742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:34:38.135895 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:34:38.136349 [debug] [MainThread]: On master: COMMIT
[0m08:34:38.137643 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:38.139025 [debug] [MainThread]: On master: COMMIT
[0m08:34:38.139581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:34:38.140112 [debug] [MainThread]: On master: Close
[0m08:34:38.140716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:34:38.141793 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:34:38.142315 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_weather' was properly closed.
[0m08:34:38.142899 [info ] [MainThread]: 
[0m08:34:38.144772 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m08:34:38.146115 [debug] [MainThread]: Command end result
[0m08:34:38.185408 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:34:38.187943 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:34:38.192226 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:34:38.192733 [info ] [MainThread]: 
[0m08:34:38.193217 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:34:38.194679 [info ] [MainThread]: 
[0m08:34:38.195209 [error] [MainThread]: [31mFailure in model stg_weather (models/staging/stg_weather.sql)[0m
[0m08:34:38.195760 [error] [MainThread]:   Database Error in model stg_weather (models/staging/stg_weather.sql)
  column "start_time" does not exist
  LINE 19:     start_time::timestamp::date as start_date
               ^
  HINT:  Perhaps you meant to reference the column "source.startTime".
  compiled code at target/run/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:34:38.196240 [info ] [MainThread]: 
[0m08:34:38.196749 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/staging/stg_weather.sql
[0m08:34:38.197266 [info ] [MainThread]: 
[0m08:34:38.198907 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m08:34:38.199979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9486532, "process_in_blocks": "0", "process_kernel_time": 0.309258, "process_mem_max_rss": "128148", "process_out_blocks": "2760", "process_user_time": 1.410866}
[0m08:34:38.200542 [debug] [MainThread]: Command `dbt run` failed at 08:34:38.200486 after 0.95 seconds
[0m08:34:38.201036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814899d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814898d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85615650>]}
[0m08:34:38.201740 [debug] [MainThread]: Flushing usage events
[0m08:34:38.565266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:35:03.938917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb613b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5823190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5821cd0>]}


============================== 08:35:03.941868 | a40ea373-d294-4806-879c-3cf064eef783 ==============================
[0m08:35:03.941868 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:35:03.942903 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_path': '/opt/dbt/logs', 'debug': 'False', 'version_check': 'True', 'quiet': 'False', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/opt/dbt', 'warn_error': 'None'}
[0m08:35:04.055904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48c9d10>]}
[0m08:35:04.098405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85c7c10>]}
[0m08:35:04.099482 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:35:04.140059 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:35:04.242456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:35:04.243336 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/staging/stg_weather.sql
[0m08:35:04.405697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb44fdf50>]}
[0m08:35:04.490259 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:35:04.494463 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:35:04.505679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb44fdc10>]}
[0m08:35:04.506563 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:35:04.507390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb587f510>]}
[0m08:35:04.509855 [info ] [MainThread]: 
[0m08:35:04.510460 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:35:04.511282 [info ] [MainThread]: 
[0m08:35:04.512060 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:35:04.517153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:35:04.612844 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:35:04.614905 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:35:04.615581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:04.634585 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m08:35:04.636105 [debug] [ThreadPool]: On list_dagster: Close
[0m08:35:04.639689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:35:04.646041 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:35:04.646798 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:35:04.648079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:35:04.656018 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:35:04.658558 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:35:04.664541 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:35:04.669699 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m08:35:04.671151 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:35:04.672019 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:35:04.677624 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:04.678993 [debug] [MainThread]: On master: BEGIN
[0m08:35:04.679597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:35:04.684732 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:35:04.685627 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:04.686340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:35:04.689444 [debug] [MainThread]: SQL status: SELECT 6 in 0.002 seconds
[0m08:35:04.692231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb43f2750>]}
[0m08:35:04.693917 [debug] [MainThread]: On master: ROLLBACK
[0m08:35:04.695812 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:04.696579 [debug] [MainThread]: On master: BEGIN
[0m08:35:04.697518 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:35:04.698604 [debug] [MainThread]: On master: COMMIT
[0m08:35:04.699587 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:04.700933 [debug] [MainThread]: On master: COMMIT
[0m08:35:04.701546 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:35:04.702313 [debug] [MainThread]: On master: Close
[0m08:35:04.706238 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:35:04.706569 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:35:04.707829 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:35:04.708734 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:35:04.710040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:35:04.710988 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:35:04.711680 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:35:04.712338 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:35:04.719147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:35:04.721789 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:35:04.724426 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:35:04.733536 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:35:04.749873 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:35:04.751235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:35:04.752796 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:35:04.753468 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:35:04.754900 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:35:04.755642 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:35:04.756969 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:35:04.757807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:04.773675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m08:35:04.774015 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m08:35:04.775196 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:35:04.776562 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:35:04.777923 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:35:04.778772 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:35:04.780916 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:35:04.782090 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:35:04.792375 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:35:04.792681 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:35:04.793278 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:35:04.794061 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:35:04.795156 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:35:04.796012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:35:04.797800 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:35:04.800152 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:35:04.800893 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:35:04.801800 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:35:04.803279 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:35:04.804135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:35:04.825124 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:35:04.829107 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:35:04.830869 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:35:04.833193 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:35:04.832310 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:35:04.834692 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:35:04.834965 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:35:04.835999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:35:04.839975 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:35:04.842487 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:35:04.846145 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:35:04.848061 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:35:04.849275 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:35:04.851071 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:35:04.853710 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m08:35:04.854821 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:35:04.857278 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:35:04.859519 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:35:04.861696 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb46dffd0>]}
[0m08:35:04.862646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb42f6310>]}
[0m08:35:04.864243 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m08:35:04.865949 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m08:35:04.866731 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:35:04.867458 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:35:04.868170 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:35:04.869221 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:35:04.871903 [info ] [Thread-2 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:35:04.872766 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:35:04.874015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_source_3)
[0m08:35:04.875584 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:35:04.874656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_weather)
[0m08:35:04.881956 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:35:04.880707 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:35:04.885148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:35:04.887233 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:35:04.895863 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:35:04.896370 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:35:04.901456 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:35:04.902311 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:35:04.904637 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:35:04.905276 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:35:04.907245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:35:04.909179 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:35:04.912919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:04.919780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:35:04.920193 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m08:35:04.920783 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:35:04.921599 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:35:04.922296 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    "windSpeed" as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    "startTime" as start_time,
    "startTime"::timestamp::date as start_date
from source
  );
[0m08:35:04.923738 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:35:04.929693 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m08:35:04.934117 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:35:04.934449 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:35:04.935107 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
alter table "dagster"."analytics"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m08:35:04.941626 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:35:04.943314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:35:04.943612 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:35:04.946981 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:35:04.948255 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:35:04.948574 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:35:04.951889 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:35:04.954425 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:35:04.953282 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:35:04.958183 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:35:04.959866 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:35:04.960039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:35:04.960631 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:35:04.962365 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_weather__dbt_backup"
[0m08:35:04.963982 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:35:04.964889 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:35:04.966830 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
drop view if exists "dagster"."analytics"."stg_weather__dbt_backup" cascade
[0m08:35:04.967197 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:35:04.968545 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:35:04.971016 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:35:04.976794 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:35:04.980088 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:35:04.982714 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:35:04.981599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3830850>]}
[0m08:35:04.984837 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.stg_weather ......................... [[32mCREATE VIEW[0m in 0.11s]
[0m08:35:04.984501 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:35:04.985914 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:35:04.987198 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:35:04.988748 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb43ef590>]}
[0m08:35:04.989594 [info ] [Thread-2 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.11s]
[0m08:35:04.990519 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:35:04.993143 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m08:35:04.993910 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.summary ................................. [RUN]
[0m08:35:04.995781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_weather, now model.dagster_dbt_project.summary)
[0m08:35:04.998769 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m08:35:05.002923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m08:35:05.009406 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m08:35:05.030451 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m08:35:05.033715 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:35:05.034280 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m08:35:05.034833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:05.041122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:35:05.041838 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:35:05.042867 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),
weather as (select * from "dagster"."analytics"."stg_weather"),

joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a
    from src_1
    join src_2 using (id)
    join src_3 using (id)
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m08:35:05.046692 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m08:35:05.051547 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:35:05.052169 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary" rename to "summary__dbt_backup"
[0m08:35:05.053123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:35:05.056304 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:35:05.056961 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary__dbt_tmp" rename to "summary"
[0m08:35:05.059092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:35:05.061132 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:35:05.062538 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:35:05.064226 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:35:05.065857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:35:05.067559 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."summary__dbt_backup"
[0m08:35:05.070598 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:35:05.071172 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
drop table if exists "dagster"."analytics"."summary__dbt_backup" cascade
[0m08:35:05.073700 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:35:05.077159 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m08:35:05.078674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40ea373-d294-4806-879c-3cf064eef783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1628850>]}
[0m08:35:05.080648 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.summary ............................ [[32mSELECT 3[0m in 0.08s]
[0m08:35:05.081508 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m08:35:05.082910 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:05.083443 [debug] [MainThread]: On master: BEGIN
[0m08:35:05.083907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:35:05.089482 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:35:05.091699 [debug] [MainThread]: On master: COMMIT
[0m08:35:05.092972 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:05.094463 [debug] [MainThread]: On master: COMMIT
[0m08:35:05.095190 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:35:05.095715 [debug] [MainThread]: On master: Close
[0m08:35:05.096294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:35:05.096825 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m08:35:05.099070 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:35:05.100220 [info ] [MainThread]: 
[0m08:35:05.102024 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m08:35:05.103106 [debug] [MainThread]: Command end result
[0m08:35:05.167954 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:35:05.171285 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:35:05.176510 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:35:05.177156 [info ] [MainThread]: 
[0m08:35:05.178034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:35:05.178876 [info ] [MainThread]: 
[0m08:35:05.180069 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m08:35:05.181556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2923526, "process_in_blocks": "0", "process_kernel_time": 0.250055, "process_mem_max_rss": "128548", "process_out_blocks": "2773", "process_user_time": 1.299891}
[0m08:35:05.182231 [debug] [MainThread]: Command `dbt run` succeeded at 08:35:05.182171 after 1.29 seconds
[0m08:35:05.182842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ac22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba7c2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba7c2390>]}
[0m08:35:05.183469 [debug] [MainThread]: Flushing usage events
[0m08:35:05.566997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:13.756310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a340d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c9f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa79f6690>]}


============================== 08:36:13.758801 | 42beafea-c817-4e92-87e0-1a0ff377f88c ==============================
[0m08:36:13.758801 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:36:13.759729 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/opt/dbt/logs', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'use_experimental_parser': 'False', 'empty': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'profiles_dir': '/opt/dbt', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False'}
[0m08:36:13.846235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b35c50>]}
[0m08:36:13.888836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7c40d0>]}
[0m08:36:13.891667 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:36:13.936176 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:36:14.028618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:36:14.031247 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m08:36:14.214047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6557050>]}
[0m08:36:14.286642 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:36:14.289644 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:36:14.299644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5cae710>]}
[0m08:36:14.300266 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:36:14.301009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68bbc10>]}
[0m08:36:14.302328 [info ] [MainThread]: 
[0m08:36:14.302990 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:36:14.303488 [info ] [MainThread]: 
[0m08:36:14.304083 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:36:14.306639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:36:14.359892 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:36:14.360934 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:36:14.361603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:14.378724 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m08:36:14.381115 [debug] [ThreadPool]: On list_dagster: Close
[0m08:36:14.383408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:36:14.387165 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:36:14.387755 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:36:14.388352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:36:14.393070 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:36:14.394030 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:36:14.395108 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:36:14.397751 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m08:36:14.398757 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:36:14.399326 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:36:14.402381 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:14.402893 [debug] [MainThread]: On master: BEGIN
[0m08:36:14.403396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:36:14.407682 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:36:14.408159 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:14.408705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:36:14.411248 [debug] [MainThread]: SQL status: SELECT 7 in 0.002 seconds
[0m08:36:14.412215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68dce50>]}
[0m08:36:14.412751 [debug] [MainThread]: On master: ROLLBACK
[0m08:36:14.413242 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:14.413699 [debug] [MainThread]: On master: BEGIN
[0m08:36:14.414315 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:36:14.414775 [debug] [MainThread]: On master: COMMIT
[0m08:36:14.415215 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:14.415659 [debug] [MainThread]: On master: COMMIT
[0m08:36:14.416141 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:14.416573 [debug] [MainThread]: On master: Close
[0m08:36:14.418381 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:36:14.418541 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:36:14.419188 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:36:14.419835 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:36:14.420860 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:36:14.420367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:36:14.421375 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:36:14.421878 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:36:14.425789 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:36:14.427562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:36:14.430478 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:36:14.430820 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:36:14.455350 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:36:14.456204 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:36:14.459273 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:14.460085 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:14.461589 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:36:14.466253 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:36:14.464282 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:36:14.468749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:14.476011 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m08:36:14.477049 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:14.477789 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:36:14.477553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:36:14.480311 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:14.480558 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:36:14.483267 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:36:14.488726 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:14.490060 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:36:14.490500 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:36:14.491828 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:14.495190 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:14.500282 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:36:14.499478 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:14.501225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:14.501750 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:36:14.503702 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:14.504652 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:14.506764 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:36:14.516577 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:36:14.519766 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:14.517422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:14.521557 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:36:14.522728 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:36:14.525122 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:14.525483 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:14.526045 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:36:14.529992 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:36:14.532315 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:36:14.536283 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:14.539163 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:36:14.540313 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:36:14.541221 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:14.542330 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:36:14.542558 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:14.544859 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:36:14.543520 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:36:14.547601 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:36:14.548535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52f0d90>]}
[0m08:36:14.547919 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69b9410>]}
[0m08:36:14.549347 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m08:36:14.551077 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:36:14.549943 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m08:36:14.554382 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:36:14.551709 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:36:14.556651 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:36:14.555499 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:36:14.558496 [info ] [Thread-2 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:36:14.557599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_source_3)
[0m08:36:14.559760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_weather)
[0m08:36:14.560913 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:36:14.561708 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:36:14.564493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:36:14.567057 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:36:14.571203 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:36:14.571845 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:36:14.575892 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:36:14.580510 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:36:14.583844 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:14.584314 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:14.584731 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:36:14.585285 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:36:14.587461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:14.589335 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:36:14.594938 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m08:36:14.595161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:36:14.595621 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:14.596143 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:14.596704 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    "windSpeed" as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    "startTime" as start_time,
    "startTime"::timestamp::date as start_date
from source
  );
[0m08:36:14.597651 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:36:14.600464 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:36:14.601021 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:36:14.602862 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:14.604793 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:14.605394 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
alter table "dagster"."analytics"."stg_weather" rename to "stg_weather__dbt_backup"
[0m08:36:14.605864 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:36:14.607565 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:14.608094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:14.610407 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:14.612079 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:14.612735 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
alter table "dagster"."analytics"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m08:36:14.613510 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:36:14.614373 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:14.616419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:14.618862 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:36:14.619824 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:36:14.620391 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:14.620902 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:14.621375 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:36:14.621948 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:36:14.623067 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:14.623218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:36:14.624623 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_weather__dbt_backup"
[0m08:36:14.626491 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:36:14.628776 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:14.630239 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:14.631322 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
drop view if exists "dagster"."analytics"."stg_weather__dbt_backup" cascade
[0m08:36:14.632091 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:36:14.633690 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:14.633893 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:14.634836 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:36:14.635797 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:36:14.636630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52faad0>]}
[0m08:36:14.638372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52bc750>]}
[0m08:36:14.640113 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m08:36:14.639360 [info ] [Thread-2 (]: 4 of 5 OK created sql view model analytics.stg_weather ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:36:14.640822 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:36:14.641448 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:36:14.644847 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m08:36:14.645420 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.summary ................................. [RUN]
[0m08:36:14.646211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_3, now model.dagster_dbt_project.summary)
[0m08:36:14.646743 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m08:36:14.649222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m08:36:14.653706 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m08:36:14.667718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m08:36:14.670389 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:36:14.671610 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m08:36:14.672627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:14.678735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:36:14.679257 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:36:14.679789 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),
weather as (select * from "dagster"."analytics"."stg_weather"),

joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a
        weather.wind_speed
    from src_1
    join src_2 using (id)
    join src_3 using (id)
    left join weather on src_3 = 1
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m08:36:14.680647 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "."
LINE 27:         weather.wind_speed
                        ^

[0m08:36:14.681255 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: ROLLBACK
[0m08:36:14.683519 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m08:36:14.687442 [debug] [Thread-1 (]: Database Error in model summary (models/marts/summary.sql)
  syntax error at or near "."
  LINE 27:         weather.wind_speed
                          ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m08:36:14.688854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42beafea-c817-4e92-87e0-1a0ff377f88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fb7bd0>]}
[0m08:36:14.689558 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model analytics.summary ........................ [[31mERROR[0m in 0.04s]
[0m08:36:14.690552 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m08:36:14.691238 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.summary' to be skipped because of status 'error'.  Reason: Database Error in model summary (models/marts/summary.sql)
  syntax error at or near "."
  LINE 27:         weather.wind_speed
                          ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql.
[0m08:36:14.692983 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:14.693523 [debug] [MainThread]: On master: BEGIN
[0m08:36:14.694084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:36:14.698775 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:36:14.699720 [debug] [MainThread]: On master: COMMIT
[0m08:36:14.701689 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:14.702236 [debug] [MainThread]: On master: COMMIT
[0m08:36:14.702847 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:14.705255 [debug] [MainThread]: On master: Close
[0m08:36:14.705809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:14.706418 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m08:36:14.707065 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_weather' was properly closed.
[0m08:36:14.708248 [info ] [MainThread]: 
[0m08:36:14.710517 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m08:36:14.711562 [debug] [MainThread]: Command end result
[0m08:36:14.773135 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:36:14.778497 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:36:14.784047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:36:14.784676 [info ] [MainThread]: 
[0m08:36:14.785283 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:36:14.786445 [info ] [MainThread]: 
[0m08:36:14.788343 [error] [MainThread]: [31mFailure in model summary (models/marts/summary.sql)[0m
[0m08:36:14.790560 [error] [MainThread]:   Database Error in model summary (models/marts/summary.sql)
  syntax error at or near "."
  LINE 27:         weather.wind_speed
                          ^
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m08:36:14.793057 [info ] [MainThread]: 
[0m08:36:14.793879 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/marts/summary.sql
[0m08:36:14.794625 [info ] [MainThread]: 
[0m08:36:14.795501 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m08:36:14.799857 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0839715, "process_in_blocks": "0", "process_kernel_time": 0.263476, "process_mem_max_rss": "129140", "process_out_blocks": "2774", "process_user_time": 1.193627}
[0m08:36:14.801194 [debug] [MainThread]: Command `dbt run` failed at 08:36:14.801080 after 1.09 seconds
[0m08:36:14.802504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89b8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9b2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9b1910>]}
[0m08:36:14.804069 [debug] [MainThread]: Flushing usage events
[0m08:36:15.178068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:37.658376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c82250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c670d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c82d50>]}


============================== 08:36:37.661120 | e2ee6533-717c-46e3-8d64-00fa0469814a ==============================
[0m08:36:37.661120 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:36:37.662445 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/dbt/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --project-dir /opt/dbt'}
[0m08:36:37.759586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91bce50>]}
[0m08:36:37.789588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab9c7950>]}
[0m08:36:37.790823 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:36:37.839438 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:36:37.911050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:36:37.912049 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m08:36:38.062932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bdbe10>]}
[0m08:36:38.155107 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:36:38.158072 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:36:38.179987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78a1790>]}
[0m08:36:38.194292 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:36:38.196623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa776f050>]}
[0m08:36:38.203074 [info ] [MainThread]: 
[0m08:36:38.215174 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:36:38.218153 [info ] [MainThread]: 
[0m08:36:38.219564 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:36:38.224856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:36:38.297765 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:36:38.299593 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:36:38.300273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:38.309861 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m08:36:38.311638 [debug] [ThreadPool]: On list_dagster: Close
[0m08:36:38.314521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:36:38.318349 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:36:38.318931 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:36:38.320160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:36:38.324800 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:36:38.326588 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:36:38.327139 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:36:38.329641 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m08:36:38.330793 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:36:38.332568 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:36:38.335930 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:38.336500 [debug] [MainThread]: On master: BEGIN
[0m08:36:38.337216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:36:38.341383 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:36:38.341939 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:38.342580 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:36:38.345936 [debug] [MainThread]: SQL status: SELECT 7 in 0.002 seconds
[0m08:36:38.346961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6330510>]}
[0m08:36:38.347679 [debug] [MainThread]: On master: ROLLBACK
[0m08:36:38.348480 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:38.349022 [debug] [MainThread]: On master: BEGIN
[0m08:36:38.349727 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:36:38.350250 [debug] [MainThread]: On master: COMMIT
[0m08:36:38.350848 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:38.351412 [debug] [MainThread]: On master: COMMIT
[0m08:36:38.352034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:38.354288 [debug] [MainThread]: On master: Close
[0m08:36:38.362501 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:36:38.366525 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:36:38.362857 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:36:38.368867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:36:38.371532 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:36:38.372790 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:36:38.374235 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:36:38.380037 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:36:38.381244 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:36:38.387896 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:36:38.389799 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:36:38.425357 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:36:38.429527 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:36:38.434073 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:36:38.438290 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:38.439947 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:36:38.440308 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:38.442125 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:36:38.441275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:38.442924 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:36:38.449508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:36:38.450820 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:38.452999 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:36:38.453510 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m08:36:38.462261 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:38.457357 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:36:38.463322 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:36:38.470080 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:38.476563 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:36:38.477264 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:36:38.480959 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:38.482711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:38.482998 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:36:38.487203 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:38.490412 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:38.492529 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:36:38.495680 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:38.498538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:38.499813 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:36:38.514182 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:36:38.515180 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:38.515880 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:38.518387 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:36:38.521336 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:36:38.522516 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:38.527700 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:36:38.527346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:36:38.529321 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:38.538337 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:36:38.540832 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:36:38.545316 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:36:38.547337 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:36:38.548135 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:36:38.548984 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:36:38.550740 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:38.552420 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:38.554575 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:36:38.556474 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:36:38.559693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6496e90>]}
[0m08:36:38.561620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6326c10>]}
[0m08:36:38.562911 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.19s]
[0m08:36:38.564688 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.19s]
[0m08:36:38.566519 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:36:38.568658 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:36:38.573162 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:36:38.571221 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:36:38.579645 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:36:38.574386 [info ] [Thread-2 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:36:38.581899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_weather)
[0m08:36:38.580922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_source_3)
[0m08:36:38.582745 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:36:38.584847 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:36:38.588813 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:36:38.593664 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:36:38.600325 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:36:38.600973 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:36:38.605586 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:36:38.610099 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:36:38.615698 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:38.617337 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:36:38.621670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:36:38.622398 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:38.625429 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:36:38.627456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:38.632598 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m08:36:38.635540 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:38.637403 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    "windSpeed" as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    "startTime" as start_time,
    "startTime"::timestamp::date as start_date
from source
  );
[0m08:36:38.639822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m08:36:38.643016 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:38.644829 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:36:38.644475 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:36:38.646973 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:36:38.649466 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:38.651647 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:38.653544 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
alter table "dagster"."analytics"."stg_weather" rename to "stg_weather__dbt_backup"
[0m08:36:38.654528 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:36:38.656192 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:38.656717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:38.658919 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:38.661226 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:38.662458 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
alter table "dagster"."analytics"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m08:36:38.663595 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:36:38.666847 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:36:38.669643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:36:38.671654 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:36:38.674871 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:36:38.676683 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:38.677647 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:38.678750 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:36:38.681367 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:36:38.683817 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:38.684815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:38.687689 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_weather__dbt_backup"
[0m08:36:38.691577 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:36:38.692926 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:36:38.694039 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:36:38.695196 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
drop view if exists "dagster"."analytics"."stg_weather__dbt_backup" cascade
[0m08:36:38.696214 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:36:38.698280 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:38.698572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:36:38.701955 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:36:38.700050 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:36:38.704180 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e373d0>]}
[0m08:36:38.703337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6346990>]}
[0m08:36:38.706395 [info ] [Thread-2 (]: 4 of 5 OK created sql view model analytics.stg_weather ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m08:36:38.707273 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.12s]
[0m08:36:38.708087 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:36:38.709134 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:36:38.711169 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.summary
[0m08:36:38.712436 [info ] [Thread-2 (]: 5 of 5 START sql table model analytics.summary ................................. [RUN]
[0m08:36:38.714187 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_weather, now model.dagster_dbt_project.summary)
[0m08:36:38.715143 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.summary
[0m08:36:38.718375 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m08:36:38.722484 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.summary
[0m08:36:38.739446 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m08:36:38.744169 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:36:38.745482 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: BEGIN
[0m08:36:38.746291 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:36:38.752224 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m08:36:38.753595 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:36:38.755209 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),
weather as (select * from "dagster"."analytics"."stg_weather"),

joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a,
        weather.wind_speed
    from src_1
    join src_2 using (id)
    join src_3 using (id)
    left join weather on src_3 = 1
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m08:36:38.757739 [debug] [Thread-2 (]: Postgres adapter: Postgres error: operator does not exist: record = integer
LINE 31:     left join weather on src_3 = 1
                                        ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m08:36:38.758954 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: ROLLBACK
[0m08:36:38.760808 [debug] [Thread-2 (]: On model.dagster_dbt_project.summary: Close
[0m08:36:38.766485 [debug] [Thread-2 (]: Database Error in model summary (models/marts/summary.sql)
  operator does not exist: record = integer
  LINE 31:     left join weather on src_3 = 1
                                          ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m08:36:38.768328 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee6533-717c-46e3-8d64-00fa0469814a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e40c90>]}
[0m08:36:38.769455 [error] [Thread-2 (]: 5 of 5 ERROR creating sql table model analytics.summary ........................ [[31mERROR[0m in 0.05s]
[0m08:36:38.770440 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.summary
[0m08:36:38.771527 [debug] [Thread-5 (]: Marking all children of 'model.dagster_dbt_project.summary' to be skipped because of status 'error'.  Reason: Database Error in model summary (models/marts/summary.sql)
  operator does not exist: record = integer
  LINE 31:     left join weather on src_3 = 1
                                          ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql.
[0m08:36:38.774243 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:38.775531 [debug] [MainThread]: On master: BEGIN
[0m08:36:38.776428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:36:38.782079 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:36:38.782870 [debug] [MainThread]: On master: COMMIT
[0m08:36:38.783821 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:38.786134 [debug] [MainThread]: On master: COMMIT
[0m08:36:38.787032 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:38.788091 [debug] [MainThread]: On master: Close
[0m08:36:38.789054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:38.790303 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:36:38.791458 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m08:36:38.792713 [info ] [MainThread]: 
[0m08:36:38.793783 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m08:36:38.795628 [debug] [MainThread]: Command end result
[0m08:36:38.889304 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:36:38.894157 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:36:38.899564 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:36:38.901385 [info ] [MainThread]: 
[0m08:36:38.902001 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:36:38.903008 [info ] [MainThread]: 
[0m08:36:38.905313 [error] [MainThread]: [31mFailure in model summary (models/marts/summary.sql)[0m
[0m08:36:38.907337 [error] [MainThread]:   Database Error in model summary (models/marts/summary.sql)
  operator does not exist: record = integer
  LINE 31:     left join weather on src_3 = 1
                                          ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dagster_dbt_project/models/marts/summary.sql
[0m08:36:38.910222 [info ] [MainThread]: 
[0m08:36:38.912343 [info ] [MainThread]:   compiled code at target/compiled/dagster_dbt_project/models/marts/summary.sql
[0m08:36:38.915136 [info ] [MainThread]: 
[0m08:36:38.917387 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m08:36:38.918458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3047295, "process_in_blocks": "0", "process_kernel_time": 0.337334, "process_mem_max_rss": "129208", "process_out_blocks": "2776", "process_user_time": 1.62636}
[0m08:36:38.920362 [debug] [MainThread]: Command `dbt run` failed at 08:36:38.920311 after 1.31 seconds
[0m08:36:38.921044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c8d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9bdcf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbc1910>]}
[0m08:36:38.921794 [debug] [MainThread]: Flushing usage events
[0m08:36:39.274583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:00.943725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c416890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c416a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6be4d0>]}


============================== 08:37:00.947509 | 08ca8c10-8057-4b0b-a543-ee0ed7fdace2 ==============================
[0m08:37:00.947509 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:37:00.948554 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'static_parser': 'True', 'empty': 'False', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'log_path': '/opt/dbt/logs', 'log_format': 'default', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_cache_events': 'False', 'profiles_dir': '/opt/dbt'}
[0m08:37:01.028224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b57bfd0>]}
[0m08:37:01.078181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1d7950>]}
[0m08:37:01.080022 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:37:01.113420 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:37:01.176626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:37:01.177471 [debug] [MainThread]: Partial parsing: updated file: dagster_dbt_project://models/marts/summary.sql
[0m08:37:01.293905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b13d190>]}
[0m08:37:01.372094 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:37:01.374289 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:37:01.386199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6cea10>]}
[0m08:37:01.386824 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:37:01.387454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b342750>]}
[0m08:37:01.388687 [info ] [MainThread]: 
[0m08:37:01.389226 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:37:01.389689 [info ] [MainThread]: 
[0m08:37:01.391542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:37:01.393969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:37:01.441859 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:37:01.443137 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:37:01.443803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:01.458693 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m08:37:01.459994 [debug] [ThreadPool]: On list_dagster: Close
[0m08:37:01.462307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:37:01.466346 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:37:01.466985 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:37:01.467556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:01.472039 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:37:01.472648 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:37:01.474371 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:37:01.477728 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m08:37:01.478757 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:37:01.480662 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:37:01.483832 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:01.484534 [debug] [MainThread]: On master: BEGIN
[0m08:37:01.485084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:01.489101 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:37:01.489696 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:01.490255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:37:01.493835 [debug] [MainThread]: SQL status: SELECT 7 in 0.002 seconds
[0m08:37:01.494899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6e5310>]}
[0m08:37:01.495566 [debug] [MainThread]: On master: ROLLBACK
[0m08:37:01.496226 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:01.496778 [debug] [MainThread]: On master: BEGIN
[0m08:37:01.497464 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:37:01.497985 [debug] [MainThread]: On master: COMMIT
[0m08:37:01.499488 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:01.500043 [debug] [MainThread]: On master: COMMIT
[0m08:37:01.502285 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:37:01.502817 [debug] [MainThread]: On master: Close
[0m08:37:01.505089 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:37:01.505258 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:37:01.505679 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:37:01.506401 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:37:01.507281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:37:01.507774 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:37:01.508297 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:37:01.508731 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:37:01.513963 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:37:01.515682 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:37:01.519192 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:37:01.519584 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:37:01.536998 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:37:01.539339 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:37:01.541555 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:37:01.542248 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:37:01.542527 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:37:01.544502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:01.544977 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:37:01.546268 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:37:01.549595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:37:01.550121 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:37:01.552260 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:37:01.553327 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m08:37:01.553923 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:37:01.554460 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:37:01.554602 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:37:01.559230 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:37:01.560103 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:37:01.559384 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m08:37:01.562599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:01.564019 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:37:01.565741 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:37:01.566414 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:37:01.567526 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:37:01.568303 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:01.568819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:01.570336 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:37:01.577990 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:37:01.578405 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:37:01.579030 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:37:01.580014 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:01.581581 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:37:01.582582 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:37:01.583591 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:37:01.583874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:37:01.584256 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:37:01.587720 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:37:01.588484 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m08:37:01.590743 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:37:01.592164 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:37:01.593455 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:37:01.592656 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:37:01.593875 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:37:01.594956 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:37:01.595119 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:37:01.596390 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:37:01.597277 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:37:01.598755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3ad450>]}
[0m08:37:01.598900 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0206d0>]}
[0m08:37:01.599478 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m08:37:01.600273 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m08:37:01.600652 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:37:01.601706 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:37:01.601252 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:37:01.602235 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:37:01.603371 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:37:01.604436 [info ] [Thread-2 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:37:01.603891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_source_3)
[0m08:37:01.606363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_weather)
[0m08:37:01.606833 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:37:01.607453 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:37:01.609251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:37:01.610983 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:37:01.612723 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:37:01.615432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:37:01.615663 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:37:01.619499 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:37:01.620111 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:37:01.620702 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:37:01.621293 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:37:01.623349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:01.624451 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:37:01.625570 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:37:01.630004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:37:01.631220 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:37:01.632245 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:37:01.633858 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m08:37:01.634498 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:37:01.634330 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:37:01.634996 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    "windSpeed" as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    "startTime" as start_time,
    "startTime"::timestamp::date as start_date
from source
  );
[0m08:37:01.637253 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:37:01.638457 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:37:01.639083 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:37:01.639225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:01.640770 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:37:01.642414 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:37:01.642984 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
alter table "dagster"."analytics"."stg_weather" rename to "stg_weather__dbt_backup"
[0m08:37:01.643612 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:37:01.644641 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:01.645158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:01.646755 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:37:01.647834 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:37:01.648445 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
alter table "dagster"."analytics"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m08:37:01.649050 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:37:01.650235 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:37:01.651209 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:37:01.652211 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:37:01.653666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:37:01.655777 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:37:01.654291 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:37:01.658313 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:37:01.656451 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:37:01.659308 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m08:37:01.660403 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:37:01.661760 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_weather__dbt_backup"
[0m08:37:01.662695 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:37:01.662904 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:37:01.663209 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
drop view if exists "dagster"."analytics"."stg_weather__dbt_backup" cascade
[0m08:37:01.664102 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:37:01.665072 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:37:01.665530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0206d0>]}
[0m08:37:01.666374 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:37:01.667077 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m08:37:01.667494 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b537d0>]}
[0m08:37:01.667963 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:37:01.668656 [info ] [Thread-2 (]: 4 of 5 OK created sql view model analytics.stg_weather ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m08:37:01.669667 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:37:01.670382 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m08:37:01.671283 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.summary ................................. [RUN]
[0m08:37:01.671823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_3, now model.dagster_dbt_project.summary)
[0m08:37:01.672260 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m08:37:01.674379 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m08:37:01.675614 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m08:37:01.686942 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m08:37:01.690329 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:37:01.691004 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m08:37:01.692595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:01.696782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:37:01.697277 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:37:01.697809 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),
weather as (select * from "dagster"."analytics"."stg_weather"),

joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a,
        weather.wind_speed
    from src_1
    join src_2 using (id)
    join src_3 using (id)
    left join weather on src_3.is_a = 1
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m08:37:01.701367 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.003 seconds
[0m08:37:01.705338 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:37:01.705882 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary" rename to "summary__dbt_backup"
[0m08:37:01.706566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:01.709304 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:37:01.709798 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary__dbt_tmp" rename to "summary"
[0m08:37:01.710411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:37:01.711332 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:37:01.711854 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:37:01.712349 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:37:01.713033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:37:01.714408 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."summary__dbt_backup"
[0m08:37:01.716003 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:37:01.716508 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
drop table if exists "dagster"."analytics"."summary__dbt_backup" cascade
[0m08:37:01.718671 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:37:01.719558 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m08:37:01.720378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ca8c10-8057-4b0b-a543-ee0ed7fdace2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b40d50>]}
[0m08:37:01.721040 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.summary ............................ [[32mSELECT 42[0m in 0.05s]
[0m08:37:01.723324 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m08:37:01.724329 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:01.724760 [debug] [MainThread]: On master: BEGIN
[0m08:37:01.725201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:37:01.729158 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:37:01.729626 [debug] [MainThread]: On master: COMMIT
[0m08:37:01.731299 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:01.732107 [debug] [MainThread]: On master: COMMIT
[0m08:37:01.733563 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:37:01.734118 [debug] [MainThread]: On master: Close
[0m08:37:01.734728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:01.735299 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m08:37:01.737472 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_weather' was properly closed.
[0m08:37:01.738377 [info ] [MainThread]: 
[0m08:37:01.739028 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m08:37:01.740728 [debug] [MainThread]: Command end result
[0m08:37:01.774561 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:37:01.777648 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:37:01.782662 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:37:01.783237 [info ] [MainThread]: 
[0m08:37:01.783889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:37:01.785532 [info ] [MainThread]: 
[0m08:37:01.786132 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m08:37:01.787033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.87446785, "process_in_blocks": "0", "process_kernel_time": 0.208008, "process_mem_max_rss": "128588", "process_out_blocks": "2775", "process_user_time": 1.246023}
[0m08:37:01.787565 [debug] [MainThread]: Command `dbt run` succeeded at 08:37:01.787514 after 0.88 seconds
[0m08:37:01.788078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c47e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c47fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913d18d0>]}
[0m08:37:01.789266 [debug] [MainThread]: Flushing usage events
[0m08:37:02.128862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:38:04.697572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f57e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921f2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fb1e10>]}


============================== 08:38:04.702564 | a43447ba-682d-4551-b1eb-aafae2581c7b ==============================
[0m08:38:04.702564 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:38:04.707075 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_path': '/opt/dbt/logs', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/dbt', 'write_json': 'True', 'profiles_dir': '/opt/dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False'}
[0m08:38:04.853263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91082790>]}
[0m08:38:04.889615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cf2710>]}
[0m08:38:04.890715 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m08:38:04.938170 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:38:05.053986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:05.054641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:05.085477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e62690>]}
[0m08:38:05.181958 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:38:05.185430 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:38:05.196694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dfdd90>]}
[0m08:38:05.197411 [info ] [MainThread]: Found 5 models, 4 sources, 459 macros
[0m08:38:05.197915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f5df10>]}
[0m08:38:05.199354 [info ] [MainThread]: 
[0m08:38:05.199888 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:38:05.200428 [info ] [MainThread]: 
[0m08:38:05.201097 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:38:05.203601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dagster'
[0m08:38:05.225640 [debug] [ThreadPool]: Using postgres connection "list_dagster"
[0m08:38:05.226672 [debug] [ThreadPool]: On list_dagster: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster"} */

    select distinct nspname from pg_namespace
  
[0m08:38:05.227685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:05.247832 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m08:38:05.250194 [debug] [ThreadPool]: On list_dagster: Close
[0m08:38:05.251919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dagster, now list_dagster_analytics)
[0m08:38:05.255839 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:38:05.256471 [debug] [ThreadPool]: On list_dagster_analytics: BEGIN
[0m08:38:05.259321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:05.266956 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:38:05.268512 [debug] [ThreadPool]: Using postgres connection "list_dagster_analytics"
[0m08:38:05.269253 [debug] [ThreadPool]: On list_dagster_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "list_dagster_analytics"} */
select
      'dagster' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dagster' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m08:38:05.272942 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m08:38:05.274634 [debug] [ThreadPool]: On list_dagster_analytics: ROLLBACK
[0m08:38:05.275736 [debug] [ThreadPool]: On list_dagster_analytics: Close
[0m08:38:05.280200 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:05.280934 [debug] [MainThread]: On master: BEGIN
[0m08:38:05.281477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:38:05.287355 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:38:05.288040 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:05.288792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:38:05.291517 [debug] [MainThread]: SQL status: SELECT 7 in 0.002 seconds
[0m08:38:05.292808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e61250>]}
[0m08:38:05.295240 [debug] [MainThread]: On master: ROLLBACK
[0m08:38:05.295948 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:05.297957 [debug] [MainThread]: On master: BEGIN
[0m08:38:05.300100 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:38:05.302359 [debug] [MainThread]: On master: COMMIT
[0m08:38:05.303778 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:05.304340 [debug] [MainThread]: On master: COMMIT
[0m08:38:05.305007 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:38:05.305569 [debug] [MainThread]: On master: Close
[0m08:38:05.308307 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_source_1
[0m08:38:05.308604 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_2
[0m08:38:05.309869 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_source_1 ............................. [RUN]
[0m08:38:05.311688 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_source_2 ............................. [RUN]
[0m08:38:05.312288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dagster_analytics, now model.dagster_dbt_project.stg_source_1)
[0m08:38:05.313526 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dagster_dbt_project.stg_source_2'
[0m08:38:05.314514 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_source_1
[0m08:38:05.315468 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_2
[0m08:38:05.321492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_1"
[0m08:38:05.323532 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_2"
[0m08:38:05.327788 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_source_1
[0m08:38:05.328040 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_2
[0m08:38:05.349658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_1"
[0m08:38:05.382773 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_2"
[0m08:38:05.385070 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:38:05.387842 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: BEGIN
[0m08:38:05.385689 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:38:05.388861 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: BEGIN
[0m08:38:05.388402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:05.389330 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:38:05.395679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:38:05.396285 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:38:05.396104 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m08:38:05.397539 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */

  create view "dagster"."analytics"."stg_source_1__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source1"
)

select
    id,
    value,
    value * 2 as value_x2
from source
  );
[0m08:38:05.398031 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:38:05.398910 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */

  create view "dagster"."analytics"."stg_source_2__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source2"
)

select
    id,
    score,
    score + 1 as score_plus_one
from source
  );
[0m08:38:05.400008 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:38:05.404693 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:38:05.404828 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m08:38:05.405472 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1" rename to "stg_source_1__dbt_backup"
[0m08:38:05.407810 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:38:05.408834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.409120 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2" rename to "stg_source_2__dbt_backup"
[0m08:38:05.412075 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:38:05.412969 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.413350 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
alter table "dagster"."analytics"."stg_source_1__dbt_tmp" rename to "stg_source_1"
[0m08:38:05.415119 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:38:05.415946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.416341 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
alter table "dagster"."analytics"."stg_source_2__dbt_tmp" rename to "stg_source_2"
[0m08:38:05.425055 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:38:05.425821 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.427917 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:38:05.426722 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:38:05.428488 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:38:05.429420 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: COMMIT
[0m08:38:05.430453 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: COMMIT
[0m08:38:05.432087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:38:05.432258 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:38:05.436549 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_source_1__dbt_backup"
[0m08:38:05.438099 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_2__dbt_backup"
[0m08:38:05.441793 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_source_1"
[0m08:38:05.444379 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_1"} */
drop view if exists "dagster"."analytics"."stg_source_1__dbt_backup" cascade
[0m08:38:05.443755 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_2"
[0m08:38:05.445445 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_2"} */
drop view if exists "dagster"."analytics"."stg_source_2__dbt_backup" cascade
[0m08:38:05.445949 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:38:05.448304 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_source_1: Close
[0m08:38:05.448481 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m08:38:05.450841 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_2: Close
[0m08:38:05.451581 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bd0d50>]}
[0m08:38:05.451169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf93550>]}
[0m08:38:05.452756 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_source_1 ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m08:38:05.452329 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_source_2 ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m08:38:05.454529 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_2
[0m08:38:05.453335 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_source_1
[0m08:38:05.455059 [debug] [Thread-2 (]: Began running node model.dagster_dbt_project.stg_source_3
[0m08:38:05.455603 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.stg_weather
[0m08:38:05.456155 [info ] [Thread-2 (]: 3 of 5 START sql view model analytics.stg_source_3 ............................. [RUN]
[0m08:38:05.457961 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.stg_weather .............................. [RUN]
[0m08:38:05.458644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_2, now model.dagster_dbt_project.stg_source_3)
[0m08:38:05.459210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_source_1, now model.dagster_dbt_project.stg_weather)
[0m08:38:05.460345 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.stg_weather
[0m08:38:05.459816 [debug] [Thread-2 (]: Began compiling node model.dagster_dbt_project.stg_source_3
[0m08:38:05.463217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_weather"
[0m08:38:05.465075 [debug] [Thread-2 (]: Writing injected SQL for node "model.dagster_dbt_project.stg_source_3"
[0m08:38:05.467103 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.stg_weather
[0m08:38:05.467349 [debug] [Thread-2 (]: Began executing node model.dagster_dbt_project.stg_source_3
[0m08:38:05.471449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_weather"
[0m08:38:05.473868 [debug] [Thread-2 (]: Writing runtime sql for node "model.dagster_dbt_project.stg_source_3"
[0m08:38:05.476653 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:38:05.477214 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:38:05.478699 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: BEGIN
[0m08:38:05.479259 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: BEGIN
[0m08:38:05.479741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:05.480563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:05.486601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:38:05.487590 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:38:05.487720 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m08:38:05.488264 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */

  create view "dagster"."analytics"."stg_weather__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."weather"
)

select
    name,
    temperature,
    "windSpeed" as wind_speed,
    temperature * 1.8 + 32 as temperature_f,
    "startTime" as start_time,
    "startTime"::timestamp::date as start_date
from source
  );
[0m08:38:05.488761 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:38:05.489780 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */

  create view "dagster"."analytics"."stg_source_3__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dagster"."public"."source3"
)

select
    id,
    category,
    case
        when category = 'A' then 1
        else 0
    end as is_a
from source
  );
[0m08:38:05.490589 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:38:05.490987 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:38:05.492573 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:38:05.494306 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:38:05.495591 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3" rename to "stg_source_3__dbt_backup"
[0m08:38:05.494805 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
alter table "dagster"."analytics"."stg_weather" rename to "stg_weather__dbt_backup"
[0m08:38:05.496519 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.497023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.498299 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:38:05.501067 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
alter table "dagster"."analytics"."stg_source_3__dbt_tmp" rename to "stg_source_3"
[0m08:38:05.500588 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:38:05.501980 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
alter table "dagster"."analytics"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m08:38:05.501814 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.503427 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:38:05.502755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.503958 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:38:05.504926 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:38:05.505453 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: COMMIT
[0m08:38:05.506735 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:38:05.507706 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: COMMIT
[0m08:38:05.508008 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:38:05.508650 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:38:05.509873 [debug] [Thread-2 (]: Applying DROP to: "dagster"."analytics"."stg_source_3__dbt_backup"
[0m08:38:05.511311 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."stg_weather__dbt_backup"
[0m08:38:05.512717 [debug] [Thread-2 (]: Using postgres connection "model.dagster_dbt_project.stg_source_3"
[0m08:38:05.513334 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.stg_weather"
[0m08:38:05.514376 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_weather"} */
drop view if exists "dagster"."analytics"."stg_weather__dbt_backup" cascade
[0m08:38:05.513804 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.stg_source_3"} */
drop view if exists "dagster"."analytics"."stg_source_3__dbt_backup" cascade
[0m08:38:05.516219 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:38:05.517217 [debug] [Thread-1 (]: On model.dagster_dbt_project.stg_weather: Close
[0m08:38:05.516390 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:38:05.517861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf0a350>]}
[0m08:38:05.518671 [debug] [Thread-2 (]: On model.dagster_dbt_project.stg_source_3: Close
[0m08:38:05.519367 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.stg_weather ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m08:38:05.520936 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900b1650>]}
[0m08:38:05.521380 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.stg_weather
[0m08:38:05.522077 [info ] [Thread-2 (]: 3 of 5 OK created sql view model analytics.stg_source_3 ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m08:38:05.522870 [debug] [Thread-2 (]: Finished running node model.dagster_dbt_project.stg_source_3
[0m08:38:05.523575 [debug] [Thread-1 (]: Began running node model.dagster_dbt_project.summary
[0m08:38:05.524097 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.summary ................................. [RUN]
[0m08:38:05.524617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dagster_dbt_project.stg_weather, now model.dagster_dbt_project.summary)
[0m08:38:05.525069 [debug] [Thread-1 (]: Began compiling node model.dagster_dbt_project.summary
[0m08:38:05.527220 [debug] [Thread-1 (]: Writing injected SQL for node "model.dagster_dbt_project.summary"
[0m08:38:05.528578 [debug] [Thread-1 (]: Began executing node model.dagster_dbt_project.summary
[0m08:38:05.541565 [debug] [Thread-1 (]: Writing runtime sql for node "model.dagster_dbt_project.summary"
[0m08:38:05.543625 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:38:05.544115 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: BEGIN
[0m08:38:05.545831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:05.550060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:38:05.551622 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:38:05.552098 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */

  
    

  create  table "dagster"."analytics"."summary__dbt_tmp"
  
  
    as
  
  (
    

with 

src_1 as ( select * from "dagster"."analytics"."stg_source_1"),
src_2 as (select * from "dagster"."analytics"."stg_source_2" ),
src_3 as (select * from "dagster"."analytics"."stg_source_3" ),
weather as (select * from "dagster"."analytics"."stg_weather"),

joined as (
    select
        src_1.id,
        src_1.value_x2,
        src_2.score_plus_one,
        src_3.is_a,
        weather.wind_speed
    from src_1
    join src_2 using (id)
    join src_3 using (id)
    left join weather on src_3.is_a = 1
)

select
    *,
    (value_x2 + score_plus_one) * is_a as metric
from joined
  );
  
[0m08:38:05.556925 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.004 seconds
[0m08:38:05.560529 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:38:05.561071 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary" rename to "summary__dbt_backup"
[0m08:38:05.561723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.563405 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:38:05.564464 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
alter table "dagster"."analytics"."summary__dbt_tmp" rename to "summary"
[0m08:38:05.565782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:05.566735 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:38:05.567202 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:38:05.567784 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: COMMIT
[0m08:38:05.568560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:38:05.569988 [debug] [Thread-1 (]: Applying DROP to: "dagster"."analytics"."summary__dbt_backup"
[0m08:38:05.572414 [debug] [Thread-1 (]: Using postgres connection "model.dagster_dbt_project.summary"
[0m08:38:05.572987 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dagster_dbt", "target_name": "dev", "node_id": "model.dagster_dbt_project.summary"} */
drop table if exists "dagster"."analytics"."summary__dbt_backup" cascade
[0m08:38:05.575408 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:38:05.576923 [debug] [Thread-1 (]: On model.dagster_dbt_project.summary: Close
[0m08:38:05.577599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43447ba-682d-4551-b1eb-aafae2581c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91026a10>]}
[0m08:38:05.578359 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.summary ............................ [[32mSELECT 42[0m in 0.05s]
[0m08:38:05.578988 [debug] [Thread-1 (]: Finished running node model.dagster_dbt_project.summary
[0m08:38:05.581424 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:05.581907 [debug] [MainThread]: On master: BEGIN
[0m08:38:05.583613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:38:05.588720 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:38:05.589456 [debug] [MainThread]: On master: COMMIT
[0m08:38:05.590034 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:05.590583 [debug] [MainThread]: On master: COMMIT
[0m08:38:05.591182 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:38:05.592566 [debug] [MainThread]: On master: Close
[0m08:38:05.593217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:05.593798 [debug] [MainThread]: Connection 'model.dagster_dbt_project.summary' was properly closed.
[0m08:38:05.594371 [debug] [MainThread]: Connection 'model.dagster_dbt_project.stg_source_3' was properly closed.
[0m08:38:05.595828 [info ] [MainThread]: 
[0m08:38:05.596371 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m08:38:05.598912 [debug] [MainThread]: Command end result
[0m08:38:05.638638 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/dbt/target/manifest.json
[0m08:38:05.640831 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/dbt/target/semantic_manifest.json
[0m08:38:05.646033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/dbt/target/run_results.json
[0m08:38:05.646535 [info ] [MainThread]: 
[0m08:38:05.646999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:38:05.647443 [info ] [MainThread]: 
[0m08:38:05.648437 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m08:38:05.649239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0111264, "process_in_blocks": "0", "process_kernel_time": 0.323398, "process_mem_max_rss": "125508", "process_out_blocks": "1884", "process_user_time": 1.371293}
[0m08:38:05.649788 [debug] [MainThread]: Command `dbt run` succeeded at 08:38:05.649737 after 1.01 seconds
[0m08:38:05.650246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920e39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ef1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ef1790>]}
[0m08:38:05.650750 [debug] [MainThread]: Flushing usage events
[0m08:38:06.056924 [debug] [MainThread]: An error was encountered while trying to flush usage events
